{"url": "https://community.thingspeak.com/forum/arduino/page-4/", "threads": [{"url": "https://community.thingspeak.com/forum/arduino/ardunio-mega-wifi101-shield-dies-after-two-readings/", "posts": [{"date": "July 16, 2017 - 2:47 pm", "content": "Hey guys,I'm only getting two sensor readings per channel then it seems ThingSpeak stops responding. Any ideas why this may be? \u00a0I'm using a Arduino Mega with a Wifi101 shield, along with the example WriteVoltatge code from the ThingSpeak library. \u00a0Code:\u00a0/* WriteVoltageReads an analog voltage from pin 0, and writes it to a channel on ThingSpeak every 20 seconds.ThingSpeak ( https://www.thingspeak.com ) is an analytic IoT platform service that allows you to aggregate, visualize and analyze live data streams in the cloud.Copyright 2016, The MathWorks, Inc.Documentation for the ThingSpeak Communication Library for Arduino is in the extras/documentation folder where the library was installed. See the accompaning licence file for licensing information. */#include 'ThingSpeak.h'// *********************************************************************************************************** // This example selects the correct library to use based on the board selected under the Tools menu in the IDE. // Yun, Ethernet shield, WiFi101 shield, esp8266, and MXR1000 are all supported. // With Yun, the default is that you're using the Ethernet connection. // If you're using a wi-fi 101 or ethernet shield (http://www.arduino.cc/en/Main/ArduinoWiFiShield), uncomment the corresponding line below // ***********************************************************************************************************#define USE_WIFI101_SHIELD //#define USE_ETHERNET_SHIELD#if defined(ARDUINO_AVR_YUN) #include 'YunClient.h' YunClient client; #else #if defined(USE_WIFI101_SHIELD) || defined(ARDUINO_SAMD_MKR1000) || defined(ARDUINO_ARCH_ESP8266) // Use WiFi #ifdef ARDUINO_ARCH_ESP8266 #include #else #include #include #endif char ssid[] = '*******'; // your network SSID (name) char pass[] = '*******'; // your network password int status = WL_IDLE_STATUS; WiFiClient client; #elif defined(USE_ETHERNET_SHIELD) // Use wired ethernet shield #include #include byte mac[] = { 0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED}; EthernetClient client; #endif #endif#ifdef ARDUINO_ARCH_AVR // On Arduino: 0 - 1023 maps to 0 - 5 volts #define VOLTAGE_MAX 5.0 #define VOLTAGE_MAXCOUNTS 1023.0 #elif ARDUINO_SAMD_MKR1000 // On MKR1000: 0 - 1023 maps to 0 - 3.3 volts #define VOLTAGE_MAX 3.3 #define VOLTAGE_MAXCOUNTS 1023.0 #elif ARDUINO_SAM_DUE // On Due: 0 - 1023 maps to 0 - 3.3 volts #define VOLTAGE_MAX 3.3 #define VOLTAGE_MAXCOUNTS 1023.0 #elif ARDUINO_ARCH_ESP8266 // On ESP8266: 0 - 1023 maps to 0 - 1 volts #define VOLTAGE_MAX 1.0 #define VOLTAGE_MAXCOUNTS 1023.0 #endif/* ***************************************************************************************** **** Visit https://www.thingspeak.com to sign up for a free account and create **** a channel. The video tutorial http://community.thingspeak.com/tutorials/thingspeak-channels/ **** has more information. You need to change this to your channel, and your write API key **** IF YOU SHARE YOUR CODE WITH OTHERS, MAKE SURE YOU REMOVE YOUR WRITE API KEY!! *****************************************************************************************/ unsigned long myChannelNumber = 298095; const char * myWriteAPIKey = '*******';void setup() {#ifdef ARDUINO_AVR_YUN Bridge.begin(); #else #if defined(ARDUINO_ARCH_ESP8266) || defined(USE_WIFI101_SHIELD) || defined(ARDUINO_SAMD_MKR1000) WiFi.begin(ssid, pass); #else Ethernet.begin(mac); #endif #endifThingSpeak.begin(client); }void loop() { // read the input on analog pin 0: int sensorValue = analogRead(A0); // Convert the analog reading // On Uno,Mega,YunArduino: 0 - 1023 maps to 0 - 5 volts // On ESP8266: 0 - 1023 maps to 0 - 1 volts // On MKR1000,Due: 0 - 4095 maps to 0 - 3.3 volts float voltage = sensorValue * (VOLTAGE_MAX / VOLTAGE_MAXCOUNTS);// Write to ThingSpeak. There are up to 8 fields in a channel, allowing you to store up to 8 different // pieces of information in a channel. Here, we write to field 1. ThingSpeak.writeField(myChannelNumber, 7, voltage, myWriteAPIKey); delay(20000); // ThingSpeak will only accept updates every 15 seconds. }", "num_user_post": " 2", "author": "iolson"}]}, {"url": "https://community.thingspeak.com/forum/arduino/dispalying-sum-in-thingspeak-channel/", "posts": [{"date": "July 14, 2017 - 9:59 am", "content": "Hello guys,\u00a0I must appreciate Thingspeak is a very good platform. However, I am stuck at one thing and need help from the community. I am using hall-effect sensor to send liquid data from arduino to my channel through wifi. The liquid is usually in 100s of ml. I want to display the liquid for some specific hours, days and weeks and even months. But I am unable to see that in my graphs.\u00a0Channel link is: https://thingspeak.com/channels/302158. I am using 20s delay to send the data and I only have one field in my channel.\u00a0Can anyone help me in this? It would be much appreciated.Best RegardsRushan", "num_user_post": " 8", "author": "rushanarshad"}]}, {"url": "https://community.thingspeak.com/forum/arduino/1440-averaging-inaccuracy/", "posts": [{"date": "June 21, 2017 - 3:16 pm", "content": "I am new to the ThingSpeak platform and I am trying to display the 1440 average of my data I am sending from an Arduino Uno. I am sending data from 5 different detectors to be plotted into 5 different fields on my ThingSpeak channel. The live data plotted is quite accurate but when I chose to plot the average I get values significantly lower than it should be. I am suspecting it to have something to do with the bunch of Null values I have here for example maybe: https://thingspeak.com/channels/126439/field/4.json", "num_user_post": " 1", "author": "salim"}, {"date": "June 21, 2017 - 3:53 pm", "content": "You are correct. The average is using null's and lowering the expected average.If you have two devices, you might want to update two different ThingSpeak channels.If that is not possible, then MATLAB can help here. You can use MATLAB Analysis app to read in the field data, ignore the nulls, and then calculate the average. You can even use MATLAB to write the averaged data to a new processed channel and have it calculate the daily average each day by scheduling it with TimeControl.", "num_user_post": " 402", "author": "Hans"}]}, {"url": "https://community.thingspeak.com/forum/arduino/need-help-posting-data-using-w5100-ethernet-shield-and-it-does-not-appear-on-local-thingspeak-server-after-uploading-data/", "posts": [{"date": "June 1, 2017 - 11:53 am", "content": "Hello,Hello, I'm trying to monitor my DHT11 usage with arduino, i can see that local thingspeak does not getting any dots on graphs ?I can see that Real thingspeak (apt.thingspeak.com) is getting dots on graphs normally .What might be wrong, here is the code summary:------------#include #include #include// ThingSpeak Settings char thingSpeakAddress[] = '192.168.1.55'; String writeAPIKey = 'apikey';-----------void ReportTemperatureToThingspeak(int temperature, int humidity, double dewPoint) { // Use short field names i.e. 1 instead of field1 String fields = '1=' + String(temperature, DEC); fields += '&2=' + String(humidity, DEC); Serial.println(fields);if (client.connect(thingSpeakAddress, 3000)) { Serial.println('Connected to thingspeak.com');// Create HTTP POST Data client.print('POST /update HTTP/1.1 '); client.print('Host:192.168.1.55 '); client.print('Connection: close '); client.print('X-THINGSPEAKAPIKEY: '+writeAPIKey+' '); client.print('Content-Type: application/x-www-form-urlencoded '); client.print('Content-Length: '); client.print(fields.length()); client.print(''); client.print(fields);Serial.print(fields); Serial.print(' '); Serial.println('Fields sent sent to http://www.thingspeak.com'); delay(TEN_SECONDS); } else -----------", "num_user_post": " 1", "author": "km3"}]}, {"url": "https://community.thingspeak.com/forum/arduino/need-help-posting-data-using-rn171-wifi-shield-and-wifly-library/", "posts": [{"date": "June 3, 2016 - 2:34 am", "content": "\u00a0Hi there\u00a0I am completely stuck and would really like some input. \u00a0I can get a stable connection to Thingspeak, but all my attempts to post data re unsuccessful. \u00a0I can either post an empty entry (It shows I have a new entry, with null values for the fields) or I can get a 400 Bad Request returned, but that's it. \u00a0Any pointers will be welcome!I am using Wifly.h and connects successfully to the wifi and external sites.Here is the code for the Bad Request:I call this function in my main loop:ThingSpeakUpdate('field1='+String(x)+'&field2='+String(y));And here is the function:void ThingSpeakUpdate(String tsData){Serial.println('Data string: ' + tsData);Serial.println('...Connecting to Thingspeak');// Connecting and sending data to Thingspeakif(Wifly.connect('api.thingspeak.com','80')){Serial.println('...Connection succesful, updating datastreams');Wifly.println('POST /update HTTP/1.1');Wifly.println('Host: api.thingspeak.com');Wifly.println('Connection: close');Wifly.println('X-THINGSPEAKAPIKEY: '+myWriteAPIKey);Wifly.println('Content-Type: application/x-www-form-urlencoded');Wifly.println('Content-Length: ');Wifly.println(tsData.length());Wifly.println();Wifly.println(tsData);delay(200);Serial.println('Thingspeak update sent.');}else{// Failed to connect to ThingspeakSerial.println('Unable to connect to Thingspeak.');}", "num_user_post": " 2", "author": "heinb"}, {"date": "June 3, 2016 - 7:58 am", "content": "I managed to solve the issue. \u00a0Here are the steps that might help, even for those who uses other hardware and libraries:1. I knew that the url to post worked when I put it in a web browser - it updated my feed:https://api.thingspeak.com/update?key=xxxxxxxxxxxxxx&field1=10 \u00a0 \u00a0(obviously I replaced the x's with my write key)2. I was thinking that my shield was adding info to my header and this caused \u00a0the 'Bad Request' error, so I went to\u00a0http://web-sniffer.net/and posted my url into the box provided. \u00a0This then returned the info sent to the server and it looked like this:Connect to 52.7.53.111 on port 443 ... okGET /update?key=PONK48XZ3V2APBKW&field1=10 HTTP/1.1[CRLF]Host: api.thingspeak.com[CRLF]Connection: close[CRLF]User-Agent: Web-sniffer/1.1.0 (+http://web-sniffer.net/)[CRLF]Accept-Encoding: gzip[CRLF]Accept-Charset: ISO-8859-1,UTF-8;q=0.7,*;q=0.7[CRLF]Cache-Control: no-cache[CRLF]Accept-Language: de,en;q=0.7,en-us;q=0.3[CRLF]Referer: http://web-sniffer.net/[CRLF][CRLF]From there I created my commands to the website by changing the code in my function.  This is the working function:Command to call the function in my main loop:ThingSpeakUpdate('field1='+String(x)+'&field2='+String(y));delay(15000);And here is my working function:void ThingSpeakUpdate(String tsData){ Serial.println('Data string: ' + tsData); Serial.println('...Connecting to Thingspeak'); // Connecting and sending data to Thingspeak  if(Wifly.connect('api.thingspeak.com','80')) { Serial.println('...Connection succesful, updating datastreams');  Wifly.println('GET /update?key=PONK48XZ3V2APBKW&'+tsData+' HTTP/1.1'); Wifly.println('Host: api.thingspeak.com'); Wifly.println('Connection: close'); delay(200); Serial.println('Thingspeak update sent.'); } else{ // Failed to connect to Thingspeak Serial.println('Unable to connect to Thingspeak.'); }Interestingly enough, I did not have to specify the packet lenght.  I hope this helps others aswell.", "num_user_post": " 2", "author": "heinb"}, {"date": "May 29, 2017 - 4:59 pm", "content": "Hello, could you please post your entire code. At least the code to connect this wifi schield to Thingspeak as a client. I manage to connect whit a ethernet schield but I'm lost with this one.", "num_user_post": " 1", "author": "loli72"}]}, {"url": "https://community.thingspeak.com/forum/arduino/send-data-from-thingspeak-to-esp8266-1/", "posts": [{"date": "April 29, 2017 - 5:27 pm", "content": "HiI succeeded send data from a sensor (by Arduino Uno + esp8266) to my ThingSpeak channel.Now I want to send back data from my channel to Arduino Uno.Help?\u00a0 tnx", "num_user_post": " 8", "author": "irproject"}]}, {"url": "https://community.thingspeak.com/forum/arduino/thingspeak-problems-with-upload/", "posts": [{"date": "April 22, 2017 - 5:04 am", "content": "Hello!I have Arduino Uno WiFi, and the temperature sensor DHT21. Problem starts when I try to upload my values from sensors to ThingSpeak. When I try to upload more than two fields in rest uri, it's not working, when its two or one field i can upload this values without problems.#include 'DHT.h'#include <Wire.h>#include <UnoWiFiDevEd.h>#define CONNECTOR 'rest'#define SERVER_ADDR 'api.thingspeak.com'#define APIKEY_THINGSPEAK '****************' //Insert your API Key #define DHTPIN 2 // modify to the pin we connected#define DHTPINN 3 // modify to the pin we connected#define DHTTYPE DHT21 // AM2301DHT dht(DHTPIN, DHTTYPE);DHT dhtt(DHTPINN, DHTTYPE);short hum = 60;short temp = 22;short hum1 = 65;short temp1 = 25;void setup() {Ciao.begin(); // CIAO INITSerial.begin(9600);dht.begin();dhtt.begin();}void loop() {int h = dht.readHumidity();float t = dht.readTemperature();int ha = dhtt.readHumidity();float ta = dhtt.readTemperature();Ciao.println(h);Ciao.println(t);Ciao.println(ha);Ciao.println(ta);String uri = '/update?api_key=';uri += APIKEY_THINGSPEAK;uri += '&field1=';uri += String(h);uri += '&field2=';uri += String(t);uri += '&field3=';uri += String(ha);uri += '&field4=';uri += String(ta);Ciao.println('Send data on ThingSpeak Channel'); CiaoData data = Ciao.write(CONNECTOR, SERVER_ADDR, uri);if (!data.isEmpty()){Ciao.println( 'State: ' + String (data.get(1)) );Ciao.println( 'Response: ' + String (data.get(2)) );}else{Ciao.println('Write Error');} delay(30000); // Thinkspeak policy}\u00a0When I put only two fields it works:String uri = '/update?api_key=';uri += APIKEY_THINGSPEAK;uri += '&field1=';uri += String(h);uri += '&field2=';uri += String(t);\u00a0Console:Send data on ThingSpeak ChannelWrite Error2926.102526.40Send data on ThingSpeak ChannelWrite Error2926.203026.40Send data on ThingSpeak ChannelState: 400Response:", "num_user_post": " 3", "author": "Griwen"}, {"date": "April 22, 2017 - 7:16 am", "content": "Perhaps you can try to print the url to console or maybe just the length to see how long it is? \u00a0Perhaps you are exceeding some kind of buffer length somewhere.. \u00a0 You could also experiment by adding \u00a0'&status=xxx' then gradually increasing the length until you trigger the error.\u00a0Maybe you could also add a delay between the write and the isdataEmpty() to make sure there is no timing problem.", "num_user_post": " 271", "author": "rw950431"}, {"date": "April 22, 2017 - 8:21 am", "content": "In console with two value it works from sensors:Send data on ThingSpeak Channel/update?api_key=**********&field1=22&field2=36State: 200Response: 131In console three sensors but not floatSend data on ThingSpeak Channel/update?api_key=**********&field1=22&field2=36&field3=24State: 200Response: 142It worksFrom 4 sensors it doesnt workSend data on ThingSpeak Channel/update?api_key=**********&field1=22&field2=36&field3=30&field4=13Write ErrorSend data on ThingSpeak Channel/update?api_key=**********&field1=22&field2=36&field3=30&field4=12State: 400Response: So the problem can be the length, but i need to upload two float values like 10.09 and two short values line 50.\u00a0\u00a0", "num_user_post": " 3", "author": "Griwen"}, {"date": "April 23, 2017 - 10:36 am", "content": "Take a look at one of the examples that use the ThingSpeak support library:https://github.com/mathworks/thingspeak-arduino/tree/master/examplesMore specifically try modifying this one:https://github.com/mathworks/thingspeak-arduino/tree/master/examples/WriteMultipleVoltagesDoes that work?", "num_user_post": " 225", "author": "Vinod"}]}, {"url": "https://community.thingspeak.com/forum/arduino/dsm501a-arduino/", "posts": [{"date": "March 24, 2017 - 6:43 pm", "content": "\u00a0Hello comunity, I'm new here.\u00a0Have been able to post DHT readings to my channel with no problems at all.Recently, I've been trying, with no any success to post data from a dust sensor, the DSM501a.So, I can read the sensor on Arduino serial, but once I try to implement it on the sketch that I'm using to upload DHT sensor, this part of the code seems to stop everything \ud83d\ude41void setup ()// Initialize DSM501 dsm501.begin(MIN_WIN_SPAN);// wait 60s for DSM501 to warm up for (int i = 1; i <= 60; i++) { delay(1000); // 1s Serial.print(i); Serial.println(' s (wait 60s for DSM501 to warm up)'); }Any ideas?", "num_user_post": " 4", "author": "Sintra Air"}, {"date": "March 25, 2017 - 7:31 am", "content": "Does it print anything to Serial?\u00a0The code you posted is missing a closing }- I assume there is one in the real code.", "num_user_post": " 271", "author": "rw950431"}, {"date": "March 25, 2017 - 7:01 pm", "content": "Hey!\u00a0It was printing.\u00a0Problem 'kinda' solved.It started posting information, but sometimes it just stops for radom 20 or 30min periods.Maybe now related with the power supply, I think. Or arduino's memory.\u00a0Next step: debug power supply.\u00a0I moved that part of the code on the\u00a0void setup ()\u00a0to after all the ethernet operations before sending.I think it might be related with timeouts.\u00a0//------ENC28J60---------- //if correct answer is not received then re-initialize ethernet module //changed from 220 to 2800 if (res > 220){ initialize_ethernet(); } res = res + 1; ether.packetLoop(ether.packetReceive()); //200 res = 10 seconds (50ms each res) if (res == 200) {//_____________ TIME for DESPERATED MEASURESdsm501.begin(MIN_WIN_SPAN);dsm501.update();int p=(dsm501.getPM25()/100); // field1=(Field 1 Data)&field2=(Field 2 Data)&field3=(Field 3 Data)&field4=(Field 4 Data)&field5=(Field 5 Data)&field6=(Field 6 Data)&field7=(Field 7 Data)&field8=(Field 8 Data)&lat=(Latitude in Decimal Degrees)&long=(Longitude in Decimal Degrees)&elevation=(Elevation in meters)&status=(140 Character Message) byte sd = stash.create(); stash.print('field1='); stash.print(t); stash.print('&field2='); stash.print(h); stash.print('&field3='); stash.print(p); stash.save();\u00a0I have lots of ideas, the problem is putting them to the practice.Fortunately there are so many possibilities nowadays, and there is internet, the biggest library in the world =D", "num_user_post": " 4", "author": "Sintra Air"}, {"date": "March 26, 2017 - 1:35 pm", "content": "So, I was powering everything from arduino uno board.\u00a0Today I repurposed an old Sat Receiver's power supply, which supplies multiple voltages (3.3, 5, 7 and 12V, all with common groud), and powered everything (ethernet shield 3.3v, DSM501a 5v, dht11 5v and the arduino itself with 7v. still to add a gas sensor, as soon as it arrives at my location.The insane behaviour seems to have stopped.Although, I had one 20min pause, in about 5 hours of sending data every minute. Not perfect, but can't complain. It could be internet connection, or even a thingspeak problem.\u00a0Can't debug live, because the device is far away from home.Will be now for a 48h run to check for stability.\u00a0BTW, channel here: https://thingspeak.com/channels/230655\u00a0", "num_user_post": " 4", "author": "Sintra Air"}, {"date": "April 2, 2017 - 7:41 am", "content": "So, conclusion, just in case someone is in the same situation:\u00a0It was a program problem. It still is, but I found a way out.SRAM, as far as I understood was being corrupted, making the arduino behave strange and random.Using the comand:\u00a0asm volatile (' \u00a0jmp 0'); \u00a0after the last action performed by the program, helped a lot.It 'clears' all the volatiles and the system runs smooth with no problems at all.\u00a0Might be a dirty way to do the thing speak forever with no interruptions, but the fact is that it works like a charm.", "num_user_post": " 4", "author": "Sintra Air"}]}, {"url": "https://community.thingspeak.com/forum/arduino/what-is-wrong-with-i2c-on-edison-with-htu21df-or-mpl3115a2-or-bmp280-%ef%bc%9f/", "posts": [{"date": "March 9, 2017 - 3:23 am", "content": "Hi everybody,\u00a0I am trying to build an teaching IoT-micro-weatherstation and I am facing problems with I2C sensors\u00a0 or more probably Edison I2C behavior. I had faced some hardware problems few weeks ago so I have bought a new Edison mini-breakout and a set of new sensors from isweek:HTU21DFBME280MCP9808SI1145MPL3115A2BMP280(I have also some other ones that are not involved in this question...)\u00a0First of all I am pretty sure that some months ago I have been abl to easily handle an HTU21D-F sensor with mraa and upm, then came the change in mraa that added a check on the communication between the Edison and the device that we overcome. But now the problem is worse the HTU21D-F is not detected any more !\u00a0I am using a level shifter to be shure to provide 1.8v signal on SDA and SCL pins of my minibreakout.I am as sure as possible that my wiring is correct because I am using a breadboard withSI1145 / MCP9808 / BME280 that are detected (I have not tried yet to get measurements)on I2C bus 6 or BUS 1\u00a0 I have activated bus 6 with these instructions:echo 28 > /sys/class/gpio/export\u00a0 echo 27 > /sys/class/gpio/export\u00a0 echo mode1 > /sys/kernel/debug/gpio_debug/gpio28/current_pinmux\u00a0 echo mode1 > /sys/kernel/debug/gpio_debug/gpio27/current_pinmux\u00a0i2cdetect -y -r 6\u00a0\u00a0\u00a0\u00a0 0\u00a0 1\u00a0 2\u00a0 3\u00a0 4\u00a0 5\u00a0 6\u00a0 7\u00a0 8\u00a0 9\u00a0 a\u00a0 b\u00a0 c\u00a0 d\u00a0 e\u00a0 f00:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -- -- -- -- -- -- -- -- -- -- -- -- --10: -- -- -- -- -- -- -- -- 18 -- -- -- -- -- -- --20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --60: 60 -- -- -- -- -- -- -- -- -- -- -- -- -- -- --70: -- -- -- -- -- -- -- 77\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0If I try to wire any of The three others one by one or in any combination I getno detectioni2cdetect -y -r 1\u00a0\u00a0\u00a0\u00a0 0\u00a0 1\u00a0 2\u00a0 3\u00a0 4\u00a0 5\u00a0 6\u00a0 7\u00a0 8\u00a0 9\u00a0 a\u00a0 b\u00a0 c\u00a0 d\u00a0 e\u00a0 f00:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -- -- -- -- -- -- -- -- -- -- -- -- --10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --60: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --70: -- -- -- -- -- -- -- --\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Same result on bus 6 or 1 !!\u00a0I have tested the sensors on an arduino, they perform very well, I have tested HTU21D-F on an arduino breakout it does not work with the adafruit IDE test program and sends the message no sensor detected. With the demo program the sensor is detected but the values read are wrong (probably empty buffer).\u00a0I have read a little bit the forum and have seen that there are many questions dealing with I2C\u00a0 buses, I can proove that 'in many cases' everything works as expected but in some cases\u00a0 the communication situation seems locked between the sensor and the edison. It is just like if the Edison was not able to 'bring the sensor to communicate with him' To confirm this hypothesis I removed theMPL3115A2 and left it away, after some minutes when I plugged it back It was detected without changing anything\u00a0 :\u00a0i2cdetect -y -r 1\u00a0\u00a0\u00a0\u00a0 0\u00a0 1\u00a0 2\u00a0 3\u00a0 4\u00a0 5\u00a0 6\u00a0 7\u00a0 8\u00a0 9\u00a0 a\u00a0 b\u00a0 c\u00a0 d\u00a0 e\u00a0 f00:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -- -- -- -- -- -- -- -- -- -- -- -- --10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --60: 60 -- -- -- -- -- -- -- -- -- -- -- -- -- -- --70: -- -- -- -- -- -- -- --\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0Just if the sensor came back spontaneously to a good state... I tried to plug the BMP280 and....It was detected!!!!!!!\u00a0i2cdetect -y -r 1\u00a0\u00a0\u00a0\u00a0 0\u00a0 1\u00a0 2\u00a0 3\u00a0 4\u00a0 5\u00a0 6\u00a0 7\u00a0 8\u00a0 9\u00a0 a\u00a0 b\u00a0 c\u00a0 d\u00a0 e\u00a0 f00:\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 -- -- -- -- -- -- -- -- -- -- -- -- --10: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --20: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --30: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --40: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --60: 60 -- -- -- -- -- -- -- -- -- -- -- -- -- -- --70: -- -- -- -- -- -- -- 77\u00a0I am getting mad on this question, do you have any suggestion, as this is for teaching\u00a0 K9-12 teachers I cannot resonably tell them : 'unplug, wait for 4'47', then plug again it will work....'\u00a0Any help will be greatly appreciated, if needed I can do some tests and in teh meantime I will write the code to reas and compare measurements between sensors...Thanks in advance and many thanks to all contributors and intel facilitators in this nice community.\u00a0G.", "num_user_post": " 1", "author": "habapa"}]}, {"url": "https://community.thingspeak.com/forum/arduino/arduino-ajax-hml-and-thingspeak/", "posts": [{"date": "March 7, 2017 - 8:16 pm", "content": "Hey all,\u00a0I want to make a remote control system and display sensors parameters so I'm using ThingSpeak to plot graphs and some buttons to control leds, seperatly everything works perfect, but when I add them together ThingSpeak doesnt get a data.There is a html code: <html>\u00a0\u00a0\u00a0 <head >\u00a0\u00a0 \u00a0<meta http-equiv='Content-Type' content='text/html;charset=UTF-8'>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 <title>title</title>\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0strLED3 = '';\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0strLED4 = '';\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0var LED3_state = 0;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0var data_val=0;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0var num_updates = 0;\u00a0\u00a0 \u00a0// number of 200ms periods used to calculate time to send data to ThingSpeak\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0 function GetArduinoInputs()\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 nocache = '&nocache=' + Math.random() * 1000000;\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 var request = new XMLHttpRequest();\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 request.onreadystatechange = function()\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 {\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 if (this.readyState == 4) {\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 if (this.status == 200) {\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 if (this.responseXML != null) {\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0document.getElementById('input4').innerHTML =\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 this.responseXML.getElementsByTagName('analog1')[0].childNodes[0].nodeValue;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 data_val=this.responseXML.getElementsByTagName('analog1')[0].childNodes[0].nodeValue;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0if (this.responseXML.getElementsByTagName('LED')[0].childNodes[0].nodeValue === 'on') {\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0document.getElementById('LED3').innerHTML = 'ON (TURN OFF)';\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0LED3_state = 1;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0 else {\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0document.getElementById('LED3').innerHTML = 'OFF (TURN ON)';\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0LED3_state = 0;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 }\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0if (this.responseXML.getElementsByTagName('LED1')[0].childNodes[0].nodeValue === 'on') {\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0document.getElementById('LED4').innerHTML = 'ON (TURN OFF)';\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0LED4_state = 1;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0 else {\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0document.getElementById('LED4').innerHTML = 'OFF (TURN ON)';\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0LED4_state = 0;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 }\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0if (num_updates >= 100) {\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0num_updates = 0;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0// send voltage to ThingSpeak\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0ThingSpeakSend('XXXXXXXXXXXXX',data_val);\u00a0\u00a0 \u00a0// insert your ThingSpeak Write API Key here\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0num_updates++;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 }\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 }\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 }\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 request.open('GET', 'ajax_inputs' + nocache, true);\u00a0 //request.open('GET', 'ajax_inputs' + strLED3 + strLED4 + nocache, true);\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 request.send(null);\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 setTimeout('GetArduinoInputs()', 200);\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0strLED3 = '';\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0strLED4 = '';\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 }\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0function GetButton1()\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0{\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0if (LED3_state === 1) {\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0LED3_state = 0;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0strLED3 = '&LED3=0';\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0else {\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0LED3_state = 1;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0strLED3 = '&LED3=1';\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0function GetButton2()\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0{\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0if (LED4_state === 1) {\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0LED4_state = 0;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0strLED4 = '&LED4=0';\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0else {\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0LED4_state = 1;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0strLED4 = '&LED4=1';\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0// function to send data to ThingSpeak\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0function ThingSpeakSend(api_write_key, data)\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0{\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0var ts_req = new XMLHttpRequest();\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0// GET request string - modify if more fields are needed\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0var req_str = 'http://api.thingspeak.com/update?key=' + api_write_key + '&field1=' + data;\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0ts_req.onreadystatechange = function()\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0{\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0// not doing anything with response from ThingSpeak\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0// send the data to ThingSpeak\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0ts_req.open('GET', req_str, true);\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0ts_req.send(null);\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0}\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0 </head>\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0 <body onload='GetArduinoInputs()'>\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0 <button\u00a0 type='button' id='LED3' onclick='GetButton1()'> OFF (TURN ON) </button>\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0 <button\u00a0 type='button' id='LED4' onclick='GetButton2()'> OFF (TURN ON) </button>\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0 \u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0 src='https://thingspeak.com/channels/235349/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=7&title=%C5%BDem%C4%97s+dr%C4%97gm%C4%97&type=line&xaxis=Data&yaxis=%25&yaxismax=100&yaxismin=0'>\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0\u00a0 </body>How I figured out its a problem with a GET message, when I simply write:request.open('GET', 'ajax_inputs' + nocache, true);graph\u00a0 is plotted, but when I add to this request strings which keep LED states values it doesnt work.[code]request.open('GET', 'ajax_inputs' + strLED3 + strLED4 + nocache, true);\u00a0[/code]So maybe you could help me?", "num_user_post": " 1", "author": "narkase"}]}, {"url": "https://community.thingspeak.com/forum/arduino/arduino-uno-wifi-dev-with-hx711-load-cell-send-data-to-thingspeak/", "posts": [{"date": "March 6, 2017 - 11:17 am", "content": "Hello, everyone!I am not a programmer as you will realise, but I set up a program for measuring weight with HX711 load cell for a uni project, and I would like to upload the measurments to my TS channel. The arduino UNO WiFi Dev board is connected to a WiFi network but I can't manage to make it work.Before Setup, I defined the weight (3 decimals) and led (reading from A1)#define CONNECTOR 'rest'#define SERVER_ADDR 'api.thingspeak.com'#define APIKEY_THINGSPEAK ' ' //Insert your API Keyfloat weight = 0.000;int led;and in Loopweight = scale.get_units(); pump = analogRead(A1);String uri = '/update?api_key='; uri += APIKEY_THINGSPEAK; uri += '&field1='; uri += String(weight); uri += '&field2='; uri += String(led);Ciao.println('Send data on ThingSpeak Channel');CiaoData data = Ciao.write(CONNECTOR, SERVER_ADDR, uri);if (!data.isEmpty()) { Ciao.println( 'State: ' + String (data.get(1)) ); Ciao.println( 'Response: ' + String (data.get(2)) ); } //delay(30000); // Thinkspeak policy else { Ciao.println('Write Error'); }The delay is commented because I use different\u00a0time-step code.The thing is that I can Serial.print the values of weight and led\u00a0but not to upload them. However, when I give specific values to them it uploads without problem. Any help would be much appreciated.", "num_user_post": " 3", "author": "s161025"}, {"date": "March 7, 2017 - 11:07 am", "content": "It looks like you are declaring an int led in the first part. \u00a0But then in the looped code, you use a variable called pump to read the analog input.Then further down you use \u00a0uri += String(led);Since led hasn't been assigned a value, adding it to the uri string will have unexpected results.\u00a0Try this:change int led to int pumpchange uri += String(led); to\u00a0uri += String(pump);\u00a0", "num_user_post": " 34", "author": "JasonW"}, {"date": "March 7, 2017 - 5:26 pm", "content": "My bad. I meant led = AnalogRead(A1);This seems consistant. I think that the problem is somewhere else.", "num_user_post": " 3", "author": "s161025"}]}, {"url": "https://community.thingspeak.com/forum/arduino/problem-updating-data-counter/", "posts": [{"date": "February 27, 2017 - 2:20 pm", "content": "Hi everyone,I\u00b4m new with IoT. I have an arduino connected to thingspeak and i want to send the number of times that a push button is activated.The problem is that at the begining the arduino sends the first data to my chanel but then it stops.If I use the fuction 'delay' it sends the information but I can\u00b4t use this because the program is stopped during this seconds so I\u00b4m trying a timer library. I hope someone could help me to fix this. ThanksHere is my code:int BUTTON_PIN = 2;int buttonPushCounter = 0; // counter for the number of button pressesint buttonState = 0; // current state of the buttonint lastButtonState = 0; // previous state of the buttonunsigned long myChannelNumber = XXXXXXX;const char * myWriteAPIKey = 'XXXXXX';#include <TimerOne.h>#include 'ThingSpeak.h'#define USE_ETHERNET_SHIELD#include <SPI.h>#include <Ethernet.h>byte mac[] = { 0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED};EthernetClient client;void setup() {Timer1.initialize(180000000); // 18 sTimer1.attachInterrupt(Thingspeak) ;pinMode(BUTTON_PIN, INPUT_PULLUP); //Serial.begin(9600);Ethernet.begin(mac);ThingSpeak.begin(client);}void loop() {int buttonState = digitalRead(BUTTON_PIN);// compare the buttonState to its previous state if (buttonState != lastButtonState) { // if the state has changed, increment the counter buttonPushCounter++; //Serial.print('Counter: '); //Serial.println(buttonPushCounter);} // Delay a little bit to avoid bouncingdelay(150); // save the current state as the last state,for next time through the loop noInterrupts(); // Suspende las interrupciones lastButtonState = buttonState; interrupts();  }void Thingspeak() { ThingSpeak.setField(1,buttonPushCounter); ThingSpeak.writeFields(myChannelNumber, myWriteAPIKey); //ThingSpeak.writeField(myChannelNumber, 1, buttonPushCounter, myWriteAPIKey); //Serial.print('Enviando datos '); //Serial.println(buttonPushCounter);}", "num_user_post": " 1", "author": "pedretexksi"}]}]}