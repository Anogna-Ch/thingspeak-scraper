{"url": "https://community.thingspeak.com/forum/matlab/page-5/", "threads": [{"url": "https://community.thingspeak.com/forum/matlab/undefined-operator-for-input-arguments-of-type-cell/", "posts": [{"date": "October 4, 2016 - 1:53 am", "content": "I have the following code in a matlab visualisation which used to work fine. However in the last few days the data source has had problems and now my matlab code complains 'Undefined operator '>' for input arguments of type 'cell'.'\u00a0readChannelID = [150393];%% Read Data %%% Read first data variablepower = thingSpeakRead(readChannelID, 'OutputFormat','table' , 'NumDays', 3)%% Visualize Data %%dates=datenum(power.Timestamps);price=power.Priceprice(price>2000)=2000\u00a0 '-4e-05'\u00a0\u00a0\u00a0 '0.00014'\u00a0\u00a0\u00a0 '0.00014'\u00a0\u00a0\u00a0 '0.00014'\u00a0\u00a0\u00a0 '0.00014'\u00a0\u00a0\u00a0 '0.00014'\u00a0\u00a0\u00a0 '-3e-05'\u00a0\u00a0\u00a0 '6e-05'\u00a0Undefined operator '>' for input arguments of type cell.\u00a0I'm guessing it doesnt like the '-4e-05' type of entry.\u00a0 If I reduce the time period to exclude these values it runs OK.What can I do to clean my data so this works properly?", "num_user_post": " 271", "author": "rw950431"}, {"date": "October 4, 2016 - 1:02 pm", "content": "You are right, it looks like data represented in exponential format is leading the column\u00a0to be represented as a string. Couple options to resolve the error:\u00a01. Manually convert the data in Price column to double datatype. Here is some example code:\u00a0readChannelID = [150393];%% Read Data %%% Read first data variablepower = thingSpeakRead(readChannelID, 'OutputFormat','table' , 'NumDays', 3)%% Visualize Data %%dates=datenum(power.Timestamps);price = cellfun(@str2num, power.Price);price(price>2000)=2000\u00a0\u00a0The cellfun() function call is used to apply the str2num() function to all elements of the Price column. You can find more information about cellfun\u00a0and str2num\u00a0functions at the following link:https://www.mathworks.com/help/matlab/ref/cellfun.htmlhttps://www.mathworks.com/help/matlab/ref/str2num.html\u00a02. Update your source to send data to ThingSpeak in a non-exponential format.\u00a0We will look into options to update the thingSpeakRead function to handle exponential data representation.\u00a0Thanks!\u00a0", "num_user_post": " 62", "author": "Adarsh_Murthy"}, {"date": "October 4, 2016 - 8:28 pm", "content": "Thanks Adarsh, cellfun() works perfectly.", "num_user_post": " 271", "author": "rw950431"}]}, {"url": "https://community.thingspeak.com/forum/matlab/timecontrolreact-app-with-matlab-analysis-code-errors/", "posts": [{"date": "September 22, 2016 - 4:33 pm", "content": "When you have MATLAB Analysis code that uses a TimeControl, the TimeControl stops running if there are a number of consecutive errors in the MATLAB Analysis code. You can choose to receive an alert via email by checking the box Notify me via email if this MATLAB Analysis fails when triggered by TimeControl or React in the MATLAB Analysis app.\u00a0To restart the TimeControl, fix the error in the associated MATLAB Analysis App and press the Save and Run button.\u00a0", "num_user_post": " 62", "author": "Adarsh_Murthy"}, {"date": "September 23, 2016 - 4:22 pm", "content": "Hi Adarsh,From my Analysis and TimeControls (1 hour frequency). I have 'troubles' with two of themFirst Analysis ends with Webwrite to Pushingbox server that sometimes reply 502 error and I have a red line in the corresponding Analysis and TimeControlSecond Analysis ends with a try-catch as this:\u00a0 \u00a0 \u00a0 try\u00a0 \u00a0 \u00a0 \u00a0 \u00a0webwite(text for 1st try+Timestamp)\u00a0 \u00a0 \u00a0 catch\u00a0 \u00a0 \u00a0 \u00a0 \u00a0webwite(text for 2nd try+Timestamp)until now 1.4 % error 4 red lines in 2 weeks (and 40 catch 263 OK)* * No one ThingSpeak error email in any case * *Example of todayFirst column from first Analysis fired by a TimeControlSecond column from another Analysis fired by another TimeControl??? is some text plus the timestamp from Thingspeak server??? >> 20160923T150013 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T150406??? >> 20160923T140011 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T140405??? >> 20160923T130015 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T130407??? >> 20160923T120014 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T120408??? >> 20160923T110014 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T110409??? >> 20160923T100016 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T100407??? >> 20160923T090013 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T090407??? >> 20160923T080014 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T080407??? >> 20160923T070014 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T070408??? >> 20160923T060013 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T060406??? >> 20160923T050017\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0RED line - No email??? >> 20160923T040013 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T040407??? >> 20160923T030011 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T030406??? >> 20160923T020014 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T020407??? >> 20160923T010015 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T010410??? >> 20160923T000014 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ???--20160923T000406I understood that a check in Notify sends email?Thank you in advance", "num_user_post": " 91", "author": "piajola"}, {"date": "September 23, 2016 - 6:11 pm", "content": "The behavior is\u00a0documented here\u00a0as 'When you have MATLAB Analysis code that uses a React, React stops running if there are a number of consecutive errors in the MATLAB Analysis code. You can choose to receive an alert via email by checking the box Notify me via email if this MATLAB Analysis fails when triggered by TimeControl or React in the MATLAB Analysis app.' It is similar for TimeControl apps.The email is only triggered after the analysis code fails after a number a consecutive errors exceeds a predetermined limit. In the example you gave, the\u00a020160923T050017 execution errored, but the immediate next execution of the analysis at\u00a020160923T040013 executed successfully. This caused\u00a0the counter on number of consecutive\u00a0failures is reset back to zero, and since this number never exceeded our predetermined limit, you didn't get an email.The idea is that we do not want to shut off the MATLAB analysis\u00a0if it was a temporary failure, such as in your case a failure code from the pushingbox service. If there is a consistent, repeated number of failures, then it needs user intervention, which is when the email is generated.Also, if you try-catch errors in your code and do not let the errors propagate out of your analyses, the counter\u00a0of the\u00a0number of failed executions will not be incremented, ultimately resulting in not getting an email since you will not\u00a0hit the predetermined limit.Hope this helps clarify the behavior.", "num_user_post": " 225", "author": "Vinod"}, {"date": "September 23, 2016 - 6:31 pm", "content": "Hi Vinod,Thank you for answering me.So as the try - catch reduces a lot the Pushingbox server error in accepting data from TS, I would try then a wait before the webwrite in catch, in pseudo code:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0try\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 webwrite\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0catch\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 WAIT <- how to put here a 2 seconds 'wait' here. \u00a0I think a two second wait and then 'insist' will work\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 webwrite\u00a0Is that possible? It seems that there is a slot of time for us to 'run' our Analysis in your servers (I think)\u00a0Thank you in advance for any help\u00a0", "num_user_post": " 91", "author": "piajola"}, {"date": "September 24, 2016 - 10:06 pm", "content": "If you are looking to send email from MATLAB on some error condition, you can do so following the directions here.You can generate an app specific password in gmail and use the SENDMAIL function in MATALB inside of your\u00a0exception handling CATCH clause to send an email on every failure, instead of waiting until the failure count exceeds the limit in ThingSpeak.I hope this helps!", "num_user_post": " 225", "author": "Vinod"}, {"date": "September 26, 2016 - 3:37 pm", "content": "Vinod,Thank you for your help. And apologies for the delay I was waiting for mondayI will try send SENDMAIL but it seems it sends fixed strings ...I use pushingbox (the only I am aware) because I can send variables (character strings) so I can report the 'alarming' values.My Analysis work fine every time. When after the process wish to write values to another channel it does that perfectly. No need emails here.When some process has 'alarming' values uses the webwrite to send to pushingbox these variables. Pushingbox composes an email with those variables and are sent to my smartphone service provider (free) email server that also composes a (free) SMS sent to my phone. So I have the email subject in less than 30 seconds after the 'alarming' condition. Also report values hourly. Also if there are more than 5 minutes of 'no recording data' in my ThingSpeak (base) channelAll my tribulations start when pushingbox refuses the Thingspeak sendings with the '502' response and subsequent red line. And I have no email. That occurs with 2% of sent values. When I can see the red line and 'save and run' inmediately (on time) this 'repetition' is now accepted by pushingbox and all works. So the question if 'catch' is a little delayed the second webwrite will be accepted this time.Anyway thank you for your time", "num_user_post": " 91", "author": "piajola"}, {"date": "September 26, 2016 - 7:41 pm", "content": "Turns out I was wrong and the SENDMAIL function in MATLAB is not supported in MATLAB Analysis apps on ThingSpeak at this time.\u00a0Let me think of\u00a0a different solution for you.", "num_user_post": " 225", "author": "Vinod"}, {"date": "September 27, 2016 - 2:57 am", "content": "piajola\u00a0\u00a0\u00a0 Not sure of the details but you can capture the result of webwrite\u00a0\u00a0\u00a0 resp=webwrite(...)\u00a0\u00a0\u00a0 then (this is the bit that I dont know)\u00a0\u00a0\u00a0 if resp.status_code != 200\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 pause(60)\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 webwrite()\u00a0Hopefully one of the Matlab gurus will chime in with the correct syntax..\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0", "num_user_post": " 271", "author": "rw950431"}, {"date": "September 27, 2016 - 1:54 pm", "content": "Piajola,\u00a0You can use the try, catch construct in MATLAB to catch the errors in your MATLAB Analysis code and add a delay of two seconds as shown below,try\u00a0 \u00a0 webwrite(<Your call>);catch exception\u00a0 \u00a0% pause the execution for 2 seconds\u00a0 \u00a0 pause(2);\u00a0 \u00a0 webwrite(<Your call>);See the documentation for the pause\u00a0command. Note that pausing for more than 2 seconds is not allowed in MATLAB Analysis code.\u00a0", "num_user_post": " 12", "author": "jvasudev"}, {"date": "September 27, 2016 - 3:10 pm", "content": "Hi Vinod,Again thank you for your time. After writing my prior response to you I tried sendmail with a red output saying that is not for users of thingspeak I think\u00a0Anyway thank you for your concern\u00a0", "num_user_post": " 91", "author": "piajola"}, {"date": "September 27, 2016 - 3:12 pm", "content": "Hi rw950431,Thank you very much for your post. Will try that magic word 'pause' I was thinking it was 'wait' or 'delay'Search mathworks help is complicated if you do not have the 'exact word'Regards ", "num_user_post": " 91", "author": "piajola"}, {"date": "September 27, 2016 - 3:13 pm", "content": "Hi jvasudev,Thank you very much for your post.I have my code with try-catch but sometimes both webwrites fail. It seems the time to catch the 'catch exception' is not always enough for the 'insist'.So 'the ask' for the magical word that can get some more wait before the insist.Besides now I know the server slot time for us users is 2 sec.Once, trying a loop that become eternal ended in a red output sayimg I occuped all my turn and get out!Thanks again", "num_user_post": " 91", "author": "piajola"}, {"date": "September 27, 2016 - 10:21 pm", "content": "Interested to find out if webwrite throws an exception when the remote site returns a 502 error.\u00a0 My guess is that it wont..", "num_user_post": " 271", "author": "rw950431"}, {"date": "September 28, 2016 - 5:07 pm", "content": "Hello rw950431,Delay ... you know when you write I am sleeping and send my answer when you sleep, and also you live the next day\u00a0The code that ends in webwrite variables fails about 15 % so 15/100 rejects with 502 and the red line in my Analysis.The code that ends in\u00a0 \u00a0 \u00a0 \u00a0try\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 webwrite\u00a0 \u00a0 \u00a0 \u00a0catch \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 webwritefailed about 1 %Now with pause(1.5) in catch before webwrite 0 fails in almost 2 days. Time will tell ...I have webwrite in 3 analysis, 2 report each XXhour-0 min and XXHr-4 min. The third runs each 5 min checking there are 5 points of data (each minute I send 1 value) if there are 2 or less points I webwrite how many points are recorded, so this is 'random'In my Analysis when I send\u00a0 \u00a0 \u00a0 response = webwrite(....)it returns\u00a0 \u00a0 \u00a0 response =\u00a0 \u00a0 \u00a0 \u00a0 1\u00d70 empty char arrayWhen webwrite fails in the Output box I find in redError using readContentFromWebServiceThe server returned the message: 'Bad Gateway' for URL, 'http://api.pushingbox.com/pushingbox' (with HTTP response code 502).Error in webwrite[varargout{1:nargout}] = readContentFromWebService(connection, options);In try-catch each webwrite has a very slight different text to know wich one was succesful or the red line if noneRegards\u00a0", "num_user_post": " 91", "author": "piajola"}, {"date": "September 30, 2016 - 1:01 am", "content": "Thats good news!\u00a0\u00a0 Glad to find that try/catch does work as expected.", "num_user_post": " 271", "author": "rw950431"}]}, {"url": "https://community.thingspeak.com/forum/matlab/error-index-exceeds-matrix-dimensions/", "posts": [{"date": "September 19, 2016 - 3:04 pm", "content": "Hello, I am getting error 'Index exceeds matrix dimensions' after running this peace of code in matlab analysis.\u00a0readChannelID = 106292;pumpFieldId = 5;readAPIKey = 'myApiKey';timeRange = 10;[pump, timeStamp] = thingSpeakRead(readChannelID, 'Fields', pumpFieldId, 'numMinutes', timeRange, 'ReadKey', readAPIKey);I can successfully read other channel's fields, except field5. This was working until September 15th. I have tried clear channel, but still it doesn't work. I have no idea what could be wrong.", "num_user_post": " 4", "author": "paul"}, {"date": "September 19, 2016 - 4:21 pm", "content": "Hi Paul,\u00a0I couldn't reproduce the error on my end since channel 106292 is a private channel. I replaced the channel ID with 12397, and the following code worked:readChannelID = 12397;pumpFieldId = 5;timeRange = 10;[pump, timeStamp] = thingSpeakRead(readChannelID, 'Fields', pumpFieldId, 'numMinutes', timeRange);Could you share the last 10 minutes worth of data in your channel (in json format) using the GET Feed endpoint (https://www.mathworks.com/help/thingspeak/get-a-channel-feed.html)?", "num_user_post": " 62", "author": "Adarsh_Murthy"}, {"date": "September 19, 2016 - 4:44 pm", "content": "Here you go Reveal Spoiler{'channel':{'id':106292,'name':'Solar heating','latitude':'0.0','longitude':'0.0','field1':'collector','field2':'boiler_mid','field3':'boiler_bottom','field5':'pump_state','created_at':'2016-04-06T14:50:48+03:00','updated_at':'2016-09-19T23:35:10+03:00','last_entry_id':52},'feeds':[{'created_at':'2016-09-19T22:57:09+03:00','entry_id':33,'field1':'9.31','field2':'52.44','field3':'21.88','field5':'0'},{'created_at':'2016-09-19T22:59:07+03:00','entry_id':34,'field1':'9.31','field2':'52.31','field3':'21.88','field5':'0'},{'created_at':'2016-09-19T23:01:11+03:00','entry_id':35,'field1':'9.25','field2':'52.31','field3':'21.88','field5':'0'},{'created_at':'2016-09-19T23:03:10+03:00','entry_id':36,'field1':'9.25','field2':'52.25','field3':'21.88','field5':'0'},{'created_at':'2016-09-19T23:05:08+03:00','entry_id':37,'field1':'9.25','field2':'52.13','field3':'21.88','field5':'0'},{'created_at':'2016-09-19T23:07:06+03:00','entry_id':38,'field1':'9.19','field2':'52.13','field3':'21.88','field5':'0'},{'created_at':'2016-09-19T23:09:10+03:00','entry_id':39,'field1':'9.13','field2':'52.13','field3':'21.81','field5':'0'},{'created_at':'2016-09-19T23:11:08+03:00','entry_id':40,'field1':'9.13','field2':'52.00','field3':'21.75','field5':'0'},{'created_at':'2016-09-19T23:13:06+03:00','entry_id':41,'field1':'9.13','field2':'52.44','field3':'21.63','field5':'0'},{'created_at':'2016-09-19T23:15:11+03:00','entry_id':42,'field1':'9.06','field2':'52.88','field3':'21.63','field5':'0'},{'created_at':'2016-09-19T23:17:09+03:00','entry_id':43,'field1':'9.06','field2':'53.00','field3':'21.63','field5':'0'},{'created_at':'2016-09-19T23:19:07+03:00','entry_id':44,'field1':'9.00','field2':'53.00','field3':'21.63','field5':'0'},{'created_at':'2016-09-19T23:21:11+03:00','entry_id':45,'field1':'9.00','field2':'52.88','field3':'21.63','field5':'0'},{'created_at':'2016-09-19T23:23:09+03:00','entry_id':46,'field1':'9.00','field2':'52.75','field3':'21.63','field5':'0'},{'created_at':'2016-09-19T23:25:07+03:00','entry_id':47,'field1':'8.94','field2':'52.69','field3':'21.63','field5':'0'},{'created_at':'2016-09-19T23:27:12+03:00','entry_id':48,'field1':'9.00','field2':'52.56','field3':'21.69','field5':'0'},{'created_at':'2016-09-19T23:29:09+03:00','entry_id':49,'field1':'8.94','field2':'52.50','field3':'21.69','field5':'0'},{'created_at':'2016-09-19T23:31:08+03:00','entry_id':50,'field1':'8.88','field2':'52.44','field3':'21.69','field5':'0'},{'created_at':'2016-09-19T23:33:05+03:00','entry_id':51,'field1':'8.94','field2':'52.38','field3':'21.69','field5':'0'},{'created_at':'2016-09-19T23:35:10+03:00','entry_id':52,'field1':'8.94','field2':'52.25','field3':'21.69','field5':'0'}]}I am afraid that it is channel specific problem.", "num_user_post": " 4", "author": "paul"}, {"date": "September 20, 2016 - 8:40 am", "content": "Thanks for sharing the data. I am able to reproduce the error.While we are working on fixing thingSpeakRead, here are two options that you could consider:Option 1:- Enable Field 4: In the\u00a0channel settings tab of Channel 106292, enable Field 4 by selecting the check box. This should resolve the error. Note that you don't need to add Field 4 Chart to your Channel view page. To disable the Field 4 chart, click on the 'x'. You can add it back later by using the 'Add Visualizations' button.\u00a0Option 2:- Edit the thingSpeakRead call: Instead of option 1, you could change the MATLAB code to:[data, timeStamp] = thingSpeakRead(readChannelID, 'numMinutes', timeRange, 'ReadKey', readAPIKey);pump = data(:, 4);\u00a0Let me know if this doesn't fix the error for you. We\u00a0will post again when thingSpeakRead() is updated.\u00a0Thanks,Adarsh", "num_user_post": " 62", "author": "Adarsh_Murthy"}, {"date": "September 20, 2016 - 1:12 pm", "content": "I used option 2 and it works now. Thanks for help", "num_user_post": " 4", "author": "paul"}]}, {"url": "https://community.thingspeak.com/forum/matlab/matlab-error-thingspeak-encountered-an-internal-error-try-executing-your-code-again/", "posts": [{"date": "September 16, 2016 - 3:50 pm", "content": "The MATLAB plot() function to visualize ThingSpeak\u00a0data:plot(xdata, ydata)might generate the following error if xdata is a datetime vector:ThingSpeak encountered an internal error. Try executing your code again.\u00a0To resolve the error, use the following commands instead:\u00a0plot(datenum(xdata), ydata)datetick;", "num_user_post": " 62", "author": "Adarsh_Murthy"}, {"date": "September 20, 2016 - 9:06 am", "content": "The\u00a0plot function on ThingSpeak\u00a0has been updated to resolve the error. You can now\u00a0visualize ThingSpeak channel data using the plot function even when xdata is a datetime vector. For example:[data, time] = thingSpeakRead(12397, 'NumPoints', 10, 'Fields', 4);plot(time, data);title('Temperature Plot');", "num_user_post": " 62", "author": "Adarsh_Murthy"}]}, {"url": "https://community.thingspeak.com/forum/matlab/export-matlab-visualisation-as-an-image/", "posts": [{"date": "September 16, 2016 - 2:07 am", "content": "Anyone know if its possible to export a matlab visualization automatically as an image file? \u00a0Say I wanted to save a snapshot at a given time or when a given condition occurs.", "num_user_post": " 271", "author": "rw950431"}, {"date": "September 16, 2016 - 2:45 pm", "content": "It should be possible to\u00a0use the SAVEAS\u00a0function in MATLAB to save a figure to an image\u00a0and then upload it to dropbox using dropbox's REST API and the WEBWRITE function.\u00a0The\u00a0condition detection could be in your MATLAB code.", "num_user_post": " 225", "author": "Vinod"}, {"date": "September 16, 2016 - 5:50 pm", "content": "Since an example is more useful than general instruction, I have this example for you.\u00a0\u00a0Step 1: Sign up for a dropbox account if you don't already have one.Step 2: Go to\u00a0https://www.dropbox.com/developers/apps\u00a0and create a new App. Select 'Dropbox API' and 'App folder' as your choice for item\u00a0(1) and (2). For\u00a0item (3), pick a name. I use 'ThingSpeak' as the name of the folder. Click 'Create App'Step 3: On the page click 'Generate access token'. Copy down this string exactly; it will be needed in your MATLAB app.Step 4: In ThingSpeak, create a new MATLAB Visualization appFor\u00a0the MATLAB code, type this:\u00a0\u00a0tstamp = regexprep(char(datetime('now','format','yyyy-MM-dd''T''HH:mm')),':| |-','_');fname = fullfile(tempdir,sprintf('ImageGeneratedAt_%s.jpg', tstamp));plot(rand(1,10));if <some condition>\u00a0\u00a0 \u00a0\u00a0saveas(gcf,fname);\u00a0 \u00a0\u00a0\u00a0dropboxAccessToken = '<insert your dropbox access token here, without angle brackets>';\u00a0\u00a0\u00a0 \u00a0fid = fopen(fname, 'r');\u00a0\u00a0\u00a0 \u00a0data = char(fread(fid)');\u00a0\u00a0\u00a0 \u00a0fclose(fid);\u00a0\u00a0\u00a0 \u00a0headerFields = {'Authorization', ['Bearer ', dropboxAccessToken]};\u00a0\u00a0\u00a0 \u00a0headerFields{2,1} = 'Content-Length';\u00a0\u00a0\u00a0 \u00a0headerFields{2,2} = string(length(data));\u00a0\u00a0\u00a0 \u00a0headerFields = string(headerFields);\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0opt = weboptions;\u00a0\u00a0\u00a0 \u00a0opt.MediaType = 'application/octet-stream';\u00a0\u00a0\u00a0 \u00a0opt.CharacterEncoding = 'ISO-8859-1';\u00a0\u00a0\u00a0 \u00a0opt.RequestMethod = 'post';\u00a0\u00a0\u00a0 \u00a0opt.HeaderFields = headerFields;\u00a0\u00a0\u00a0 \u00a0\u00a0[~,remoteFName, remoteExt] = fileparts(fname);\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0webwrite(sprintf('https://api-content.dropbox.com/1/files_put/auto/%s%s',remoteFName,remoteExt), data, opt);end\u00a0Modify your to be the condition when\u00a0you want to save the\u00a0snapshot of your MATLAB visualization. Remember to modify the dropboxAccessToken to exactly be the token you got from dropbox.\u00a0Presumably you will replace the plot(rand(1,10)) with some other interesting plot you want to make.Now, whenever this MATLAB App is run, if <some condition> is met, you will see a .jpg file show up in your dropbox folder.\u00a0Enjoy!", "num_user_post": " 225", "author": "Vinod"}, {"date": "September 16, 2016 - 6:22 pm", "content": "If you can define your condition\u00a0in\u00a0a React app, then you can\u00a0create a MATLAB Analysis app that runs in the React to\u00a0generate the plot in your Dropbox folder. The MATLAB analysis app would\u00a0be:\u00a0tstamp = regexprep(char(datetime('now', 'format', 'yyyy-MM-dd''T''HH:mm')), ':| |-', '_');fname = fullfile(tempdir,sprintf('ImageGeneratedAt_%s.jpg', tstamp));eval('plot(rand(1,10))');saveas(gcf, fname);dropboxAccessToken = '<insert your dropbox access token here, without angle brackets>';fid = fopen(fname, 'r');data = char(fread(fid)');fclose(fid);headerFields = {'Authorization', ['Bearer ', dropboxAccessToken]};headerFields{2,1} = 'Content-Length';headerFields{2,2} = string(length(data));headerFields = string(headerFields);\u00a0opt = weboptions;opt.MediaType = 'application/octet-stream';opt.CharacterEncoding = 'ISO-8859-1';opt.RequestMethod = 'post';opt.HeaderFields = headerFields;[~,remoteFName, remoteExt] = fileparts(fname);\u00a0webwrite(sprintf('https://api-content.dropbox.com/1/files_put/auto/%s%s',remoteFName,remoteExt), data, opt);\u00a0This MATLAB analysis app will\u00a0be triggered based on your condition specified in the React and the MATLAB visualization should show up in your Dropbox's Apps/ThingSpeak\u00a0folder.\u00a0You will need to modify the eval('plot(rand(1,10))') to do whatever interesting visualization you want.", "num_user_post": " 225", "author": "Vinod"}, {"date": "September 17, 2016 - 4:49 pm", "content": "Hi Vinod,Thank you for the 'tips'My experience follows:Blindly following your steps with Visualizations, worked fine ...I have some working Visualizations:- with Plot- with Annotation (sort of color boxes with numbers inside)- with Histogramall worked, all are in DropBoxBUT ...I have two types- with thingSpeakPlot(time, [ humidityData,temperatureData], 'legend',{'H %', 'T *C'});- with thingSpeakPlotYY( time2, data2,time1, data1, 'YGrid1','on','YLabel1','% H.R.',...'YLabel2','*C','XLabel','Feha y hora',...'Title','Tempix y Humix ultimas semana');code finished with this error(?) messagecurl: /opt/mlsedu/matlab/R2016b/bin/glnxa64/libcurl.so.4: no version information available (required by curl){'revision': 15, 'bytes': 9704, 'thumb_exists': true, 'rev': 'f4e35680f', 'modified': 'Sat, 17 Sep 2016 20:06:49 +0000', 'mime_type': 'image/jpeg', 'path': '/Mimagen_2016_09_17T15_06.jpg', 'is_dir': false, 'size': '9.5 KB', 'root': 'app_folder', 'client_mtime': 'Sat, 17 Sep 2016 20:06:48 +0000', 'icon': 'page_white_picture'}with a white box in DropBox. There is a file.Not tried your Analysis because I do not know how to eval(...) my 'visualizations'. Your example is one line eval('one_line_only') and I need to read data (thingspeakRead) and more lines with the parameters, etc. How to do thatAnd keep the 'tips' coming", "num_user_post": " 91", "author": "piajola"}, {"date": "September 18, 2016 - 9:45 pm", "content": "thingSpeakPlot and thingSpeakPlotYY use a different technology and my solution will not work for\u00a0those functions.However, you can still use the PLOT and YYAXIS\u00a0functions in your MATLAB Analysis app and use the suggestion as above. As for multi line analysis, you can do all of that using\u00a0MATLAB code. The only thing that needs to be in the eval('<plot something>') is the MATLAB commands for plotting, which is typically just one line of code anyway.Switching to pseudo code as I don't have a concrete example:thingSpeakRead(....) MATAB code for mathematical analysis ... eval('<plot something>') MATLAB code to capture snapshot and upload to dropbox ...\u00a0If you have a public\u00a0channel with data that you would be comfortable sharing, along with the MATLAB analysis and visualizations you currently have,\u00a0I may be able to transcode it for you.", "num_user_post": " 225", "author": "Vinod"}, {"date": "September 19, 2016 - 1:41 am", "content": "Vinod/\u00a0\u00a0 Thats a neat hack! Wonder if the same technique could be used with imgur?\u00a0 Looks a little more complex due to OAuth and the 1-month expiry on access tokens. https://api.imgur.com/oauth2", "num_user_post": " 271", "author": "rw950431"}, {"date": "September 19, 2016 - 8:09 pm", "content": "Hi Vinod,Thank you very much for your explanation and offer.Sorry for the delayed postReading PLOT and YYAXIS and trying I have now the plots going to Dropbox\u00a0Again thanks a lot\u00a0", "num_user_post": " 91", "author": "piajola"}]}, {"url": "https://community.thingspeak.com/forum/matlab/average-3-fields-and-dynamic-update/", "posts": [{"date": "September 15, 2016 - 12:28 pm", "content": "This is really a 2 part question:1. How do you average data from 3 fields that I've read in using thingSpeakRead? \u00a0This is data taken from 3 different temperature sensors that I want to average across the 3 sensors and\u00a0have this be done for each time that the samples are taken. \u00a0In other words, I want to calculate and display one temp-time graph out of 3.2. How do you automatically trigger a refresh based on data that is being updated/sent to ThingSpeak?", "num_user_post": " 4", "author": "David"}, {"date": "September 15, 2016 - 9:53 pm", "content": "Here is the basic outline. \u00a0Create a MATLAB analysis that does something like this:______________Temp1 = thingSpeakRead ...Temp2 = thingSpeakRead ...Temp3 = thingSpeakRead ...allTemp = [Temp1,Temp2,Temp3];meanTemp = mean(allTemp);chID = xxxxx; % Your channel ID for the mean temp% Write the mean to a new channelthingSpeakWrite(chId,meanTemp);_______________To 'automatically trigger a refresh based on data that is being updated/sent to ThingSpeak'\u00a0use the React App to run your MATLAB analysis on insert of your data (assuming you can reliably use one of you three temp readings to trigger with the other two already updated). \u00a0If React timing is an issue then try the TimeControl App.", "num_user_post": " 4", "author": "Robert Mawrey"}, {"date": "September 16, 2016 - 8:45 am", "content": "You may also find the\u00a0movmean\u00a0and\u00a0movmedian\u00a0functions to be highly useful as well.\u00a0-Rob", "num_user_post": " 47", "author": "Rob Purser"}, {"date": "September 19, 2016 - 6:33 pm", "content": "Exactly what I was looking for. \u00a0Thanks for the help!\u00a0", "num_user_post": " 4", "author": "David"}]}, {"url": "https://community.thingspeak.com/forum/matlab/error-message-value-must-be-a-1x2-vector-of-increasing-datetime-values/", "posts": [{"date": "September 16, 2016 - 3:56 pm", "content": "If you are manually setting the axis limits of your plot using the datenum function as below:\u00a0plotHandle.Parent.XLim = [datenum(datetime('8-August-2016')), datenum(datetime('20-August-2016'))]\u00a0the following error might be generated:\u00a0Error using matlab.graphics.axis.decorator.DatetimeRuler/validateLimitsValue must be a 1x2 vector of increasing datetime values.Error in matlab.graphics.axis.decorator.DatetimeRuler/setLimitsDelegate\u00a0To resolve the error, use the following command instead:\u00a0plotHandle.Parent.XLim = [(datetime('8-August-2016'), datetime('20-August-2016')]", "num_user_post": " 62", "author": "Adarsh_Murthy"}]}, {"url": "https://community.thingspeak.com/forum/matlab/log-scaling-problem/", "posts": [{"date": "September 8, 2016 - 7:27 pm", "content": "I'm trying to plot data on a log scale using this code fragment:thingSpeakPlot(time, light, 'YScale','log');however all I get is an empty chart. \u00a0The X-axis has time values, but no Y-axis value or data plotted. \u00a0The data is read in correctly - I can see it when I plot it without the log. \u00a0Can anyone shed some light on this.", "num_user_post": " 4", "author": "David"}, {"date": "September 8, 2016 - 11:52 pm", "content": "HI\u00a0vwgtimk5,It works without any issues in my case ... I hope this help you\u00a0copy - paste this code (blindly, no questions, no typing) in a\u00a0MATLAB Visualizations in MATLAB Codetime = 0:1:5light = exp(time)% thingSpeakPlot(time, light);% thingSpeakPlot(time, light, 'YScale','log');2 tries,first try, erase % in first\u00a0thingSpeakPlot and Save and Run. \u00a0See in 'output' the values for time and\u00a0light and the\u00a0MATLAB Plot Outputsecond try, put again % in the first\u00a0thingSpeakPlot and\u00a0erase % in second thingSpeakPlot and Save and Run. See results.Maybe the characters in your machine are different.(?)Good luck", "num_user_post": " 91", "author": "piajola"}, {"date": "September 10, 2016 - 12:40 pm", "content": "It turns out that I had zeros in my data. \u00a0The log plot works fine once I adjusted the offending 0 values.", "num_user_post": " 4", "author": "David"}]}, {"url": "https://community.thingspeak.com/forum/matlab/plot-a-bar-graph-using-matlab/", "posts": [{"date": "August 23, 2016 - 11:16 pm", "content": "Anyone know how to make matlab plot a bar (column) graph instead of a line?\u00a0I've got this graph https://imgur.com/a/ELcjl\u00a0 which I would like to plot as a bar graph with a different colors for positive and negative values.What I am looking for is kind of like the stem plots (https://au.mathworks.com/help/thingspeak/thingspeakstem.html) but I would really like solid bars rather than lines with circles on the ends.", "num_user_post": " 271", "author": "rw950431"}, {"date": "August 24, 2016 - 8:02 am", "content": "Hi. You might be looking for a histogram (or hist). I will check with others to find other options.\u00a0", "num_user_post": " 402", "author": "Hans"}, {"date": "August 24, 2016 - 1:20 pm", "content": "Histogram is a good option if you want to look at frequency of observations or variation. \u00a0However, if you want a 'traditional' bar or column chart, take a look at the bar\u00a0and barh commands in MATLAB.For example, to make a bar graph of the cars going east bound for the past 10 minutes from our car counter:cars = thingSpeakRead(38629,'OutputFormat','table','NumMinutes',10);bar(datenum(cars.Timestamps),cars.NumberOfEastboundCars)datetickRob", "num_user_post": " 47", "author": "Rob Purser"}, {"date": "August 24, 2016 - 9:30 pm", "content": "Thanks Rob..\u00a0 I got this code that works but looks pretty crappy.\u00a0 Do you know how I can set the width so the bars dont have gaps between them? I tried the width parameter but it seems to make no difference.https://thingspeak.com/apps/matlab_visualizations/89481\u00a0% Draw a bar graph of Interconnector power% red for positive, blue for negativepower = unique(thingSpeakRead(148317,'OutputFormat','table','NumDays',1));pos=power(power.Interconnect > 0,:)neg=power(power.Interconnect <= 0,:)%bar(datenum(power.Timestamps),power.Interconnect,1.0)bar(datenum(neg.Timestamps),neg.Interconnect,'r')hold onbar(datenum(pos.Timestamps),pos.Interconnect,'b')hold offdatetick\u00a0", "num_user_post": " 271", "author": "rw950431"}, {"date": "August 25, 2016 - 1:34 pm", "content": "Now you're getting into aesthetics.\u00a0The doc pages linked earlier\u00a0provide a lot of info and examples on the large number of parameters you can tweak to your liking. \u00a0Based on your comment, you want 'BarWidth' to be 1. \u00a0I'd suggest setting EdgeColor to match the FaceColor as well.cars = thingSpeakRead(38629,'OutputFormat','table','NumMinutes',10);h = bar(datenum(cars.Timestamps),cars.NumberOfEastboundCars,'r',... 'BarWidth',1,'EdgeColor','r');hold onh2 = bar(datenum(cars.Timestamps),-cars.NumberOfWestboundCars,'b',... 'BarWidth',1,'EdgeColor','b');datetickhold off-Rob", "num_user_post": " 47", "author": "Rob Purser"}, {"date": "August 25, 2016 - 11:42 pm", "content": "Rob/\u00a0\u00a0 Thanks for the info.\u00a0One-day graph looks much better..https://thingspeak.com/apps/matlab_visualizations/89481\u00a0however extending the time-frame to 3 days still leaves a little to be desiredhttps://thingspeak.com/apps/matlab_visualizations/89640% Draw a bar graph of Interconnector power% red for positive, blue for negativepower = unique(thingSpeakRead(148317,'OutputFormat','table','NumDays',3));pos=power(power.Interconnect > 0,:)neg=power(power.Interconnect <= 0,:)%bar(datenum(power.Timestamps),power.Interconnect,1.0)bar(datenum(neg.Timestamps),neg.Interconnect,'r','BarWidth',1,'EdgeColor','r')hold onbar(datenum(pos.Timestamps),pos.Interconnect,'b','BarWidth',1,'EdgeColor','b')hold offgrid ontitle 'South Australian Interconnector Load'ylabel 'Net Power (MW)'legend('Buying Power','Selling Power')datetick('x','dd/mm')", "num_user_post": " 271", "author": "rw950431"}, {"date": "August 29, 2016 - 9:19 am", "content": "Given the amount of data that your looking to plot\u00a0in a single chart, another option to consider is an area chart.\u00a0Here is an example code snippet:\u00a0power = unique(thingSpeakRead(148317,'OutputFormat','table','NumDays',3));% Make a copy of the data to manipulate for the area plotpos = power.Interconnect;% For the positive data define all points less than or equal to zero to be NaNpos(pos <= 0) = NaN;% Make a copy of the data to manipulate for the area plotneg=power.Interconnect;% For negative data define all points greater than zero to be NaNneg(neg > 0) = NaN;% Plot the negative dataarea(datenum(power.Timestamps),neg, 'FaceColor', 'r');hold on% Plot the positive dataarea(datenum(power.Timestamps),pos, 'FaceColor', 'b');% Additional settingshold offgrid ontitle 'South Australian Interconnector Load'ylabel 'Net Power (MW)'legend('Buying Power','Selling Power')datetick('x','dd/mm')", "num_user_post": " 62", "author": "Adarsh_Murthy"}, {"date": "August 29, 2016 - 7:15 pm", "content": "Thanks Adarsh, that looks great.https://thingspeak.com/apps/matlab_visualizations/90293Is there an easy way to reduce the areas of unused space at the beginning and end of the plotted data?\u00a0 Currently my plot has 3 days of data but a 4-day timescale.", "num_user_post": " 271", "author": "rw950431"}, {"date": "August 31, 2016 - 10:04 am", "content": "axis('tight') should\u00a0do the trick. Here is the full doc for the function if you want to set custom limits:http://www.mathworks.com/help/matlab/ref/axis.html\u00a0", "num_user_post": " 62", "author": "Adarsh_Murthy"}, {"date": "August 31, 2016 - 7:59 pm", "content": "Fabulous!\u00a0 Thanks very much", "num_user_post": " 271", "author": "rw950431"}]}, {"url": "https://community.thingspeak.com/forum/matlab/limits-on-data-size-for-matlab-plots/", "posts": [{"date": "August 28, 2016 - 5:55 am", "content": "Attempted to plot 3 days worth of 5 minute data (https://thingspeak.com/apps/matlab_visualizations/89640) but the matlab visualisation gives the following error:-ThingSpeak cannot display the amount of data requested. Reduce the size of the output or suppress the output with a semicolon.\u00a0I calculated that 5 min data for 3 days should only be 864 points.\u00a0What is the limit?\u00a0 Less than 1000 data points doesn't seem very generous.", "num_user_post": " 271", "author": "rw950431"}, {"date": "August 29, 2016 - 10:06 am", "content": "There are two topics here:\u00a01. Number of characters\u00a0displayed in the 'Output' window of a MATLAB Analysis or Visualization App page2. Number of points to be visualized in a plotThe error message that is generated for your case is due to topic #1 - too many characters are being returned to the 'Output' window.\u00a0Since I don't have your code, the general suggestion to resolve this error is to end your MATLAB commands with a semicolon ';'. This prevents the LHS arguments from being printed to the 'Output' window.\u00a0For example:- Return characters to Output windowdata = thingSpeakRead(12397)- Do\u00a0not return characters to Output windowdata = thingSpeakRead(12397);\u00a0If this doesn't resolve the error, share your code and I might be able to find the cause of the error.-Adarsh", "num_user_post": " 62", "author": "Adarsh_Murthy"}, {"date": "August 29, 2016 - 7:05 pm", "content": "Thanks Adarsh.. adding the trailing semi-colons fixed it.", "num_user_post": " 271", "author": "rw950431"}]}, {"url": "https://community.thingspeak.com/forum/matlab/create-a-channel-within-matlab/", "posts": [{"date": "July 18, 2016 - 3:34 pm", "content": "Is this possible? I'm able to do so outside of Matlab by sending a POST request to\u00a0https://api.thingspeak.com/channels via the procedure outlined at http://www.mathworks.com/help/thingspeak/create-a-channel.htmlBut I'd like to do so within Matlab so I'm seeking another method.\u00a0", "num_user_post": " 4", "author": "jemapel"}, {"date": "July 18, 2016 - 4:56 pm", "content": "Hi ,\u00a0You can use the following MATLAB code as a template to send a POST request to create a channel from within MATLAB,\u00a0UserApiKey = 'xxxxxxxxx'; % This is your account API key found on the Account -> My Account Pageurl = 'https://api.thingspeak.com/channels.json';\u00a0data = ['api_key=',UserApiKey, '&name=test channel']; % These are the parameters for the POST requestresponse = webwrite(url,data) % Using webwrite command to send a POST request\u00a0You can visit the\u00a0https://www.mathworks.com/help/thingspeak/queue-commands-using-the-talkback-app-from-matlab.html\u00a0for an example as how to use MATLAB commands to send GET and POST requests.\u00a0\u00a0", "num_user_post": " 12", "author": "jvasudev"}]}, {"url": "https://community.thingspeak.com/forum/matlab/combine-3-private-channels-in-to-one-graph/", "posts": [{"date": "June 21, 2016 - 8:37 am", "content": "Hey,Im trying to get around the 15 sec update limit by having 3 channels that update depending on a few counters on the arduino.I was hoping the next part would be easy, but it isn't.The data I am sending to each channel is very basic. Its a door bell counter, so its either 0 or 1.If the bell is pressed a few times within 15 seconds, then it will send the three 1's to different channels. The rest of the presses are disregarded.I would like to show the combined presses with a 30sec timescale on another channel as a vertical line graph.Can anyone help?\u00a0This is what I have so far:\u00a0readChannelID1 = XXXXXX;readChannelID2 = XXXXXX;readChannelID3 = XXXXXX;readAPIKey1 = 'XXXXXXXXXXXXXXXXX';readAPIKey2 = 'XXXXXXXXXXXXXXXXX';readAPIKey3 = 'XXXXXXXXXXXXXXXXX';chan1 = thingSpeakRead(readChannelID1, 'Fields', 1, 'ReadKey', readAPIKey1, 'NumDays',2);chan2 = thingSpeakRead(readChannelID2, 'Fields', 1, 'ReadKey', readAPIKey2, 'NumDays',2);chan3 = thingSpeakRead(readChannelID3, 'Fields', 1, 'ReadKey', readAPIKey3, 'NumDays',2);thingSpeakPlot(chan1, chan2, chan3);", "num_user_post": " 2", "author": "jamin"}, {"date": "June 21, 2016 - 8:39 pm", "content": "Suspect you need to read the timestamps as well as the data from the 3 channels .\u00a0\u00a0 I dont know enough Matlab to show exactly how to do this \u00a0 maybe this will work, maybe not\u00a0[data1,time1] = thingSpeakRead(..)[data2,time2] = thingSpeakRead(..)[data3,time3] = thingSpeakRead(..)plot(time1,data1,time2,data2,time3,data3)\u00a0(Based off https://au.mathworks.com/help/matlab/ref/plot.html)", "num_user_post": " 271", "author": "rw950431"}, {"date": "June 22, 2016 - 3:12 am", "content": "Hey rw950431,This is creating the errorError using horzcatDimensions of matrices being concatenated are not consistent.Will keep searching Google.Cheers", "num_user_post": " 2", "author": "jamin"}, {"date": "June 22, 2016 - 9:52 pm", "content": "Guessing that its complaining because the arrays have different numbers of data points..\u00a0 Does it work if you only plot one series at a time?plot(time1,data1)You may end having to figure out how to merge the 3 datasets together before plotting- please show me how to do it when you figure it out..", "num_user_post": " 271", "author": "rw950431"}]}]}