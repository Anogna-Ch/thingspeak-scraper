{"url": "https://community.thingspeak.com/forum/arduino/page-3/", "threads": [{"url": "https://community.thingspeak.com/forum/arduino/sending-data-from-sd-card-to-thing-speak-in-batches/", "posts": [{"date": "November 13, 2017 - 8:45 pm", "content": "Hello Everyone,I want to send the data stored in SD card in batches to thing speak channels but I am not able to figure out how to send it.Please help me in sharing a code or information so that I have a brief idea of the connectivity operation.Help in this regard would be really appreciated.CheersAkash Gupta", "num_user_post": " 1", "author": "beingakash"}, {"date": "November 14, 2017 - 11:35 am", "content": "Have a look at the getting started tutorial, it will take you through the process step by step of setting up a channel, getting data from another channel, and then processing and visualizing that data. After that short study, you should be ready to check out the device\u00a0examples\u00a0for an example based on the hardware you want to use.\u00a0 You will need some kind of device to read from the SD card, such as an Arduino, RPi, or some other processor.The bulk update will let you send larger batches of data in one REST API call.", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/arduino/upload-two-values-to-thingspeak-with-a-arduino-gsm-module/", "posts": [{"date": "June 2, 2017 - 4:05 am", "content": "Halo everyone,I want to upload 2 values to ThingSpeak in feld1 and feld2. I use an Arduino uno and a GSM module for that. I have already work out some code that work but not as good as I want. I am working with the ThingSpeak.h but I don\u2019t think the library good for the use with the GSM Module. The problem with the code below is that die code stops working after the two values are sended to ThingSpeak. So the loop function just stop there. I don\u2019t know why.\u00a0 Even when after the function writeFields() some more function came. The getLastReadStatus () doesn\u2019t work also. Do you have any idea how to fix this problem? The loop function and the values should send some values over and over again.Or do you know other methods to upload more very values to ThingSpeak with the GSM module from Arduino?thank you in advance.\u00a0//------------------------------------Bibliotheken--------------------------------------------------------------------------------------------------------------#include <SPI.h>#include <GSM.h>#include 'ThingSpeak.h'//------------------------------------Definitionen f\u00fcr SIM-Karte------------------------------------------------------------------------------------------------#define PINNUMBER 'XXX'#define GPRS_APN 'internet.t-mobile'#define GPRS_LOGIN 't-mobile'#define GPRS_PASSWORD 'XXX'//------------------------------------Variablen f\u00fcr SIM-Karte---------------------------------------------------------------------------------------------------GSMClient client;GPRS gprs;GSM gsmAccess;uint16_t reset = 0;int Wert1 = 80; /int Wertalt;boolean neuerWert = true;int Wert2 =5;long lastConnectionTime = 0;boolean lastConnected = false;int failedCounter = 0;//------------------------------------Variablen f\u00fcr Datencloud--------------------------------------------------------------------------------------------------const char * myWriteAPIKey = 'XXX';unsigned long myChannelNumber = 000;//Z\u00e4hlervariablen f\u00fcr neunstartint seconds =0;//CanAktiv erkennenboolean CANschlaf=false;boolean GSMaus=true;\u00a0void setup() { Serial.begin(9600); // Initialiesiere Serial port (Baudrate:9600) ThingSpeak.begin(client); pinMode(5, INPUT); //die Pins 9,6 und 3 sind durch die ThingSpeak lib schon beleckt und werden zum ansteuern einer RGB genutzt. Solten nicht verwendet werden. digitalWrite(5,HIGH); pinMode(2, INPUT); CANschlaf=digitalRead(5); startGSM(); GSMaus=false;}\u00a0void loop() {// Update ThingSpeak if(neuerWert== true && Wert1 > 0) { if(GSMaus==true) { startGSM(); GSMaus=false; } ThingSpeak.setField(1,Wert1); ThingSpeak.setField(2,Wert2); ThingSpeak.writeFields(myChannelNumber, myWriteAPIKey); int resultCode = ThingSpeak.getLastReadStatus(); if(resultCode == 200) { Serial.print('OK'); } else { Serial.print('Error reading message. Status was: '); Serial.println(resultCode); } neuerWert == false; delay(15000); Wert1--; } // Check if Arduino Ethernet needs to be restarted if (failedCounter > 3 ) { startGSM(); GSMaus=false; } lastConnected = client.connected();}void startGSM() { boolean notConnected = true; Serial.println('try to connect to GSM...'); while(notConnected) { if ((gsmAccess.begin(PINNUMBER) == GSM_READY) & (gprs.attachGPRS(GPRS_APN, GPRS_LOGIN, GPRS_PASSWORD) == GPRS_READY)) notConnected = false; else { Serial.println('Not connected'); delay(1000); } } Serial.println('Connected');}", "num_user_post": " 4", "author": "ICar"}, {"date": "June 3, 2017 - 1:22 am", "content": "Does startGSM() claim to succeed? \u00a0- Do you get the 'connected' message printed out..Perhaps you can try calling Thingspeak.begin() \u00a0only after you connect to GSM rather than before?If that doesnt work you can avoid the thingspeak library altogether and just construct the URL yourself (its possible that the thingspeak library isnt tested for GSM since the source only refers to WiFi and Ethernet)Sample code for a web client is https://www.arduino.cc/en/Tutorial/GSMExamplesWebClientThe URL you need can be found on the 'Data Import/Export' tab of your channel page on the thingspeak website.", "num_user_post": " 271", "author": "rw950431"}, {"date": "June 3, 2017 - 5:51 am", "content": "Thang you for your tip. Yes the startGSM() works fine and I get the Massage connected. I try your idea to change the position of Thingspeak.begin() after the startGSM() but the code still stops working after uploading the two values, like bevor. I think your right I should avoid the ThingSpeak.h library. I already working on come code for that. Down below is my code. With this code I am able to upload one value to feld1 on ThingSpeak but not two values. It looks easier than it is. When I call the function updateThingSpeak('field1='+analogValue) again for the fild2 I get a Bad request error.Any ideas?//------------------------------------Bibliotheken--------------------------------------------------------------------------------------------------------------\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0#include <SPI.h>\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0#include <GSM.h>//------------------------------------Definitionen f\u00fcr SIM-Karte------------------------------------------------------------------------------------------------\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0#define PINNUMBER 'XXX'\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0#define GPRS_APN 'internet.t-mobile'#define GPRS_LOGIN 't-mobile'#define GPRS_PASSWORD 'XX'//------------------------------------Variablen f\u00fcr SIM-Karte---------------------------------------------------------------------------------------------------\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0GSMClient client;GPRS gprs;GSM gsmAccess;uint16_t reset = 0;\u00a0 \u00a0 \u00a0int Wert1 = 0;\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 //Startwert auf 0 gesetztint WEert1_alt;boolean neuWert = true;long lastConnectionTime = 0;boolean lastConnected = false;int failedCounter = 0;//------------------------------------Variablen f\u00fcr Datencloud--------------------------------------------------------------------------------------------------\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 char thingSpeakAddress[] = 'api.thingspeak.com';String writeAPIKey = 'XXX';const int updateThingSpeakInterval = 16 * 1000; void setup() { \u00a0 Serial.begin(9600);\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // Initialiesiere Serial port (Baudrate:9600)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\u00a0 pinMode(9, OUTPUT);\u00a0 pinMode(2, INPUT);\u00a0 startGSM();\u00a0}void loop() {\u00a0\u00a0 String analogValue = String(Wert1, DEC);\u00a0 \u00a0\u00a0\u00a0 if (client.available())\u00a0 {\u00a0 \u00a0 char c = client.read();\u00a0 \u00a0 Serial.print(c);\u00a0 \u00a0\u00a0 }\u00a0\u00a0 // Disconnect from ThingSpeak\u00a0 if (!client.connected() && lastConnected)\u00a0 {\u00a0 \u00a0 Serial.print(Wert1);\u00a0 \u00a0 Serial.println('...disconnected');\u00a0 \u00a0 Serial.println();\u00a0 \u00a0 client.stop();\u00a0 \u00a0 neuWert = false;\u00a0 }\u00a0\u00a0 // Update ThingSpeak\u00a0 if(!client.connected() && (millis() - lastConnectionTime > updateThingSpeakInterval) && neuWert == true && Wert1 > 0)\u00a0 {\u00a0 \u00a0 updateThingSpeak('field1='+analogValue);\u00a0 }\u00a0\u00a0 // Check if Arduino Ethernet needs to be restarted\u00a0 if (failedCounter > 3 )\u00a0 {\u00a0 \u00a0 startGSM();\u00a0 \u00a0 }\u00a0\u00a0 lastConnected = client.connected();}\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 void startGSM() {\u00a0 \u00a0 boolean notConnected = true;\u00a0 \u00a0 Serial.println('try to connect to GSM...');\u00a0 \u00a0 while(notConnected) {\u00a0 \u00a0 \u00a0 \u00a0 if ((gsmAccess.begin(PINNUMBER) == GSM_READY) & (gprs.attachGPRS(GPRS_APN, GPRS_LOGIN, GPRS_PASSWORD) == GPRS_READY))\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 notConnected = false;\u00a0 \u00a0 \u00a0 \u00a0 else {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Serial.println('Not connected');\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 delay(1000);\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 }\u00a0 \u00a0 Serial.println('Connected');}void updateThingSpeak(String tsData){\u00a0 if (client.connect(thingSpeakAddress, 80))\u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0\u00a0 \u00a0 client.print('POST /update HTTP/1.1');\u00a0 \u00a0 client.print('Host: api.thingspeak.com');\u00a0 \u00a0 client.print('Connection: close');\u00a0 \u00a0 client.print('X-THINGSPEAKAPIKEY: '+writeAPIKey+'');\u00a0 \u00a0 client.print('Content-Type: application/x-www-form-urlencoded');\u00a0 \u00a0 client.print('Content-Length: ');\u00a0 \u00a0 client.print(tsData.length());\u00a0 \u00a0 client.print('');\u00a0 \u00a0 client.print(tsData);\u00a0 \u00a0\u00a0 \u00a0 lastConnectionTime = millis();\u00a0 \u00a0\u00a0 \u00a0 if (client.connected())\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 Serial.println('Connecting to ThingSpeak...');\u00a0 \u00a0 \u00a0 Serial.println();\u00a0 \u00a0 \u00a0 failedCounter = 0;\u00a0 \u00a0 }\u00a0 \u00a0 else\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 failedCounter++;\u00a0 \u00a0 \u00a0 Serial.println('Connection to ThingSpeak failed ('+String(failedCounter, DEC)+')');\u00a0 \u00a0\u00a0 \u00a0 \u00a0 Serial.println();\u00a0 \u00a0 }\u00a0 }\u00a0 else\u00a0 {\u00a0 \u00a0 failedCounter++;\u00a0 \u00a0 Serial.println('Connection to ThingSpeak Failed ('+String(failedCounter, DEC)+')');\u00a0 \u00a0\u00a0 \u00a0 Serial.println();\u00a0 \u00a0 lastConnectionTime = millis();\u00a0 }}", "num_user_post": " 4", "author": "ICar"}, {"date": "June 3, 2017 - 8:19 pm", "content": "Hi ICar,You sayint Wert1 = 0; //Startwert auf 0 gesetztgoogle helped me saying you say start with value=0but you never made it greater than 0and you checkif (!client.connected() && (millis() - lastConnectionTime > updateThingSpeakInterval) && neuWert == true && Wert1 > 0){to run your routine void updateThingSpeak(String tsData) that will never run\u00a0Also you can do (semi pseudo-code)analogValue = 'field1=' + str(Wert1) + 'field2=' + str(Wert2)......updateThingSpeak(analogValue);\u00a0Hope this is some helpGood luck (&& | ask again)", "num_user_post": " 91", "author": "piajola"}, {"date": "June 4, 2017 - 6:19 am", "content": "Hi piajola,You are absolutely right with the \u201cint Wert1=0\u201d. That was a volatile mistake from me.I am still working on the problem to upload two variables to ThingSpeak. The code example you give me (analogValue = 'field1=' + str(Wert1) + 'field2=' + str(Wert2) )looks good but how is the right implementation for that. I try a lot variation of that but still no idea. What did you mean with str?Thank you very much for your help.", "num_user_post": " 4", "author": "ICar"}, {"date": "June 4, 2017 - 5:56 pm", "content": "Hi ICar,str is 'string' the idea is concatenate one string from 2 strings plus 2 numbers. (convert the number to string)It depends in the 'type' of number int, float, etc.My particular case is I have 2 numbers from my sensor\u00a0 \u00a0 \u00a0 float valHumidity;\u00a0 \u00a0 \u00a0 float valTemperature;and thingspeak wants to receive one string that my 'internet device' must compose. So my string is\u00a0 \u00a0 altSer.print(F('GET /update?api_key=')); // 20 chars \u00a0 \u00a0 altSer.print(apiKey); \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0// 16 chars \u00a0 \u00a0 altSer.print(F('&field1=')); \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // 8 chars \u00a0 \u00a0 altSer.print(String(valTemperature)); \u00a0 \u00a0 \u00a0// 5 chars \u00a0 \u00a0 altSer.print(F('&field2=')); \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // 8 chars \u00a0 \u00a0 altSer.print(String(valHumidity)); \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0// 5 chars \u00a0 \u00a0 altSer.print(F('')); \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0// 4 charsbecause also I must say how many characters I am sending. Capital F so arduino put the fixed strings in flash and use less RAM\u00a0 \u00a0 \u00a0 '&field1='+String(valTemperature))+'&field2='+String(valHumidity))is the same string, but as I did is cleaner to see 2 years after to repeatMy device get the string and do whatever needed to send 'really to Internet'I do not know how to use your device but I think it is 'more or less' the same thing\u00a0Hope still making sense\u00a0", "num_user_post": " 91", "author": "piajola"}, {"date": "June 5, 2017 - 7:18 am", "content": "Hi piajola,Thank you very much for your help. It works now! Great idea to put both variables in one string. The solution is:\u00a0 \u00a0String analogValue = String(Wert1, DEC);\u00a0\u00a0 String analogValue2 = String(Wert2, DEC);\u00a0senden='&field1='+analogValue+'&field2='+ analogValue2;\u00a0and after this you can just call the \u201cupdateThingSpeak(senden);\u201d function.I am really happy now. Thank you again and great job.", "num_user_post": " 4", "author": "ICar"}, {"date": "June 5, 2017 - 5:06 pm", "content": "Hi ICar,Glad to know your status ...\u00a0Welcome to the exclusive club of Iot(ers) I hope for a long membershipAnd help someone you know you can help", "num_user_post": " 91", "author": "piajola"}, {"date": "November 13, 2017 - 9:20 am", "content": "Hi Icar,\u00a0Can I have your email cause I wanna do the same project like you but know nothing. Seems like your coding used some Deutsch language which I kinda not understood.\u00a0", "num_user_post": " 1", "author": "Mahathirz"}]}, {"url": "https://community.thingspeak.com/forum/arduino/arduino-zero-with-wifi101-shield-only-sends-two-updates/", "posts": [{"date": "September 6, 2017 - 8:55 pm", "content": "I have an Arduino Zero with WiFi 101 Shield. \u00a0Connected to WiFi and successfully sent data to my channel. \u00a0Problem is it only sends two updates, then stops updating. If I reset the Zero, it will send another two (with delay set in sketch). \u00a0WiFi light is on and network light glows periodically, so I know the Zero is trying to send the updates, but they don't show up in the channel.Any ideas?", "num_user_post": " 6", "author": "wjpavalko"}, {"date": "September 7, 2017 - 10:12 am", "content": "Can you connect the serial monitor and see what responses are being returned by ThingSpeak when you send the data?", "num_user_post": " 401", "author": "cstapels"}, {"date": "September 7, 2017 - 8:22 pm", "content": "I'm an admitted amateur at this, but can you advise how to print out communications between the Arduino and Thingspeak? \u00a0The example WriteVoltage code has no Serial connection. I assume I need to do more than just initialize a serial connection, e.g. add Serial.begin(9600).\u00a0", "num_user_post": " 6", "author": "wjpavalko"}, {"date": "September 14, 2017 - 9:58 pm", "content": "Any help from anyone else out there? \u00a0I tried an MKR1000 board and the same problem occurs. \u00a0I get two (not one, not three) updates each time the Arduino is rebooted, and then nothing. \u00a0Can't find out how to show communications with either of these boards.", "num_user_post": " 6", "author": "wjpavalko"}, {"date": "September 15, 2017 - 3:27 pm", "content": "Your ISP connection may be bad. \u00a0Try adding a connectWiFi() function and calling it each main loop if there is no connection:\u00a0<put this in loop>if(WiFi.status() != WL_CONNECTED) { connectWifi(); } // Make sure we have an internet connection\u00a0<put this after the end of your program>int connectWifi() { WiFi.begin(ssid, password); while (WiFi.status() != WL_CONNECTED) { delay(2500); Serial.println('Connecting to WiFi'); // Inform the serial output } Serial.println('Connected'); ThingSpeak.begin(client); }\u00a0You will need Serial.begin(9600) in your setup().For the thingspeak commands, you can at least test for success:int success=ThingSpeak.writeField(myChannelNumber, 1, voltage, myWriteAPIKey);Serial.println('success '+String(success));You can see the serial monitor by pressing ctrl shift m or hitting the plus/curcle icon on the right top of the IDE window.\u00a0Do you see the number of entries in your channel growing - even if you see no data in your plot?", "num_user_post": " 401", "author": "cstapels"}, {"date": "September 15, 2017 - 5:16 pm", "content": "Thanks. \u00a0I put in the code to reconnect the wifi, but it is not executed, so WiFi is connected.Still, after two updates, I get:Error code is: -301:ERR_CONNECT_FAILED", "num_user_post": " 6", "author": "wjpavalko"}, {"date": "October 1, 2017 - 4:54 pm", "content": "I solved this issue by disconnecting from the WiFi after updating my ThingSpeak channel:\u00a0void loop(){   WiFi.begin(ssid, pass);   delay(10000); // Waits 10 seconds to confirm connection      // Updates x fields in ThingSpeak   // Disconnects from the WiFi   WiFi.disconnect();    // ThingSpeak will only accept updates every 15 seconds   delay(20000);}", "num_user_post": " 1", "author": "AugustoEst"}, {"date": "October 2, 2017 - 10:17 am", "content": "Hi there,I have the same toppic but using a MKR 1000 with a TMP36.For trying I took the example 'write voltage' by Thingspeak-library in its newest version 1.3.My Arduino-IDE-version is 1.8.4Here is the sketch, a little bit modified after the last entry by AugustoEst:/* WriteVoltage Reads an analog voltage from pin 0, and writes it to a channel on ThingSpeak every 20 seconds. ThingSpeak ( https://www.thingspeak.com ) is an analytic IoT platform service that allows you to aggregate, visualize and analyze live data streams in the cloud. Copyright 2017, The MathWorks, Inc. Documentation for the ThingSpeak Communication Library for Arduino is in the extras/documentation folder where the library was installed. See the accompaning licence file for licensing information.*/#include 'ThingSpeak.h'// ***********************************************************************************************************// This example selects the correct library to use based on the board selected under the Tools menu in the IDE.// Yun, Ethernet shield, WiFi101 shield, esp8266, and MXR1000 are all supported.// With Yun, the default is that you're using the Ethernet connection.// If you're using a wi-fi 101 or ethernet shield (http://www.arduino.cc/en/Main/ArduinoWiFiShield), uncomment the corresponding line below// ***********************************************************************************************************#define USE_WIFI101_SHIELD//#define USE_ETHERNET_SHIELD#if defined(ARDUINO_AVR_YUN) #include 'YunClient.h' YunClient client;#else #if defined(USE_WIFI101_SHIELD) || defined(ARDUINO_SAMD_MKR1000) || defined(ARDUINO_ARCH_ESP8266) // Use WiFi #ifdef ARDUINO_ARCH_ESP8266 #include <ESP8266WiFi.h> #else #include <SPI.h> #include <WiFi101.h> #endif char ssid[] = '***'; // your network SSID (name) char pass[] = '***'; // your network password int status = WL_IDLE_STATUS; WiFiClient client; #elif defined(USE_ETHERNET_SHIELD) // Use wired ethernet shield #include <SPI.h> #include <Ethernet.h> byte mac[] = { 0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED}; EthernetClient client; #endif#endif#ifdef ARDUINO_ARCH_AVR // On Arduino: 0 - 1023 maps to 0 - 5 volts #define VOLTAGE_MAX 5.0 #define VOLTAGE_MAXCOUNTS 1023.0#elif ARDUINO_SAMD_MKR1000 // On MKR1000: 0 - 1023 maps to 0 - 3.3 volts #define VOLTAGE_MAX 3.3 #define VOLTAGE_MAXCOUNTS 1023.0#elif ARDUINO_SAM_DUE // On Due: 0 - 1023 maps to 0 - 3.3 volts #define VOLTAGE_MAX 3.3 #define VOLTAGE_MAXCOUNTS 1023.0#elif ARDUINO_ARCH_ESP8266 // On ESP8266: 0 - 1023 maps to 0 - 1 volts #define VOLTAGE_MAX 1.0 #define VOLTAGE_MAXCOUNTS 1023.0#endif/* ***************************************************************************************** **** Visit https://www.thingspeak.com to sign up for a free account and create **** a channel. The video tutorial http://community.thingspeak.com/tutorials/thingspeak-channels/ **** has more information. You need to change this to your channel, and your write API key **** IF YOU SHARE YOUR CODE WITH OTHERS, MAKE SURE YOU REMOVE YOUR WRITE API KEY!! *****************************************************************************************/unsigned long myChannelNumber = ***;const char * myWriteAPIKey = '***';void setup() {ThingSpeak.begin(client);}void loop() {\u00a0WiFi.begin(ssid, pass);delay(10000); // Waits 10 seconds to confirm connection// read the input on analog pin 0: int sensorValue = analogRead(A0); // Convert the analog reading // On Uno,Mega,YunArduino: 0 - 1023 maps to 0 - 5 volts // On ESP8266: 0 - 1023 maps to 0 - 1 volts // On MKR1000,Due: 0 - 4095 maps to 0 - 3.3 volts float voltage = ((sensorValue * (VOLTAGE_MAX / VOLTAGE_MAXCOUNTS)) - .5 )* 100;// Write to ThingSpeak. There are up to 8 fields in a channel, allowing you to store up to 8 different // pieces of information in a channel. Here, we write to field 1. ThingSpeak.writeField(myChannelNumber, 1, voltage, myWriteAPIKey); delay(20000); // ThingSpeak will only accept updates every 15 seconds.WiFi.disconnect();}\u00a0Everything works fine after uploading the sketch. But when I take the MKR 1000 away from my Mac an I make a restart with a mobile-charging-cable, only 2 updates are sent to Thingspeak. What is wrong???Thanks fpr helping me\u00a0Michael\u00a0", "num_user_post": " 5", "author": "beekeeper"}, {"date": "October 2, 2017 - 10:44 am", "content": "I am able to reproduce this behavior.\u00a0 I'm looking into it.", "num_user_post": " 34", "author": "JasonW"}, {"date": "October 2, 2017 - 1:05 pm", "content": "It looks like the latest version of the WiFi101 library has a bug in it.Until Arduino fixes the bug, a work-around is to downgrade the WiFi101 library to version 13.0.", "num_user_post": " 34", "author": "JasonW"}, {"date": "November 4, 2017 - 10:33 pm", "content": "Phew!\u00a0 I'm happy I wasn't completely incompetent or simply crazy.\u00a0 \ud83d\ude09", "num_user_post": " 6", "author": "wjpavalko"}]}, {"url": "https://community.thingspeak.com/forum/arduino/wrong-value-thingspeak/", "posts": [{"date": "August 3, 2017 - 5:33 am", "content": "I am sending sensor data from the LoRa module (Sodaq ONE) throughtout KPN network. I would like to be able to see this sensor data monitorised within 'ThingSpeak', but a '0' value is received constantly. I am not sure whether it happens because the payload is sent in HEX code rather than ASCII...? If so, how can I convert it?#include 'Arduino.h'#include &lt;Sodaq_RN2483.h&gt;#include 'DHT.h'#define DHTPIN 2 // Pin connect sensor#define DHTTYPE DHT11 // Define sensor we are usingDHT dht(DHTPIN,DHTTYPE); // Initialize the device#define debugSerial SERIAL_PORT_MONITOR#if defined(ARDUINO_AVR_SODAQ_MBILI)#define loraSerial Serial1#define BEE_VCC 20#elif defined(ARDUINO_SODAQ_AUTONOMO) || defined(ARDUINO_SODAQ_ONE) || defined(ARDUINO_SODAQ_ONE_BETA)#define loraSerial Serial1#elif defined(ARDUINO_SODAQ_EXPLORER)#define loraSerial Serial2#else// please select a sodaq boarddebugSerial.println('Please select a sodaq board!!');#endif// ABPconst uint8_t devAddr[4] = { };const uint8_t appSKey[16] = {  };const uint8_t nwkSKey[16] = {  };// OTAAuint8_t DevEUI[8] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };uint8_t AppEUI[8] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };uint8_t AppKey[16] = { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 };void setupLoRaABP(){    if (LoRaBee.initABP(loraSerial, devAddr, appSKey, nwkSKey, false))  {    debugSerial.println('Communication to LoRaBEE successful.');  }  else  {    debugSerial.println('Communication to LoRaBEE failed!');  }}void setupLoRaOTAA(){  if (LoRaBee.initOTA(loraSerial, DevEUI, AppEUI, AppKey, false))  {    debugSerial.println('Communication to LoRaBEE successful.');  }  else  {    debugSerial.println('OTAA Setup failed!');  }}void setup() {  //Power up the LoRaBEE  #if defined(ARDUINO_AVR_SODAQ_MBILI) || defined(ARDUINO_SODAQ_AUTONOMO)  pinMode(BEE_VCC, OUTPUT);  digitalWrite(BEE_VCC, HIGH);  #endif  delay(3000);  while ((!SerialUSB) &amp;&amp; (millis() &lt; 10000)){    // Wait 10 seconds for the Serial Monitor  }  //Set baud rate  debugSerial.begin(57600);  loraSerial.begin(LoRaBee.getDefaultBaudRate());  // Debug output from LoRaBee  // LoRaBee.setDiag(debugSerial); // optional  //connect to the LoRa Network  setupLoRa();}void setupLoRa(){  // ABP  setupLoRaABP();  // OTAA // setupLoRaOTAA();  LoRaBee.setSpreadingFactor(9);  dht.begin(); //start the device}void sendPacket(String packet){  switch (LoRaBee.send(1, (uint8_t*)packet.c_str(), packet.length()))    {    case NoError:      debugSerial.println('Successful transmission.');      break;    case NoResponse:      debugSerial.println('There was no response from the device.');      setupLoRa();      break;    case Timeout:      debugSerial.println('Connection timed-out. Check your serial connection to the device! Sleeping for 20sec.');      delay(20000);      break;    case PayloadSizeError:      debugSerial.println('The size of the payload is greater than allowed. Transmission failed!');      break;    case InternalError:      debugSerial.println('Oh No! This shouldn't happen. Something is really wrong! Try restarting the device!The network connection will reset.');      setupLoRa();      break;    case Busy:      debugSerial.println('The device is busy. Sleeping for 10 extra seconds.');      delay(10000);      break;    case NetworkFatalError:      debugSerial.println('There is a non-recoverable error with the network connection. You should re-connect.The network connection will reset.');      setupLoRa();      break;    case NotConnected:      debugSerial.println('The device is not connected to the network. Please connect to the network before attempting to send data.The network connection will reset.');      setupLoRa();      break;    case NoAcknowledgment:      debugSerial.println('There was no acknowledgment sent back!');      // When you this message you are probaly out of range of the network.      break;    default:      break;    }}void loop() {  //HumidityDHT1, TempDHT11   String packet  = String(dht.readHumidity())  + ', ';  packet += String(dht.readTemperature());  debugSerial.println(packet);  sendPacket(packet);  delay(5000);}\u00a0https://thingspeak.com/channels/266512Any suggestion,please?Many Thanks!\u00a0", "num_user_post": " 10", "author": "Tonibco6"}, {"date": "August 3, 2017 - 3:30 pm", "content": "ThingSpeak will accept Hex values as well as ASCII. \u00a0Depending on how they are formatted, it may interpret the hex values as strings. \u00a0For example, Cheerlights (channel 1417) contains the string from the color name and the hex code in separate fields. I couldn't find information about Lorabee.send() function in a quick google search so I don't know how it works. \u00a0I assume it must have the api key correct if you are getting posts to your channel, even if they are zero.\u00a0Perhaps you aren't sending valid field information ('field1=')? \u00a0See the documentation on Update a channel feed\u00a0to make sure your format is correct. \u00a0Also you should try using your browser or POSTMAN\u00a0to update your channel. \u00a0This will help you ensure the format is correct for the request. \u00a0You can use the format shown on the API keys page on the right:GET https://api.thingspeak.com/update?api_key=WRITE_API_KEY&field1=#xxxx  (dont use the GET if you paste it into your browser window)", "num_user_post": " 401", "author": "cstapels"}, {"date": "August 4, 2017 - 5:47 am", "content": "What do this 5 digits mean '#xxxx'\u00a0on the browser address?https://api.thingspeak.com/update?api_key=WRITE_API_KEY&field1=#xxxxSince I have got a '0' value on my Write keys, so maybe it is the reason it is sending constantly '0' values to my channel.https://api.thingspeak.com/update?api_key=WRITE_API_KEY&field1=0If I am sending Humidity and Temperature values to different fields but same channel from a DHT_11 sensor, how can I manage to send it properly?Field1 = Temperature\u00a0Field 2 = HmidityMany thanks!", "num_user_post": " 10", "author": "Tonibco6"}, {"date": "August 4, 2017 - 2:56 pm", "content": "See the documentation at Update a channel feed\u00a0I wrote 'field1=#xxx to show you could put Hex numbers in there.You can continue to append values on the end of the REST call:\u00a0https://api.thingspeak.com/update?api_key=WRITE_API_KEY&field1=11&field2=22 \u00a0 etc.", "num_user_post": " 401", "author": "cstapels"}, {"date": "August 8, 2017 - 9:43 am", "content": "Still '0' values as result. Well, I got some peaks as I added a random values to each field, but unfortunately then, it keeps coming down to '0'.This is what my LoRa provider (Sodaq) has messaged me;You are sending your data correctly to the LoRa gateway (as operated by KPN).They are forwarding your data on to the specified link you provide. It appears that they use POST and encode the data as JSON. However, this is not in the format that ThingSpeak requires.You will either have to request that KPN translates the data and forwards in on directly to ThingSpeak, in the correct format. Or setup a some system for doing that yourself. i.e. KPN forwards it in their format to your service, you then translate it and then forward it on to ThingSpeak.\u00a0Does not ThingSpeak allow JASON format, then?Thanks", "num_user_post": " 10", "author": "Tonibco6"}, {"date": "August 8, 2017 - 2:26 pm", "content": "Data for updating a field or a feed is not generally formatted as a JSON object when you use the REST API.You can use JSON format is certain situations, and ThingSpeak will optionally return some output in JSON. \u00a0One exception is for a bulk post, which you can provide as a JSON object as shown here. \u00a0For your application, I wouldn't necessarily suggest the use of a bulk post.What do you do to get 'some peaks'? \u00a0If you are still using the code above, I would suggest looking at the output of the function\u00a0(LoRaBee.send(1, (uint8_t*)packet.c_str(), packet.length()) and see how it packages your data. \u00a0Then see if that format matches the requirements listed in\u00a0Update a channel feed\u00a0. \u00a0Since you are getting data to post, but the values aren't going where you want, it must be a format issue. \u00a0", "num_user_post": " 401", "author": "cstapels"}, {"date": "August 11, 2017 - 5:26 am", "content": "The peaks made sense because they were coming from the GET request I made several times...however, I was not aware about it at that moment.So, I have been consulting with my LoRa provider and we believe that KPN is posting a JSON or XML to the destination URL. ThingSpeak is expecting a GET request.We believe the only way to solve this is to have a server in the middle what will handle to incoming data from KPN, decode the HEX data and create a GET for ThingSpeak with the correct payload.", "num_user_post": " 10", "author": "Tonibco6"}]}, {"url": "https://community.thingspeak.com/forum/arduino/limits-with-the-length-of-uri-when-using-ciao/", "posts": [{"date": "August 10, 2017 - 10:02 am", "content": "What limits apply to the length of 'uri' when using Ciao to send a URL to ThingSpeak (free account)?CiaoData data = Ciao.write(CONNECTOR, SERVER_ADDR, uri); // to send the URL to ThingSpeak?I am using a Arduino Uno with ESP8266 WiFi built in (not a WiFi Shield) to send Temperature/Humidity data from DHTxx sensors.My code works with 2 sensors (4 data fields) but fails with 3 sensors.#define CONNECTOR 'rest'#define SERVER_ADDR 'api.thingspeak.com'#define APIKEY_THINGSPEAK\u00a0\u00a0 'my key'\u00a0String uri = '/update?api_key='; uri += APIKEY_THINGSPEAK; uri += '&field1='; uri += String(h1); uri += '&field2='; uri += String(t1); uri += '&field3='; uri += String(h2); uri += '&field4='; uri += String(t2);CiaoData data = Ciao.write(CONNECTOR, SERVER_ADDR, uri);Would it better to useThingSpeak.writeField(myChannelNumber,1,t1, myWriteAPIKey);ThingSpeak.writeField(myChannelNumber,2,t2, myWriteAPIKey);etc", "num_user_post": " 12", "author": "mac"}]}, {"url": "https://community.thingspeak.com/forum/arduino/thingspeak-thingspeak-readintfield-on-arduino-with-esp8266-unstable/", "posts": [{"date": "August 7, 2016 - 11:50 am", "content": "hi all.\u00a0i try to read last values of 3 field set \u00a0of thhingspeak channel.like that:-after setting up client with these\u00a0libraries#include <WiFiEsp.h>#include <WiFiEspClient.h>#include <WiFiEspServer.h>#include <WiFiEspUdp.h> #include <ThingSpeak.h> ////<<<<<<<<<<<<<<etc.etc.\u00a0void loop() {int field1 = ThingSpeak.readIntField(141045,1);Serial.println(); delay(1000); Serial.print('field 1 is: '); Serial.print(field1);Serial.println();int field2 = ThingSpeak.readIntField(141045,2);Serial.println(); delay(10000); Serial.print('field 2 is: '); Serial.print(field2); Serial.println();int field3 = ThingSpeak.readIntField(141045,3);Serial.println(); delay(10000); Serial.print('field 3 is: '); Serial.println(field3); Serial.println();delay(10000); // Note that the weather station only updates once a minute;};\u00a0\u00a0PROBLEM:I set the data to be\u00a0\u00a0 600 , 600,600\u00a0i get unstable readings (of same line wihch i try to read for testing purposes over the loop),as follows \u00a0over the arduino \u00a0mega serial terminal\u00a0\u00a0field 1 is: 0[WiFiEsp] Connecting to api.thingspeak.com[WiFiEsp] TIMEOUT: 605[WiFiEsp] Disconnecting 0field 2 is: 0[WiFiEsp] Connecting to api.thingspeak.comfield 3 is: 600\u00a0[WiFiEsp] Connecting to api.thingspeak.comfield 1 is: 600[WiFiEsp] Connecting to api.thingspeak.com[WiFiEsp] TIMEOUT: 605[WiFiEsp] Disconnecting 0field 2 is: 0[WiFiEsp] Connecting to api.thingspeak.comfield 3 is: 600[WiFiEsp] Connecting to api.thingspeak.comfield 1 is: 600[WiFiEsp] Connecting to api.thingspeak.com[WiFiEsp] TIMEOUT: 607[WiFiEsp] Disconnecting 0field 2 is: 0[WiFiEsp] Connecting to api.thingspeak.comfield 3 is: 600[WiFiEsp] Connecting to api.thingspeak.comfield 1 is: 600[WiFiEsp] Connecting to api.thingspeak.com[WiFiEsp] TIMEOUT: 605[WiFiEsp] Disconnecting 0field 2 is: 0[WiFiEsp] Connecting to api.thingspeak.comfield 3 is: 600\u00a0\u00a0any body can explain \u00a0whats wrong here ?\u00a0is it low memory of arduino as one suggested \u00a0somewhere \u00a0?\u00a0wifi is strong , and all results come ok over http terminal .\u00a0thanks \u00a0Oded,", "num_user_post": " 3", "author": "oded"}, {"date": "July 30, 2017 - 5:46 am", "content": "Hi Oded !I also have some problems with Arduino Uno and WifiEsp and Thingspeak libraries.Did you solve your problem? Or any workaround.Thanks for help.Best regards.", "num_user_post": " 1", "author": "gkaplan"}]}, {"url": "https://community.thingspeak.com/forum/arduino/is-thingspeak-tracking-the-device-ip-address/", "posts": [{"date": "July 27, 2017 - 2:45 am", "content": "I created 3 thingspeak account for my project. 3Arduino was used to collect the data and the data collected was sent to arduino D. Each arduino was assigned to different thingspeak account. The program at arduino D will differentiate the data is from which arduino and then upload to the respective thingspeak account every 15second. However, i realized something strange. After arduino A upload to the respective thingspeak account, within the 15second interval that is limit by the free thingspeak account, no data is uploaded by arduino b and arduino c. Because i used the same arduino ( arduino D) to upload the data so i doubt that is thingspeak tracking the IP address of the device that used to upload to thingspeak and set a limit of 15second interval?\u00a0", "num_user_post": " 1", "author": "Angmo"}, {"date": "July 27, 2017 - 11:28 am", "content": "The situation that you are describing should work properly. Check to make sure that the Write API Key is unique for each device. You can also accomplish the same goal with one account and three channels.", "num_user_post": " 402", "author": "Hans"}, {"date": "July 28, 2017 - 7:32 pm", "content": "This is a common situation where code on the Arduino is writing each field individually, instead of setting each field and writing all fields in a single shot. Take a look at this example to see how to write multiple fields in a single shot:https://github.com/mathworks/thingspeak-arduino/blob/master/examples/WriteMultipleVoltages/WriteMultipleVoltages.ino", "num_user_post": " 225", "author": "Vinod"}]}, {"url": "https://community.thingspeak.com/forum/arduino/channel-update/", "posts": [{"date": "July 25, 2017 - 12:03 pm", "content": "Hi all, I'm new around here, and I am a free user (i.e. 15 secs. delay between updates)According to https://thingspeak.com/pages/license_faq,'A message is defined as a write of up to 8 fields of data to a ThingSpeak channel'However, using the following Arduino lines of codeThingSpeak.begin(ThingSpeakClient); ThingSpeak.writeField(myChannelNumber, 2, 0, myWriteAPIKey); ThingSpeak.writeField(myChannelNumber, 4, 0, myWriteAPIKey); ThingSpeakClient.stop();will only result in updating of field 2 only, and not field 4 as well.Adding a 15 secs. delay between line 2 and 3 in the code above (delay(15000);) will result in both fields being updated when I run the code.Could anyone shed some light into this matter please? Thank you.ThingSpeak.begin(ThingSpeakClient); ThingSpeak.setField(2, 0); ThingSpeak.setField(4, 0); ThingSpeak.writeFields(myChannelNumber, myWriteAPIKey); ThingSpeakClient.stop();\u00a0Later edit: Solved, thanks!", "num_user_post": " 1", "author": "Studvio"}]}, {"url": "https://community.thingspeak.com/forum/arduino/dragino-kpn-thingspeak/", "posts": [{"date": "July 6, 2017 - 6:33 am", "content": "Hi all,I am actually developing an IOT project based on LoRa module. To be specific, I am using Dragino device to send temperature-Humidity data from sensors.The point is that I am sensing this data to KPN provider, which is a Dutch Network, and finally my goal would be transfer this data from KPN to ThingSpeak platform to monitorise them.My question is, once I have got KPN ABP Keys as well as I have been testing that I am able to upload data to KPN, then Which API links should I use to match KPN Network with ThingSpeak platform. KPN Support did request me for a link in order \u00a0to send my data to ThingSpeak platform, but I have just sent them my public channel link and it didn't work.I have actually got a simple Arduino client/server Sketches which manage to connect my Dragino Module with ThingSpeak platform throughout a private Network (gateway). However, my actual target is send this data from KPN Network to ThingSpeak instead.Any help/suggestion, please?Many thanks", "num_user_post": " 10", "author": "Tonibco6"}, {"date": "July 18, 2017 - 4:33 am", "content": "I have finally managed to get the right code to send my dht_11 data to KPN network from LoRa (Dragino) node. However, my next step consists on transmit this data to ThingSpeak platform throughout KPN network.https://zakelijkforum.kpn.com/lora-forum-16/what-is-lora-and-lorawan-8314So, basically the target consists in sending this data from LoRa node to KPN network, and then, forward it to ThingSpeak. So that, I am actually adding into the sketch the chance to send this data to ThingSpeak, nevertheless, no data is showed on ThingSpeak dashboard. The link below is pointed to my new code. I added the functions and variables I thought were the proper ones, however, I didn't manage to send it. May I get some support or correction to achieve it, please?Sketch link: https://github.com/Tonibco/Dragino-KPN-Project/blob/master/Dragino_KPN.inoMany thanksToni", "num_user_post": " 10", "author": "Tonibco6"}, {"date": "July 18, 2017 - 9:28 am", "content": "Your call to\u00a0ThingSpeak.begin(); does not have a client. \u00a0See the examples in the Arduino IDE when you install the thingSpeak library. \u00a0For example the 'writeMultipleVoltages.ino'. \u00a0Generally the client that connects to the wifi or ethernet is passed to the ThingSpeak object.", "num_user_post": " 401", "author": "cstapels"}, {"date": "July 18, 2017 - 10:18 am", "content": "I am aware about it, so I deleted it, because it was providing me an error. So, I was wondering if the client parameter was coming from the client.ino. However, I am not using a client sketch to combine with the server, I meant, I am just using an entire code to send everything.\u00a0", "num_user_post": " 10", "author": "Tonibco6"}, {"date": "July 20, 2017 - 7:51 am", "content": "Once I enter 'client' on the function ThingSpeak.begin(client); I have got the following error:Sketch too big; see http://www.arduino.cc/en/Guide/Troubleshooting#size for tips on reducing it.Error compiling for board Arduino Uno - Dragino Y\u00fan.I am using Dragino board . I have even got same error adding Arduino Uno/Genuino Uno Board. So, I don't know what's my mistake.Here you are my entire code:https://github.com/Tonibco/Dragino-KPN-Project/blob/master/Dragino_KPN.inoMany thanks", "num_user_post": " 10", "author": "Tonibco6"}, {"date": "July 20, 2017 - 4:20 pm", "content": "Perhaps you can try removing some libraries. \u00a0You could temporarily remove the dht library and just send dummy data to thingspeak to prove the concept. \u00a0Then you could focus on reducing the size once that is working.Another thing I saw in one of the thingSpeak library examples for use with Yun was\u00a0Bridge.begin(); \u00a0before the ThingSpeak.begin(client). \u00a0and I see that the yun client is depreciated.", "num_user_post": " 401", "author": "cstapels"}, {"date": "July 24, 2017 - 9:30 am", "content": "Is ThingSpeak reading either 'int' or 'float' values? I have just contacted KPN and I provided them my Write Key link in order to send my sensor value data to my channel, but it seems that there is something wrong once they provide the data to ThingSpeak.I am sending format values as 25.00Would that value be Ok in order to show it on my channel graphic?\u00a0Thanks", "num_user_post": " 10", "author": "Tonibco6"}, {"date": "July 24, 2017 - 2:56 pm", "content": "ThingSpeak can handle both int and float, and even strings (but it wont plot the strings). \u00a0For example, the following two posts (copied from my api keys tab on my channel) both worked to display data on my channel plot. \u00a0See the update a channel feed page for more options.https://api.thingspeak.com/update?api_key=XXXXXXXXXXXXXXXX&field1=25https://api.thingspeak.com/update?api_key=XXXXXXXXXXXXXXXX&field1=25.0", "num_user_post": " 401", "author": "cstapels"}, {"date": "July 25, 2017 - 4:57 am", "content": "It seems that I managed to send 'something' to ThingSpeak dashboard throughout KPN network (not Gateway). However, it is only sending a '0' value... I removed the ThingSpeak(client) function as I am not using any client scketch. I have got a warning even when I comment dht library and sending just a static number: 'Low memory available, stability problems may occur.'\u00a0 Code: link\u00a0Any code modification suggested?(The code above is working properly when I send sensor data to KPN, I have just added some lines in order to transfer this data to ThingSpeak, which are the ones I would like to get some advise) \u00a0You can also see on the following link the steady temperature value '0' I have got into \u00a0my ThingSpeak channel:\u00a0linkMany thanks", "num_user_post": " 10", "author": "Tonibco6"}]}, {"url": "https://community.thingspeak.com/forum/arduino/cant-send-unsigned-long-values-from-arduino-to-thingspeak/", "posts": [{"date": "July 14, 2017 - 10:56 am", "content": "Hello guys,I am trying to send my liquid sensor data to ThingSpeak. But, my total liquid variable is unsigned long. The following error comes up in compiling:\u00a0no matching function for call to 'ThingSpeakClass::writeFields(long unsigned int&, int, long unsigned int&, const char*&)'What could be the reason for this?\u00a0Best RegardsRushan", "num_user_post": " 8", "author": "rushanarshad"}, {"date": "July 21, 2017 - 4:50 pm", "content": "Can you post the line where you use writeFields? \u00a0Possibly you are using the wrong number of arguments or one of the other variables is the wrong type.", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/arduino/arduino-uno-r3w5100lm35-temperature-not-display-in-thingspeak/", "posts": [{"date": "July 14, 2017 - 6:34 am", "content": "Dear All,I'm trying to use the W5100 Ethernet Shield with Arduino Uno R3 to send the temperature read from LM35 to Thingspeak.\u00a0Unfortunately, nothing happened\u00a0after an hour (interval is 5 minutes). I can't find any wrong in the code and I\u00a0don't know what went wrong. \u00a0I'm attaching the code as below:#include <SPI.h>#include <Ethernet.h>#include 'ThingSpeak.h'// W5100 Network Setupbyte W5100_MacAddress[] = {0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED};//Thingspeak Setupunsigned long Channel_Number = 302633; // Channel IDconst char * Write_API_Key = 'VAMPTX0YTHJ17WJ5'; // Write API Keyint Channel_Field = 1; // Field where Temperature data upload to// LM35 sensor input to analog#define LM35_Temp_Sensor A0EthernetClient client;float LM35_Temp_Value = 0; // Initial Temperature valueint Interval = 300; // Interval read the temperature every 5 minsvoid setup(){ // Serial connection Serial.begin(9600); // Disable SD Card SPI pinMode(4,OUTPUT); digitalWrite(4,HIGH); // Connect to local network and internet Ethernet.begin(W5100_MacAddress); Serial.println(); Serial.print('W5100 IP Address: '); Serial.println(Ethernet.localIP()); Serial.print('W5100 Subnet Mask: '); Serial.println(Ethernet.subnetMask()); Serial.print('W5100 Gateway: '); Serial.println(Ethernet.gatewayIP()); Serial.println();// Connect to Thingspeak server if (ThingSpeak.begin(client)) { Serial.println(); Serial.println('Connect to Thingspeak Server...'); Serial.println(); } else { Serial.println(); Serial.println('Failed to connect to Thingspeak Server!!!'); Serial.println(); }}void loop(){ LM35_Temp_Value = analogRead(LM35_Temp_Sensor)* 0.0048828125 * 100; Serial.print('Current temperature: '); Serial.print(LM35_Temp_Value); Serial.println('\u00b0C'); delay(100);// Write the temperature to Thingspeak Server if(ThingSpeak.writeField(Channel_Number, Channel_Field, LM35_Temp_Value, Write_API_Key)) { Serial.println(); Serial.println('Uploading data to Thingspeak Server...'); Serial.println(); } else { Serial.println(); Serial.println('Failed to upload data to Thingspeak Server!!!'); Serial.println(); }// The temperature will read every 5 mins for (int i=0; i <= Interval; i++) { delay(1000); // 1 second delay }}", "num_user_post": " 4", "author": "dtecres"}, {"date": "July 14, 2017 - 11:41 am", "content": "What response are you getting from the server?try\u00a0int response =thingSpeak.writeFireld(...;serial.println('Response from server '+ String(response));and see what the response says.", "num_user_post": " 401", "author": "cstapels"}, {"date": "July 14, 2017 - 10:03 pm", "content": "Hi Cstapels,I get the response as below:Response from server -302Thanks.\u00a0", "num_user_post": " 4", "author": "dtecres"}, {"date": "July 17, 2017 - 5:06 pm", "content": "302 is a redirection, I don't thing thingSpeak would provide that to you directly. \u00a0A wild guess is that your network is redirecting the request away from ThingSpeak. \u00a0Are you able to update the channel from a browser or GET using POSTMAN connected on the same network? \u00a0You can use the syntax below, which is shown here in the documentation.https://api.thingspeak.com/update?api_key=<your Write API KEY>&field1=1010\u00a0\u00a0Are you able to update the channel this way?", "num_user_post": " 401", "author": "cstapels"}, {"date": "July 18, 2017 - 9:50 am", "content": "Hi cstapels,I was able to update as method provided.", "num_user_post": " 4", "author": "dtecres"}, {"date": "July 21, 2017 - 3:33 am", "content": "Hi\u00a0cstapels,I've found the cause of the data not able to update to Thingspeak. This is due to model DNS is not set to open DNS, after set to open DNS it works fine now.However, it turned to not working back when I had added send email function when temperature over the threshold. I can't figure what went wrong and the response number returned after pushed the data to Thingspeak same as before added the send email function.\u00a0Please help...Thanks.Best Regards,Kinble Gray\u00a0#include <SPI.h>#include <Ethernet.h>#include <utility/w5100.h>#include 'ThingSpeak.h'// W5100 Network Setupbyte W5100_MacAddress[] = {0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED};const IPAddress No_Connet_IP = IPAddress(0, 0, 0, 0);//Thingspeak Setupunsigned long Channel_Number = 302633; // Channel IDconst char * Write_API_Key = 'VAMPTX0YTHJ17WJ5'; // Write API Keyint Channel_Field = 1; // Field where Temperature data upload to// LM35 sensor input to analog#define LM35_Temp_Sensor A0// SMTP2GO eMail Setupchar smtp_server[] = 'smtpcorp.com';int smtp_port = 2525;EthernetClient client;float LM35_Temp_Value = 0; // Initial Temperature valuefloat Preset_Temp_Value = 37.00; // Preset Temperatureint Interval = 300; // Interval read the temperature every 5 minsvoid setup(){ Serial.begin(9600); delay(200); while (!Serial) { delay(200); } Serial.println('Arduino Uno R3 was detected...'); // Disable SD Card SPI pinMode(4,OUTPUT); digitalWrite(4,HIGH); Ethernet.begin(W5100_MacAddress); byte MACvalue[6]; // Detecting W5100 Ethernet Shield present W5100.getMACAddress(MACvalue); for (byte i = 0; i < 6; i++) { if (MACvalue[i] != W5100_MacAddress[i]) { Serial.println(F('W5100 ethernet shield is not detected!!!')); while (true) { // Waiting user to restart the module... } } } Serial.println(); Serial.println(F('W5100 ethernet shield was detected...')); // Check the W5100 Ethernet Connection to DHCP server IPAddress W5100_IPAddress = Ethernet.localIP(); if (W5100_IPAddress[0] == No_Connet_IP[0] || W5100_IPAddress[1] == No_Connet_IP[1] || W5100_IPAddress[2] == No_Connet_IP[2] || W5100_IPAddress[3] == No_Connet_IP[3]) { Serial.println(F('W5100 failed to connect to DHCP server!!!')); while (true) { // Waiting user to restart the module... } } else { Serial.println(); Serial.println(F('W5100 is connect to DHCP server...')); Serial.println(); Serial.print('W5100 IP Address: '); Serial.println(Ethernet.localIP()); Serial.print('W5100 Subnet Mask: '); Serial.println(Ethernet.subnetMask()); Serial.print('W5100 Gateway: '); Serial.println(Ethernet.gatewayIP()); Serial.println(); }// Connect to Thingspeak server if (ThingSpeak.begin(client)) { Serial.println('Connect to Thingspeak Server!!!'); Serial.println(); } else { Serial.println('Failed to connect to Thingspeak Server!!!'); Serial.println(); }}void loop(){ LM35_Temp_Value = analogRead(LM35_Temp_Sensor)* 0.0048828125 * 100; Serial.print('Current temperature: '); Serial.print(LM35_Temp_Value); Serial.println('\u00b0C'); delay(100);// Write the temperature to Thingspeak Server int response = ThingSpeak.writeField(Channel_Number, Channel_Field, LM35_Temp_Value, Write_API_Key); Serial.println('Response from server: '+ String(response)); if(response >=0) { Serial.println(); Serial.println('Uploading data to Thingspeak Server...'); Serial.println(); } else { Serial.println(); Serial.println('Failed to upload data to Thingspeak Server!!!'); Serial.println(); } client.stop(); // Send alert email in temperature over the threshold if (LM35_Temp_Value >= Preset_Temp_Value) { Serial.println('Temperature over threshold!!!'); Serial.println('Sending over temperature alert email...'); delay(100); if(sendEmail()) { Serial.println(F('Over temperature alert email sent successfully...')); } else { Serial.println(F('Over temperature alert email sent failed!!!')); } } // The temperature will read every 5 mins for (int i=0; i <= Interval; i++) { delay(1000); // 1 second delay } }byte sendEmail(){ byte thisByte = 0; byte respCode; Serial.println(F('Connecting to SMTP Server...')); if(client.connect(smtp_server,smtp_port) == 1) { Serial.println(F('W5100 is connect to SMTP Server...')); } else { Serial.println(F('W5100 failed to connect to SMTP Server!!!')); return 0; } if(!eRcv()) return 0; Serial.println(F('Sending hello...')); // Replace 1.2.3.4 with your Arduino's ip //client.println('EHLO 1.2.3.4'); client.println('EHLO W5100_IPAddress'); if(!eRcv()) return 0; Serial.println(F('Sending auth login...')); client.println('auth login'); if(!eRcv()) return 0; Serial.println(F('Sending UserID...'));// Change to your base64 encoded user client.println('User ID'); if(!eRcv()) return 0; Serial.println(F('Sending Password...'));// change to your base64 encoded password client.println('Password'); if(!eRcv()) return 0;// change to your email address (sender) Serial.println(F('Sending From...')); client.println('MAIL From: <ektan@unigen.com>'); if(!eRcv()) return 0;// change to recipient address Serial.println(F('Sending To...')); client.println('RCPT To: <ektan@unigen.com>'); if(!eRcv()) return 0; Serial.println(F('Sending DATA...')); client.println('DATA'); if(!eRcv()) return 0; Serial.println(F('Sending email...'));// change to recipient address client.println('To: EK Tan <ektan@unigen.com>');// change to your address client.println('From: Eekhay Tan <ektan@unigen.com>'); client.println('Subject: Over Temperature Email Alert!!!'); client.print('Temperature: '); client.print(LM35_Temp_Value); client.println('\u00b0C'); client.println('Current temperature is over the threshold!!!'); client.println('Please take immediate action now!!!'); client.println('.'); if(!eRcv()) return 0; Serial.println(F('Sending QUIT...')); client.println('QUIT'); if(!eRcv()) return 0; client.stop(); Serial.println(F('SMTP Server is disconnected...')); return 1;}byte eRcv(){ byte respCode; byte thisByte; int loopCount = 0; while(!client.available()) { delay(1); loopCount++; // if nothing received for 10 seconds, timeout if(loopCount > 10000) { client.stop(); Serial.println(F(' eRcv Timeout!!!')); return 0; } } respCode = client.peek(); while(client.available()) { thisByte = client.read(); Serial.write(thisByte); } if(respCode >= '4') { efail(); return 0; } return 1;}void efail(){ byte thisByte = 0; int loopCount = 0; client.println(F('QUIT')); while(!client.available()) { delay(1); loopCount++; // if nothing received for 10 seconds, timeout if(loopCount > 10000) { client.stop(); Serial.println(F(' eFail Timeout!!!')); return; } } while(client.available()) { thisByte = client.read(); Serial.write(thisByte); } client.stop(); Serial.println(F('SMTP Server is disconnected...'));}", "num_user_post": " 4", "author": "dtecres"}, {"date": "July 21, 2017 - 4:39 pm", "content": "Consider using ThingTweet and a react to generate a tweet when your channel value reaches a particular value.", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/arduino/ardunio-mega-wifi101-shield-only-sends-two-readings/", "posts": [{"date": "July 18, 2017 - 3:09 pm", "content": "Hey guys,I'm only getting two sensor readings per channel then it seems ThingSpeak stops responding. Any ideas why this may be? \u00a0I'm using a Arduino Mega with a Wifi101 shield, along with the example WriteVoltatge code from the ThingSpeak library. \u00a0Code:\u00a0/* WriteVoltageReads an analog voltage from pin 0, and writes it to a channel on ThingSpeak every 20 seconds.ThingSpeak ( https://www.thingspeak.com ) is an analytic IoT platform service that allows you to aggregate, visualize and analyze live data streams in the cloud.Copyright 2016, The MathWorks, Inc.Documentation for the ThingSpeak Communication Library for Arduino is in the extras/documentation folder where the library was installed. See the accompaning licence file for licensing information. */#include 'ThingSpeak.h'// *********************************************************************************************************** // This example selects the correct library to use based on the board selected under the Tools menu in the IDE. // Yun, Ethernet shield, WiFi101 shield, esp8266, and MXR1000 are all supported. // With Yun, the default is that you're using the Ethernet connection. // If you're using a wi-fi 101 or ethernet shield (http://www.arduino.cc/en/Main/ArduinoWiFiShield), uncomment the corresponding line below // ***********************************************************************************************************#define USE_WIFI101_SHIELD //#define USE_ETHERNET_SHIELD#if defined(ARDUINO_AVR_YUN) #include 'YunClient.h' YunClient client; #else #if defined(USE_WIFI101_SHIELD) || defined(ARDUINO_SAMD_MKR1000) || defined(ARDUINO_ARCH_ESP8266) // Use WiFi #ifdef ARDUINO_ARCH_ESP8266 #include #else #include #include #endif char ssid[] = '*******'; // your network SSID (name) char pass[] = '*******'; // your network password int status = WL_IDLE_STATUS; WiFiClient client; #elif defined(USE_ETHERNET_SHIELD) // Use wired ethernet shield #include #include byte mac[] = { 0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED}; EthernetClient client; #endif #endif#ifdef ARDUINO_ARCH_AVR // On Arduino: 0 - 1023 maps to 0 - 5 volts #define VOLTAGE_MAX 5.0 #define VOLTAGE_MAXCOUNTS 1023.0 #elif ARDUINO_SAMD_MKR1000 // On MKR1000: 0 - 1023 maps to 0 - 3.3 volts #define VOLTAGE_MAX 3.3 #define VOLTAGE_MAXCOUNTS 1023.0 #elif ARDUINO_SAM_DUE // On Due: 0 - 1023 maps to 0 - 3.3 volts #define VOLTAGE_MAX 3.3 #define VOLTAGE_MAXCOUNTS 1023.0 #elif ARDUINO_ARCH_ESP8266 // On ESP8266: 0 - 1023 maps to 0 - 1 volts #define VOLTAGE_MAX 1.0 #define VOLTAGE_MAXCOUNTS 1023.0 #endif/* ***************************************************************************************** **** Visit https://www.thingspeak.com to sign up for a free account and create **** a channel. The video tutorial http://community.thingspeak.com/tutorials/thingspeak-channels/ **** has more information. You need to change this to your channel, and your write API key **** IF YOU SHARE YOUR CODE WITH OTHERS, MAKE SURE YOU REMOVE YOUR WRITE API KEY!! *****************************************************************************************/ unsigned long myChannelNumber = 298095; const char * myWriteAPIKey = '*******';void setup() {#ifdef ARDUINO_AVR_YUN Bridge.begin(); #else #if defined(ARDUINO_ARCH_ESP8266) || defined(USE_WIFI101_SHIELD) || defined(ARDUINO_SAMD_MKR1000) WiFi.begin(ssid, pass); #else Ethernet.begin(mac); #endif #endifThingSpeak.begin(client); }void loop() { // read the input on analog pin 0: int sensorValue = analogRead(A0); // Convert the analog reading // On Uno,Mega,YunArduino: 0 - 1023 maps to 0 - 5 volts // On ESP8266: 0 - 1023 maps to 0 - 1 volts // On MKR1000,Due: 0 - 4095 maps to 0 - 3.3 volts float voltage = sensorValue * (VOLTAGE_MAX / VOLTAGE_MAXCOUNTS);// Write to ThingSpeak. There are up to 8 fields in a channel, allowing you to store up to 8 different // pieces of information in a channel. Here, we write to field 1. ThingSpeak.writeField(myChannelNumber, 7, voltage, myWriteAPIKey); delay(20000); // ThingSpeak will only accept updates every 15 seconds. }", "num_user_post": " 2", "author": "iolson"}]}]}