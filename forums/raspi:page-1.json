{"url": "https://community.thingspeak.com/forum/raspi/page-1/", "threads": [{"url": "https://community.thingspeak.com/forum/raspi/send-data-to-the-channel-asynchronously-as-bulk/", "posts": [{"date": "August 23, 2018 - 7:12 am", "content": "Hi all,I'm pretty new to this Topic but I have searched the Forum and the web but have not yet found a solution.I am a hobby wine maker and just recently upgraded my production room with a temperature and humidity control System, using a raspberry pi and a DHT22. The data get's uploaded with the following code (slightly altered, as this is taken from a tutorial) to ThingSpeak:________________________________________________________________________________________________________________import thingspeakimport timeimport Adafruit_DHTchannel_id = 206897 # PUT CHANNEL ID HEREwrite_key  = '24GJQV17H7H4XGJ5' # PUT YOUR WRITE KEY HEREread_key   = '9EZ7E0918UVVAGAY' # PUT YOUR READ KEY HEREpin = 4sensor = Adafruit_DHT.DHT22def measure(channel):    try:        humidity, temperature = Adafruit_DHT.read_retry(sensor, pin)        # write        response = channel.update({'field1': temperature, 'field2': humidity})        # read        read = channel.get({})        print('Read:', read)    except:        print('connection failed')if __name__ == '__main__':    channel = thingspeak.Channel(id=channel_id, write_key=write_key, api_key=read_key)    while True:        measure(channel)        # free account has an api limit of 15sec        time.sleep(15)________________________________________________________________________________________________________________The transmission itself and displaying of the data works without any complications.Unfortunately, the router has some major issues and shuts down more or less every day. I will tackle that problem as well but for the moment I'd like to create a workaround. Hence the question: is it possible to locally log the data (in a round robin data base for instance) as soon as the wifi shuts down AND transmit all the logged data as a bulk to ThingSpeak as soon as the connection is up again?  This would help me to consistently monitor and analyze the necesseary information for the fermentation process online.If I just missed the right tutorial to do just that, a link might suffice to solve my problem. I'm eager to read and learn to solve my problems on my own but as of yet, I don't see a starting point.Thank you in advance.Cheers,Larimow", "num_user_post": " 1", "author": "larimow"}, {"date": "August 30, 2018 - 10:28 am", "content": "I think I have the tutorial you ordered:https://www.mathworks.com/help/thingspeak/continuously-collect-data-and-bulk-update-a-thingspeak-channel-using-a-raspberry-pi-board.htmlPlease let us know how it works, and when there are open tastings!", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/raspi/plot-two-data-into-the-same-graph-field-raspberry-pi/", "posts": [{"date": "August 19, 2018 - 5:06 am", "content": "I connected a sensor to capture (volt and current across a component) to a raspberry pi, and I wanna plot an IV curve.in my code, I'm running a sweep to capture those data, my code works just fine and I can plot the IV curve on my GUI by using matplotlib.In addition to my project, I wanna display/plot the IV curve online. Then I thought of using Thingspeak for this matter, but I noticed that it can only plots one data against time/date.Is there anyway that I can plot two data on one graph and neglect the time?Note that the data I'm sending to my Thingspeak channel are two variables i and v which each one has 14 values.screenshots:- data exported from Thingspeak- commands used in python", "num_user_post": " 1", "author": "Nano"}, {"date": "August 21, 2018 - 8:36 am", "content": "Here is a two axis plot example without time on the independant axis: https://www.mathworks.com/help/thingspeak/Visualize-Correlation-Between-Temperature-and-Humidity.htmlYou can also use the MATLAB plot() or scatter() functions, they have different options.Your data format is not in the standard arrangement - do you intend each entry to be a new IV sweep?You can read the datadataTable=thingSpeakRead(CHID,'outputformat','timeTable','readkey','xxxxxxxxxxxxxxxx'...)then use str2num and char to get the values.vectorX=str2num(char(dataTable.Field1Label));Repeat for both field 1 and 2.Then you can plot() or thingSpeakScatter(vectorX,vectorY, etc.)Let us know if that works.", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/raspi/multiple-dht22s-over-3-channels-and-a-rpi/", "posts": [{"date": "March 14, 2018 - 3:49 am", "content": "Hi guysI have built a circuit with 5 DHT22s there data pins are connected to IO 21 20 16 26 12 respectively and power directly from the psu.A total of 10 fields 2 each (Temp and humidity) with a max of 8 fields per channel I had to split the channelsunfortunately I have very little coding skills - using the below code I managed to get one sensor to work correctly.(https://www.hackster.io/adamgarbo/raspberry-pi-2-iot-thingspeak-dht22-sensor-b208f4)\u00a0<span class='hljs-string'>''' </span><span class='hljs-string'>dht22.py </span><span class='hljs-string'>Temperature/Humidity monitor using Raspberry Pi and DHT22. </span><span class='hljs-string'>Data is displayed at thingspeak.com</span><span class='hljs-string'>Original author: Mahesh Venkitachalam at electronut.in </span><span class='hljs-string'>Modified by Adam Garbo on December 1, 2016 </span><span class='hljs-string'>'''</span> <span class='hljs-keyword'>import</span> sys <span class='hljs-keyword'>import</span> RPi.GPIO <span class='hljs-keyword'>as</span> GPIO <span class='hljs-keyword'>from</span> time <span class='hljs-keyword'>import</span> sleep <span class='hljs-keyword'>import</span> Adafruit_DHT <span class='hljs-keyword'>import</span> urllib2 myAPI = <span class='hljs-string'>'&lt;your API code here&gt;'</span> <span class='hljs-function'><span class='hljs-keyword'>def</span> <span class='hljs-title'>getSensorData</span><span class='hljs-params'>()</span>:</span>    RH, T = Adafruit_DHT.read_retry(Adafruit_DHT.DHT22, <span class='hljs-number'>21</span>)    <span class='hljs-keyword'>return</span> (str(RH), str(T)) <span class='hljs-function'><span class='hljs-keyword'>def</span> <span class='hljs-title'>main</span><span class='hljs-params'>()</span>:</span>    <span class='hljs-keyword'>print</span> <span class='hljs-string'>'starting...'</span>    baseURL = <span class='hljs-string'>'https://api.thingspeak.com/update?api_key=%s'</span> % myAPI    <span class='hljs-keyword'>while</span> <span class='hljs-keyword'>True</span>:        <span class='hljs-keyword'>try</span>:            RH, T = getSensorData()            f = urllib2.urlopen(baseURL +                                <span class='hljs-string'>'&amp;field1=%s&amp;field2=%s'</span> % (RH, T))            <span class='hljs-keyword'>print</span> f.read()            f.close()            sleep(<span class='hljs-number'>300</span>) <span class='hljs-comment'>#uploads DHT22 sensor values every 5 minutes </span>       <span class='hljs-keyword'>except</span>:            <span class='hljs-keyword'>print</span> <span class='hljs-string'>'exiting.'</span>            <span class='hljs-keyword'>break</span> <span class='hljs-comment'># call main </span><span class='hljs-keyword'>if</span> __name__ == <span class='hljs-string'>'__main__'</span>:    main()  \u00a0I have no idea how to get it more readings to send, and also the fact that I need to send to more than one channel might be tricky..Any help appreciated, thanks!", "num_user_post": " 2", "author": "thingspeak4matt"}, {"date": "March 15, 2018 - 3:57 pm", "content": "''' baseURL = 'https://api.thingspeak.com/update?api_key=%s'dht22.pyTemperature/Humidity monitor using Raspberry Pi and DHT22.Data is displayed at thingspeak.comOriginal author: Mahesh Venkitachalam at electronut.inModified by Adam Garbo on December 1, 2016'''import sysimport RPi.GPIO as GPIOfrom time import sleepimport Adafruit_DHTimport urllib2count = 0myAPI = 'JDYURK8TAGWRZL29'def getSensorData21():\u00a0 RH, T = Adafruit_DHT.read_retry(Adafruit_DHT.DHT22, 21)\u00a0 return (str(RH), str(T))def getSensorData16():\u00a0 RH, T = Adafruit_DHT.read_retry(Adafruit_DHT.DHT22, 16)\u00a0 return (str(RH), str(T))def getSensorData26():\u00a0 RH, T = Adafruit_DHT.read_retry(Adafruit_DHT.DHT22, 26)\u00a0 return (str(RH), str(T))def getSensorData12():\u00a0 RH, T = Adafruit_DHT.read_retry(Adafruit_DHT.DHT22, 12)\u00a0 return (str(RH), str(T))def getSensorData20():\u00a0 RH, T = Adafruit_DHT.read_retry(Adafruit_DHT.DHT22, 20)\u00a0 return (str(RH), str(T)) print 'starting...'baseURL = 'https://api.thingspeak.com/update?api_key=%s' % 'JDY####'RH, T = getSensorData21()f = urllib2.urlopen(baseURL +\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 '&field1=%s&field2=%s' % (RH, T))print f.read()f.close()baseURL = 'https://api.thingspeak.com/update?api_key=%s' % 'CYJ####'RH, T = getSensorData16()f = urllib2.urlopen(baseURL +\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0'&field1=%s&field2=%s' % (RH, T))print f.read()f.close()baseURL = 'https://api.thingspeak.com/update?api_key=%s' % 'CYJ####'RH, T = getSensorData26()f = urllib2.urlopen(baseURL +\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 '&field3=%s&field4=%s' % (RH, T))print f.read()f.close()baseURL = 'https://api.thingspeak.com/update?api_key=%s' % 'I9Q####'RH, T = getSensorData12()f = urllib2.urlopen(baseURL +\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0'&field1=%s&field2=%s' % (RH, T))print f.read()f.close()baseURL = 'https://api.thingspeak.com/update?api_key=%s' % 'I9Q####'RH, T = getSensorData20()f = urllib2.urlopen(baseURL +\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0'&field3=%s&field4=%s' % (RH, T))print f.read()f.close()print 'end'sleep(30) #uploads DHT22 sensor values every 5 minutes\u00a0I have had some luck with the above code above, but the channel fields 3 and 4 of the second sensor do not upload \ud83d\ude41", "num_user_post": " 2", "author": "thingspeak4matt"}]}, {"url": "https://community.thingspeak.com/forum/raspi/publish-multiple-values-to-thingspeak-using-mqtt-1/", "posts": [{"date": "March 8, 2018 - 2:37 pm", "content": "I am trying to publish a multiple random data using mqtt to send data from raspberry pi to thingspeaks.i want to publish the 10 values of temp to thingspeaks field but it limits me to one value every 15 seconds. so is there anyway to send a list of values every 15 second to graph it with time in thingspeaks channels??\u00a0<span class='pln'>temp </span><span class='pun'>=</span> <span class='pun'>[]</span><span class='pln'>current </span><span class='pun'>=</span> <span class='pun'>[]</span><span class='kwd'>while</span><span class='pun'>(</span><span class='lit'>1</span><span class='pun'>):</span>   <span class='com'># get the system performance data over 20 seconds.</span>   <span class='kwd'>for</span><span class='pln'> i </span><span class='kwd'>in</span><span class='pln'> range</span><span class='pun'>(</span><span class='lit'>10</span><span class='pun'>):</span><span class='pln'>       temp</span><span class='pun'>.</span><span class='pln'>append</span><span class='pun'>(</span><span class='pln'>random</span><span class='pun'>.</span><span class='pln'>randint</span><span class='pun'>(</span><span class='lit'>0</span><span class='pun'>,</span> <span class='lit'>100</span><span class='pun'>))</span><span class='pln'>       current</span><span class='pun'>.</span><span class='pln'>append</span><span class='pun'>(</span><span class='pln'>random</span><span class='pun'>.</span><span class='pln'>randint</span><span class='pun'>(</span><span class='lit'>0</span><span class='pun'>,</span> <span class='lit'>100</span><span class='pun'>))</span>   <span class='com'># build the payload string.</span><span class='pln'>     payload </span><span class='pun'>=</span> <span class='str'>'field1='</span> <span class='pun'>+</span><span class='pln'> str</span><span class='pun'>(</span><span class='pln'>temp</span><span class='pun'>)</span> <span class='pun'>+</span> <span class='str'>'&amp;field2='</span> <span class='pun'>+</span><span class='pln'> str</span><span class='pun'>(</span><span class='pln'>current</span><span class='pun'>)</span>     <span class='com'># attempt to publish this data to the topic.</span>     <span class='kwd'>try</span><span class='pun'>:</span><span class='pln'>         publish</span><span class='pun'>.</span><span class='pln'>single</span><span class='pun'>(</span><span class='pln'>topic</span><span class='pun'>,</span><span class='pln'> payload</span><span class='pun'>,</span><span class='pln'> hostname</span><span class='pun'>=</span><span class='pln'>mqttHost</span><span class='pun'>,</span><span class='pln'> transport</span><span class='pun'>=</span><span class='pln'>tTransport</span><span class='pun'>,</span><span class='pln'> port</span><span class='pun'>=</span><span class='pln'>tPort</span><span class='pun'>,</span><span class='pln'>auth</span><span class='pun'>={</span><span class='str'>'username'</span><span class='pun'>:</span><span class='pln'>mqttUsername</span><span class='pun'>,</span><span class='str'>'password'</span><span class='pun'>:</span><span class='pln'>mqttAPIKey</span><span class='pun'>})</span>         <span class='kwd'>print</span> <span class='pun'>(</span><span class='str'>' Published temp ='</span><span class='pun'>,</span><span class='pln'>temp</span><span class='pun'>,</span><span class='str'>' current ='</span><span class='pun'>,</span><span class='pln'> current</span><span class='pun'>,</span><span class='str'>' to host: '</span> <span class='pun'>,</span><span class='pln'> mqttHost </span><span class='pun'>,</span> <span class='str'>' clientID= '</span> <span class='pun'>,</span><span class='pln'> clientID</span><span class='pun'>)</span>     <span class='kwd'>except</span> <span class='pun'>(</span><span class='typ'>KeyboardInterrupt</span><span class='pun'>):</span>         <span class='kwd'>break</span>     <span class='kwd'>except</span><span class='pun'>:</span>         <span class='kwd'>print</span> <span class='pun'>(</span><span class='str'>'There was an error while publishing the data.'</span><span class='pun'>)</span><span class='pln'>     time</span><span class='pun'>.</span><span class='pln'>sleep</span><span class='pun'>(</span><span class='lit'>15</span><span class='pun'>)</span>", "num_user_post": " 2", "author": "digimation"}]}, {"url": "https://community.thingspeak.com/forum/raspi/thingspeak-on-raspberry-pi-3/", "posts": [{"date": "October 28, 2017 - 8:04 pm", "content": "Hello,\u00a0im try to install the ThingSpeak on a Raspberry Pi3 without success. Did someone try to install it on Raspberry Pi3. The installation instruction at the web are only for Version 1 and 2. They didn't work on Raspberry Pi3.\u00a0Thanks", "num_user_post": " 2", "author": "Gerdi_666"}, {"date": "October 30, 2017 - 8:32 am", "content": "Can you describe what you are trying to do with your Pi3?\u00a0 Are you trying to read or post data with ThingSpeak?\u00a0 Are you trying to use MQTT?\u00a0 What language are you coding in?\u00a0\u00a0", "num_user_post": " 401", "author": "cstapels"}, {"date": "October 30, 2017 - 9:32 am", "content": "I installed ThingSpeak to a Pi 3 in June 2016 without any real issues. It\u2019s been running continuously since then. Have you tried this install procedure?https://www.teracomsystems.com/blog/how-to-install-local-thingspeak-server/", "num_user_post": " 4", "author": "jpsabo"}, {"date": "October 30, 2017 - 5:10 pm", "content": "Yes I dried it already. I used the newest Version from Raspberry:\u00a0Raspbian Stretch with desktopImage with desktop based on Debian StretchVersion: September 2017Release date: 2017-09-07Kernel version: 4.9\u00a0Here I had problems to install Ruby Version 2.1.4 so I used 2.4.1. \u00a0After the comand ' rails server webrick ' the server started but when I tried to connect local to it, it crashed.Which Image for Raspi should I use? I think the new Version is the problem", "num_user_post": " 2", "author": "Gerdi_666"}, {"date": "November 5, 2017 - 9:18 pm", "content": "I used\u00a0Raspbian Jessie 4.4, 2016-05-27 with Ruby 2.1.5.\u00a0", "num_user_post": " 4", "author": "jpsabo"}, {"date": "February 6, 2018 - 2:10 pm", "content": "jpsabo said  I used\u00a0Raspbian Jessie 4.4, 2016-05-27 with Ruby 2.1.5.\u00a0\u00a0\u00a0I\u00b4ve used the same but after the comand 'sudo gem install rails' responses : ERROR 'Unable to require OPENSSL'OPENSSL 1.0.1k is installed, I have no idea what happens.", "num_user_post": " 3", "author": "alcapar"}, {"date": "March 5, 2018 - 3:40 pm", "content": "Look at their install instructions:Installation on clean install of Ubuntu 12.04 LTSYou would immediately notice that these guys are a bunch of rookies.All you would get from them is a permanent headache.Just stay away and let others know.", "num_user_post": " 27", "author": "heh"}]}, {"url": "https://community.thingspeak.com/forum/raspi/ldr-values-not-being-updated-to-thingspeak-channel/", "posts": [{"date": "November 30, 2017 - 3:19 pm", "content": "I have run the following program to read LDR values from the LDR connected to my Raspberry Pi 3 and send the data to my Thingspeak channel but no update is being made to the channel. I am using Python 2.7 on Raspbian.\u00a0#!/usr/local/bin/python#!/usr/local/bin/pythonimport sysimport RPi.GPIO as GPIOfrom time import sleep\u00a0import urllib2myAPI= 'Y1087HT5ECTD8U6P'GPIO.setmode(GPIO.BOARD)pin_to_circuit=7def rc_time (pin_to_circuit):\u00a0 \u00a0count=0\u00a0 \u00a0GPIO.setup(pin_to_circuit, GPIO.OUT)\u00a0 \u00a0GPIO.output(pin_to_circuit, GPIO.LOW)\u00a0 \u00a0time.sleep(0.1)GPIO.setup(pin_to_circuit, GPIO.IN)\u00a0\u00a0\u00a0 \u00a0while(GPIO.input(pin_to_circuit) == GPIO.LOW):\u00a0 \u00a0 \u00a0 \u00a0 \u00a0count +=1\u00a0 \u00a0return counttry:\u00a0 \u00a0while True:\u00a0 \u00a0 \u00a0 \u00a0print rc_time(pin_to_circuit)except KeyboardInterrupt:\u00a0 \u00a0 \u00a0passfinally:\u00a0 \u00a0 \u00a0GPIO.cleanup()def main():\u00a0 \u00a0print 'starting...'\u00a0 \u00a0baseURL= 'https://api.thingspeak.com/update?api_key=%s' % myAPI\u00a0 \u00a0while True:try:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0ldrData= rc_time(pin_to_circuit) \u00a0 \u00a0f=urllib2.urlopen(baseURL + '&field1=%s' %(ldrData))\u00a0 \u00a0 \u00a0 \u00a0print f.read()\u00a0 \u00a0 \u00a0 \u00a0f.close()\u00a0 \u00a0 \u00a0 \u00a0sleep(15)except: \u00a0 \u00a0print 'exiting.' \u00a0 \u00a0break#call mainif _name_=='__main__':\u00a0 main()", "num_user_post": " 1", "author": "tia"}]}, {"url": "https://community.thingspeak.com/forum/raspi/python-error-after-several-successful-writes-to-thingspeak-channel/", "posts": [{"date": "April 30, 2016 - 9:46 pm", "content": "After several successful writes to my thingspeak channel, an error will occurlog = log + 'Failed to reach server. Reason: ' + e.reasonTypeerror: cannot concatenate 'str' and SSLError'objectsI am using raspberry pi's and an odroid w. I receive the error when sending data individually to a channel and when sending to one channel from each pi and the ordroid w. I don't know how to resolve this error or the cause.I have 1 raspberry pi that has been sending weather data and cpu temperature to a channel with no errors. When I used another python program to send CPU temperature separately to another channel the error occurs after several successful attempts.import osimport timeimport urllib # thinkspeakimport urllib2import sys # thinkspeak# --------- User Settings ---------PI_NAME = 'wx Pi'MINUTES_BETWEEN_READS = 15THINGSPEAKKEY = 'MYKEY'THINGSPEAKURL = 'https://api.thingspeak.com/update'# ---------------------------------def sendData(url,key,field7,odroid): ''' Send event to internet site '''values = {'key' : key,'field7' : odroid}postdata = urllib.urlencode(values) req = urllib2.Request(url, postdata)log = time.strftime('%m-%d-%Y,%H:%M:%S') + ', ' log = log + '{:.2f}F'.format(odroid) + ', 'try: # Send data to Thingspeak response = urllib2.urlopen(req, None, 1) html_string = response.read() response.close() log = log + 'Update ' + html_stringexcept urllib2.HTTPError, e: log = log + 'Server could not fulfill the request. Error code: ' + e.code except urllib2.URLError, e: log = log + 'Failed to reach server. Reason: ' + e.reason except: log = log + 'Unknown error'print logdef getCPUtemperature(): res = os.popen('vcgencmd measure_temp').readline() return(res.replace('temp=','').replace(''C',''))def main(): while True: cpuTemp = int(float(getCPUtemperature())) cpuTemp_f = cpuTemp * 9.0 / 5.0 +32 cpuTemp_f = float('{0:.2f}'.format(cpuTemp_f)) curTime = time.strftime('%m-%d-%Y,%H:%M:%S')# Print and stream print PI_NAME + ' CPU Temp(F): ' + str(cpuTemp_f) print PI_NAME + ' current Time: ' + str(curTime) sendData(THINGSPEAKURL,THINGSPEAKKEY,'field7',cpuTemp_f) sys.stdout.flush()time.sleep(60*MINUTES_BETWEEN_READS)if __name__ == '__main__': main()Thank you Perry", "num_user_post": " 2", "author": "perry"}, {"date": "May 1, 2016 - 10:04 pm", "content": "Can you get a stacktrace for the error?\u00a0eithera) comment out the 'except urllib2.URLError' section and run it manuallyorb) include stacktrace in your error log see https://docs.python.org/2/library/traceback.html\u00a0That might give you more information on the failure.\u00a0It may be that this is a temporary network error or time-out and that you have to have your program wait and re-try.", "num_user_post": " 271", "author": "rw950431"}, {"date": "May 4, 2016 - 2:22 am", "content": "Thank you. I will try a trace back. How would I make the program wait and re-try.?", "num_user_post": " 2", "author": "perry"}, {"date": "October 6, 2017 - 2:57 am", "content": "Try...exception handling", "num_user_post": " 1", "author": "walshmagger"}]}, {"url": "https://community.thingspeak.com/forum/raspi/thingspeak-read-matlab/", "posts": [{"date": "September 25, 2017 - 3:44 pm", "content": "Hello guys,i want to create a simple example of an Internet Of Things application with Matlab/Simulink.Is there an easy possibility to read data from ThingSpeak in Simulink? Like the ThingspeakWrite block in Simulink?I know that it can be done with C/Python but in my case it should be really easy (like connecting blocks in Simulink and write parameters in the block) and it should be done in Simulink!Maybe some of you allready have a solution for this.Btw why is there a ThingSpeak Read block for Arduiono and not for Raspberry Pi?Thank you guys!", "num_user_post": " 1", "author": "fm7385"}]}, {"url": "https://community.thingspeak.com/forum/raspi/uploading-data-from-rpi-sensehat-to-thingspeak-via-python-script/", "posts": [{"date": "June 21, 2017 - 1:14 pm", "content": "Dear fellow coders, i'm trying to upload temperature data from my RPi sensehat -> Thingspeak channel. I copied the scripts from the internet and tried to integrate them together.\u00a0I executed the Python script\u00a0on Putty terminal, the printed\u00a0temperature looks ok, hovering between 29-30 degrees C but when displayed on thingspeak, it shows up as werid numbers like 4 or 6 degrees C.Greatly appreciate your advice! Thank you!\u00a0#!/usr/bin/env python\u3000import httplib, urllibimport timesleep = 3key = '...'\u3000def thermometer():\u3000from sense_hat import SenseHat\u3000sense = SenseHat()sense.clear()\u3000 tmax = 40tmin = tmax - 8\u3000while True:temp = sense.get_temperature()#-----rd off temp to 2 d.p.-----temp = round(temp,2)print(temp)temp = int(temp) - tminfor x in range(0, 8):for y in range(0, temp):sense.set_pixel(x, y, 255, 0, 0)for y in range(temp, 8):sense.set_pixel(x, y, 0, 0, 0)\u00a0params = urllib.urlencode({'field1': temp, 'key':key })headers = {'Content-typZZe': 'application/x-www-form-urlencoded','Accept': 'text/plain'}conn = httplib.HTTPConnection('api.thingspeak.com:80')\u3000try:conn.request('POST', '/update', params, headers)response = conn.getresponse()print tempprint response.status, response.reasondata = response.read()conn.close()except:print 'connection failed'#break\u3000#sleep for desired amount of timeif __name__ == '__main__':while True:thermometer()time.sleep(sleep)\u3000\u3000", "num_user_post": " 1", "author": "embdev"}, {"date": "June 22, 2017 - 9:24 am", "content": "I think I see part of the problem.Following these lines in your code:tmax = 40tmin = tmax - 8Then tmin = 32.temp = int(temp) - tmin #.....or temp=30 - 32For temps such as 29-30, you would get a temp of -2 to -3 when you post to ThingSpeak. \u00a0This doesn't explain the values of 4 or 6, except if your variable type for temp is unsigned, but it explains some of the difference (rounding could explain more). \u00a0Generally ThingSpeak is pretty literal about what it does with your data, so I wouldn't usually look there if I see a wrong format of my data, as long as you get a success response after your post.Good luck with your project!", "num_user_post": " 401", "author": "cstapels"}, {"date": "June 23, 2017 - 2:24 am", "content": "I suspect the previous poster is correct- you are messing up the value of temp before you send it to thingspeak. Either save a copy of the variable or move the section where you send to thingspeak before you update the pixels.\u00a0If that doesnt work you could also try printing out the value of params to make sure you are sending what you think you are sending\u00a0print tempprint paramsprint response.status, response.reason", "num_user_post": " 271", "author": "rw950431"}]}, {"url": "https://community.thingspeak.com/forum/raspi/updating-multiple-thingspeak-channels-with-python/", "posts": [{"date": "March 30, 2017 - 7:56 am", "content": "\u00a0Hi everyone.I'm currently working on a raspberry pi based solution to monitor a greenhouse. I've got all my sensors (namely temperature and humididty sensors) to work and would like to display the readings i get from them on my website as graphs using thingspeak. I have successfully updated one channel but never managed to update the two i need at the same time. Here's my code :#!/usr/bin/python3import smbusimport timeimport http.client, urllib.parse# Get I2C busbus = smbus.SMBus(1)# SHT31 address, 0x44(68)# Send measurement command, 0x2C(44)#\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a00x06(06)\u00a0\u00a0 \u00a0High repeatability measurementbus.write_i2c_block_data(0x44, 0x2C, [0x06])time.sleep(0.5)# SHT31 address, 0x44(68)# Read data back from 0x00(00), 6 bytes# Temp MSB, Temp LSB, Temp CRC, Humididty MSB, Humidity LSB, Humidity CRCdata = bus.read_i2c_block_data(0x44, 0x00, 6)# Convert the datatemp = data[0] * 256 + data[1]cTemp = -45 + (175 * temp / 65535.0)fTemp = -49 + (315 * temp / 65535.0)humidity = 100 * (data[3] * 256 + data[4]) / 65535.0#Send humidityparams = urllib.parse.urlencode({'field3': humidity, 'key':'XXXXXXXX'})headers = {'Content-typZZe': 'application/x-www-form-urlencoded','Accept': 'text/plain'}conn = http.client.HTTPConnection('api.thingspeak.com:80')try:\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0conn.request('POST', '/update', params, headers)\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0response = conn.getresponse()\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0print (humidity)\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0print (response.status, response.reason)\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0data = response.read()\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0conn.close()except:\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0print ('connection failed')#Send temperatureparams = urllib.parse.urlencode({'field1': cTemp, 'key':'XXXXXXXXXXX'})headers = {'Content-typZZe': 'application/x-www-form-urlencoded','Accept': 'text/plain'}conn = http.client.HTTPConnection('api.thingspeak.com:80')try:\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0conn.request('POST', '/update', params, headers)\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0response = conn.getresponse()\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0print (cTemp)\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0print (response.status, response.reason)\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0data = response.read()\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0conn.close()except:\u00a0\u00a0 \u00a0\u00a0\u00a0 \u00a0print ('connection failed')# Output data to screenprint ('Temperature in Celsius is : %.2f C' %cTemp)print ('Temperature in Fahrenheit is : %.2f F' %fTemp)print( 'Relative Humidity is : %.2f %%RH' %humidity)\u00a0I'd like to know what I'm doing wrong and any advice or help is greatly appreciated.", "num_user_post": " 1", "author": "Pvince10"}, {"date": "March 30, 2017 - 6:57 pm", "content": "Pvince10,Welcome to the forum and TSYou can read your SHT31Now read this linkhttp://www.raspberrypi-spy.co.uk/?s=thingspeak(just tried my 'code cloning' and it is working fine in thingspeak ...)'mix and stir' your SHT31 code with his code and it will work for sureThen analyze the mix and you can understand 'a way' to use python in raspi. It is python 2 but does not matterGood luck ... it is easy", "num_user_post": " 91", "author": "piajola"}]}, {"url": "https://community.thingspeak.com/forum/raspi/do-two-pis-clash-with-each-other-when-sending-to-thingspeak/", "posts": [{"date": "January 18, 2017 - 9:37 am", "content": "HiI'm having a problem with one or other of two Pi's clashing with each other trying to send data to 5 fields on the same channels on ThingSpeak. The loser crashes.I have two Pi's. One is back home in England and that has been happily sending temperature data every 10 minutes from three Ds18b20's in different parts of my home for weeks if not months. See Channel 62333; Fields 1 thro' 3.The second Pi is here with me in Spain and I've been trying the same thing with two more DS18b20s; again every 10 minutes to Fields 4 and 5. when this starts up it runs OK until the times of the two Pi's sending information become close; at which point one or other fails in the posting and eventually one crashes.Has anyone got an idea as to how to avoid this without spending 'big money' on separate Channels?ThanksHyFy", "num_user_post": " 3", "author": "HyFy"}, {"date": "January 18, 2017 - 6:49 pm", "content": "The updates are probably failing due to the 15 second rule- you cant update the same channel more often than 15s. Why this causes them to crash is impossible to say without knowing more about the code you are using- the only difference in response is that you get 0 instead of a positive number if your update fails. This shouldnt cause anything to crash.I would have thought that your internet-connected Pi's should be able to run an NTP client that keeps their time in sync so as to avoid the timing conflict, given you have 10 minutes between updates.As a worst case you could modify your program to re-try after 15 seconds if it gets the 0 return code.", "num_user_post": " 271", "author": "rw950431"}, {"date": "January 19, 2017 - 4:49 am", "content": "Thanks for that 'rw950431'.\u00a0I'll review my coding but at the moment I can't think that the '0' response on it's own is causing the crash. The terminal display just gives 'Connection Failed' or '200OK' and then tries again 10 minutes later. \u00a0It seems that after a succession of failures it just gives up the ghost.I'm a bit stuck with what I can try here (basking in the hail, snow, gales and floods of southern Spain) as I don't want to try anything that will crash the one at home which I can't re-start from here.I'm not sure about the 'try again in 15 seconds option' as that may keep the two pi's in conflict for longer. \u00a0I'll put something on paper and see what it does.Thanks for your suggestions.HyFy", "num_user_post": " 3", "author": "HyFy"}, {"date": "January 19, 2017 - 7:01 pm", "content": "HyFy said  I'm not sure about the 'try again in 15 seconds option' as that may keep the two pi's in conflict for longer. \u00a0I'll put something on paper and see what it does.\u00a0 HyFy\u00a0\u00a0If you check the return code and ensure that only the failed one retries this wont be a problem since the first one will suceed and not retry.Maybe you have a memory leak in your code thats only triggered by the error condition?\u00a0 It seems odd though since every request still returns the same '200 OK' status even if the channel rejects the update.\u00a0\u00a0 Could it be that the error condition doesnt properly close the connection so eventually you run out of available sockets? ('netstat --inet' is helpful here along with 'ulimit -n' to get the max)When you say 'crashes' what exactly do you mean?\u00a0 The process sending the data exits or the whole RPi somehow locks up?One option is to modify your local copy to push the data somewhere else temporarily (I often use https://requestb.in/ for such purposes) and see if that makes the problem go away.", "num_user_post": " 271", "author": "rw950431"}, {"date": "January 21, 2017 - 9:07 am", "content": "rw950431 said Maybe you have a memory leak in your code thats only triggered by the error condition?\u00a0 It seems odd though since every request still returns the same '200 OK' status even if the channel rejects the update.\u00a0\u00a0 Could it be that the error condition doesnt properly close the connection so eventually you run out of available sockets? ('netstat --inet' is helpful here along with 'ulimit -n' to get the max) When you say 'crashes' what exactly do you mean?\u00a0 The process sending the data exits or the whole RPi somehow locks up?I'll have a second go at this. The gremlins got into my last reply and dropped it where ever.In my original I mentioned that I either get 'Connection Failed' or '200 OK' depending on whether there had been a conflict \u00a0or not. If the were a series (sometimes even only one) of the former the sending Pi locked up and if it was at a distance, I could not restart it.But you have given me plenty to read up on and try out once I have access to both Pi's.I will let you know what the results are.......and if this rain in Spain (which is not on the plain) doesn't ease up I will be home and trying things sooner rather than later!!Thanks againHyFy", "num_user_post": " 3", "author": "HyFy"}]}, {"url": "https://community.thingspeak.com/forum/raspi/raspberry-pi-and-dragino-lora-hat/", "posts": [{"date": "January 5, 2017 - 4:51 am", "content": "Hi all,I am using a\u00a0Raspberry Pi and Dragino Lora Hat to build a single channel Lora gateway. I unfortunately have not been able to find any sample code to get it to forward packets to the Thingspeak API. If anyone perhaps have used these components or have any sample code available, I would greatly appreciate it if you would be willing to share it.Thank you very much!Albert", "num_user_post": " 2", "author": "avdvyver"}, {"date": "January 5, 2017 - 1:29 pm", "content": "Hi\u00a0Albert,Click this link \u00a0 \u00a0 \u00a0 \u00a0  http://cpham.perso.univ-pau.fr/LORA/RPIgateway.htmlIt is a copy/pas.. copy/clone kind of 1st solution to get started and then with a working thing start your own wayFully read and go to the mentioned github address, there is one example to post to\u00a0ThingspeakHope this is of some help and good luck\u00a0", "num_user_post": " 91", "author": "piajola"}, {"date": "January 9, 2017 - 1:41 am", "content": "Thanks a lot\u00a0piajola, much appreciated!", "num_user_post": " 2", "author": "avdvyver"}, {"date": "January 11, 2017 - 7:55 am", "content": "Thank you for posting that link, Piajola. That's\u00a0pretty well documented for a 1st solution\u00a0", "num_user_post": " 225", "author": "Vinod"}, {"date": "January 11, 2017 - 2:41 pm", "content": "Hi Vinod,", "num_user_post": " 91", "author": "piajola"}]}]}