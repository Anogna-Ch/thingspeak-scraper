{"url": "https://community.thingspeak.com/forum/thingspeak-api/page-7/", "threads": [{"url": "https://community.thingspeak.com/forum/thingspeak-api/rfid-and-thingspeak/", "posts": [{"date": "April 13, 2018 - 10:42 am", "content": "i started a project for smart parking, and iam using a rfid tag in the car and rfid reader in the parking spot.so the question i want to ask is the can i use a single channel to push one tag per one field and also weather or not field individually give lat long or not\u00a0please advice or suggest better method", "num_user_post": " 1", "author": "apollyon"}, {"date": "April 13, 2018 - 3:24 pm", "content": "Sounds like a great project for ThingSpeak.\u00a0I would use a channel for each tag.\u00a0 Since the fields in a single update all share a single timestamp, every time you post with a tag, all the other tag fields would be updated with a NULL value.Latitude and Longitude are available with each feed entry, so if you have two fields updated in the same post, you would not be able to have separate location information.\u00a0 However, if the updates were from two separate devices, they would be separate entries and they would each have their own location information.Still, I urge you to use one whole channel per device. Your data will be much easier to sort and understand.", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/newbie-question-sorry-string-writeapikey/", "posts": [{"date": "March 30, 2018 - 10:00 am", "content": "I signed up for api.thingspeak.combut have no clue how to fill in below.All I have is my email address.Help!Thanks,Ray\u00a0// ThingSpeak Settingsconst int channelID = XXX;String writeAPIKey = 'XXXXXXXXXXXXXXXX'; // write API key for your ThingSpeak Channelconst char* server = 'api.thingspeak.com';const int postingInterval = 20 * 1000; // post data every 20 seconds", "num_user_post": " 1", "author": "raytravel"}, {"date": "March 30, 2018 - 11:22 am", "content": "Have a look at the Getting started tutorial.\u00a0 Its a nice quick overview that will answer a lot of your questions and help you get going.To see the API Keys, click the API Keys tab of your channel view.", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/something-changed-about-a-month-ago-and-even-the-published-example-no-longer-works-for-thinghttp/", "posts": [{"date": "September 30, 2017 - 3:21 pm", "content": "Hi everyone,Something changed about a month ago and even the published example no longer works for ThingHTTP?Here's the example which no longer works straight out of the ThingHTTP setup window:https://imgur.com/eXvWcMyHow does one make it work again with whatever changes have occurred?Thank you~B", "num_user_post": " 8", "author": "bubba198"}, {"date": "September 30, 2017 - 3:29 pm", "content": "ThingHTTP as such has not changed.\u00a0Google changed the google finance website. Change the URL field to https://finance.google.com/finance and everything else should work as is. It will be interesting to see what additional changes come in November, now that Google has announced that the Google finance page will be changing.", "num_user_post": " 225", "author": "Vinod"}, {"date": "September 30, 2017 - 3:33 pm", "content": "Thank you - confirming that the URL you suggested does work! Thanks. Maybe someone would update the example under ThingHTTP.. Thank youVinod said ThingHTTP as such has not changed.\u00a0 Google changed the google finance website. Change the URL field to https://finance.google.com/finance and everything else should work as is. It will be interesting to see what additional changes come in November, now that Google has announced that the Google finance page will be changing.\u00a0\u00a0", "num_user_post": " 8", "author": "bubba198"}, {"date": "October 2, 2017 - 1:25 pm", "content": "Also, it looks like google changed the unique ID to\u00a0#ref_626307_l from\u00a0#ref_626307_c.\u00a0\u00a0", "num_user_post": " 401", "author": "cstapels"}, {"date": "March 28, 2018 - 9:52 am", "content": "Now Google Finance is completely broken, none of the examples work and the new\u00a0#ref_626307_c also doesn't work.\u00a0Any ideas anyone?~B", "num_user_post": " 8", "author": "bubba198"}, {"date": "March 28, 2018 - 10:50 am", "content": "Google is making changes quite frequently.\u00a0 You can get the S&P value, and a bunch other values from Marketwatch.In your ThingHTTP:Enter https://www.marketwatch.com in the URL fieldEnter GET in the Method fieldIn the Parse String field, enter the XPATH/html/body/header/div[2]/div[1]/div/div[1]/table/tbody/tr[2]/td[4]/bg-quoteThis will give the present value of the S&P 500, not the change for the day.", "num_user_post": " 401", "author": "cstapels"}, {"date": "March 28, 2018 - 6:32 pm", "content": "@cstapels -- Thank you, Marketwatch did work, none of the other sites work even though I copy the XPATH using Chrome just as I did for Marketwatch.\u00a0The issue at hand is solved but I am curious nonetheless, is there some kind of defect with using XPATH if so many sites simply do not work even though I inspect the element carefully and copy and paste the XPATH using the browser function (no human typing it of course)?Thanks~B", "num_user_post": " 8", "author": "bubba198"}, {"date": "March 29, 2018 - 4:44 pm", "content": "Many of these sites use code that calls some other process or script to populate the number you see.\u00a0 The xpath to the number you want is correct, but the number is not yet there when you ask urlfilter() to parse the page.\u00a0 The function does not wait for any other scripts to complete.\u00a0", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/esp32-only-able-to-send-field1null/", "posts": [{"date": "March 13, 2018 - 5:59 am", "content": "I want to send some data to thingspeak, but whatever I try, I'm only able to get logged and receive the entry-id back, but nothing gets written.The code is\u00a0void HTTPSend(String field1, String field2) { // Send 1 or 2 string to ThingSpeak if (client.connect(TSserver, 80)) { Serial.println('Connected to Thingspeak'); // Construct API request body String body = 'field1='; body += field1; if (field2.length()){ body += '&field2='; body += field2; } body +=''; // added because it didn't work. No effect client.println('POST /update HTTP/1.1'); client.println('Host: api.thingspeak.com'); client.println('User-Agent: ESP8266 (nothans)/1.0'); client.println('Connection: close'); client.println('X-THINGSPEAKAPIKEY: ' + writeAPIKey); client.println('Content-Type: application/x-www-form-urlencoded'); client.println('Content-Length: ' + body.length()); client.println(''); client.print(body); // No println in the original sketch? Serial.print(body); client.println('');\u00a0 // added because it didn't work. No effectunsigned long timeout = millis(); // added a response reception to detect errors. Get the entry_id while (client.available() == 0) { if (millis() - timeout > 5000) { Serial.println('>>> Client Connection Timeout...Stopping'); client.stop(); } } Serial.println('Receiving Thingspeak response'); while(client.available()) { body = client.readStringUntil(''); Serial.print('.'); } Serial.print(body); } client.stop(); // Whether connection was successful or not}Any idea what can be rong ? Nothing is shown in the dashboard, and the json export is a proof that the packet was sent and received, but it says nothing else than 'field1':null", "num_user_post": " 9", "author": "tochinet"}, {"date": "March 13, 2018 - 9:12 am", "content": "The format of your HTTP POST command seems to be fine, you might want to remove the (nothans) and change it to (tochicnet), but that wont change how anything works. Here are some troubleshooting steps:Does the entry ID increase each time you write?Can you write to the channel using a browser GET command? Here is the format, make sure you use the channel write API key.https://api.thingspeak.com/update.json?api_key=<your_write_api_key>&field1=123Can you output the variable you call field1 to the serial monitor just before you append it to the body to make sure something is there? I see there is already a print command for the body variable. What do you see in the serial monitor after Serial.println(body); ?\u00a0\u00a0", "num_user_post": " 401", "author": "cstapels"}, {"date": "March 13, 2018 - 2:19 pm", "content": "Does the entry ID increase each time you write?Definitely. And the server replies that number as body.\u00a0Can you write to the channel using a browser GET command?\u00a0Here is the format, make sure you use the channel write API key.https://api.thingspeak.com/update.json?api_key=<your_write_api_key>&field1=123Yes, it works.Can you output the variable you call field1 to the serial monitor just before you append it to the body to make sure something is there? I see there is already a print command for the body variable. What do you see in the serial monitor after Serial.println(body); ?\u00a0\u00a0Depending on the values, the body is\u00a0 for example field1=5.0&field2=6.0", "num_user_post": " 9", "author": "tochinet"}, {"date": "March 14, 2018 - 10:29 am", "content": "You seem to be doing everything correct.\u00a0 If your channel is public, can you share the channel number?\u00a0 Otherwise can you show what the last update looks like? You can use this in your browser:https://api.thingspeak.com/channels/<your_channelID>/feeds/last.json\u00a0", "num_user_post": " 401", "author": "cstapels"}, {"date": "March 16, 2018 - 9:52 am", "content": "Sure, its public, https://thingspeak.com/channels/160089\u00a0Last post is (after my manual try on your request)\u00a0{'created_at':'2018-03-13T19:17:04+01:00','entry_id':262,'field1':'123','field2':null,'field3':null}Can it be linked with the decimal dot in the values ?I see that the entry_id or nulls have no quotes but the field1 value has.", "num_user_post": " 9", "author": "tochinet"}, {"date": "March 16, 2018 - 11:01 am", "content": "ThingSpeak can understand decimal values.\u00a0 If you want you can convince yourself with this command in your browserhttps://api.thingspeak.com/update.json?api_key=<your_write_api_key>&field1=12.3Here are two more small things you can try.The network strength example in the documentation does not send a line feed at the end of the post.\u00a0 I see some comments in your code that might indicate you already tried this.Also,the string for body may not be printing to the client as expected.\u00a0\u00a0Instead of\u00a0client.print(body);\u00a0You cold try hard coding the output:client.println('Content-Length: ' + length('field1=1.23));client.print('field1=1.23');\u00a0And then if that works, you can try it in two parts:client.print('field1=');client.print(string(field1));\u00a0\u00a0", "num_user_post": " 401", "author": "cstapels"}, {"date": "March 18, 2018 - 12:06 pm", "content": "Thanks for the proposal, but it won't work, length is only a method of string. It says undefined.I tried many other variations in no particular order, and when I focused on the content typeclient.println('Content-Type: application/x-www-form-urlencoded');I tried to put the values in the URL, and it finally worked.Got as reply (yes, changed as json in the meantime as wellConnected to Thingspeakfield1=123.23&field2=6.0Receiving Thingspeak responseHTTP/1.1 200 OKContent-Type: application/json; charset=utf-8Transfer-Encoding: chunkedConnection: closeStatus: 200 OKX-Frame-Options: ALLOWALLAccess-Control-Allow-Origin: *Access-Control-Allow-Methods: GET, POST, PUT, OPTIONS, DELETE, PATCHAccess-Control-Allow-Headers: origin, content-type, X-Requested-WithAccess-Control-Max-Age: 1800ETag: 'e78f0xxxxxxxxxxxxxxxxxx0203'Cache-Control: max-age=0, private, must-revalidateSet-Cookie: request_method=POST; path=/X-Request-Id: c4cf.....................4dX-Runtime: 0.067653X-Powered-By: Phusion Passenger 4.0.57Date: Sun, 18 Mar 2018 16:04:46 GMTServer: nginx/1.9.3 + Phusion Passenger 4.0.57102{'channel_id':160089,'field1':'123.23','field2':'6.0','field3':null,'field4':null,'field5':null,'field6':null,'field7':null,'field8':null,'created_at':'2018-03-18T16:04:46+00:00','entry_id':357,'status':null,'latitude':null,'longitude':null,'elevation':null}0\u00a0Any reason why there is a number before and after the JSON in the body ?", "num_user_post": " 9", "author": "tochinet"}, {"date": "March 18, 2018 - 2:13 pm", "content": "Thanks for catching my bad syntax. I should have writtenString fieldData ='field1=12.3';client.println('Content-Length: ' + fieldData.length());client.print('field1=1.23');\u00a0I'm glad you got it working. Can you show the line(s) where you 'put the values in the URL'?\u00a0I will look into the numbers you are getting before the JSON response, I do not see those with an update from POSTMAN. I can try it with an ESP32 later.\u00a0 These are the other headers I see:access-control-allow-headers\u00a0\u2192origin, content-type, X-Requested-Withaccess-control-allow-methods\u00a0\u2192GET, POST, PUT, OPTIONS, DELETE, PATCHaccess-control-allow-origin\u00a0\u2192*access-control-max-age\u00a0\u21921800cache-control\u00a0\u2192max-age=0, private, must-revalidateconnection\u00a0\u2192closecontent-type\u00a0\u2192application/json; charset=utf-8date\u00a0\u2192Sun, 18 Mar 2018 17:57:51 GMTetag\u00a0\u2192'25ddfff65cd7e90df008cb339d7a0d11'server\u00a0\u2192nginx/1.9.3 + Phusion Passenger 4.0.57status\u00a0\u2192200 OKtransfer-encoding\u00a0\u2192chunkedx-frame-options\u00a0\u2192ALLOWALLx-powered-by\u00a0\u2192Phusion Passenger 4.0.57x-request-id\u00a0\u2192bbefaa13-c868-4a87-9870-813d94d89ae7x-runtime\u00a0\u21920.037343\u00a0and the JSON response is\u00a0\u00a0{'channel_id':nnnnnn,'field1':'2','field2':null,'field3':null,'field4':null,'field5':null,'field6':null,'field7':null,'field8':null,'created_at':'2018-03-18T17:57:51+00:00','entry_id':8,'status':null,'latitude':null,'longitude':null,'elevation':null}\u00a0Is there anything else you are writing the serial monitor?\u00a0", "num_user_post": " 401", "author": "cstapels"}, {"date": "March 19, 2018 - 8:05 am", "content": "Thanks for your great and fast support. The code as I changed it to post was now as below.I'm still considering moving back the 'body' part to the request body, it's cleaner.I'm also wondering if the vs vs. println could have an impact. I read somewhere that the HTTP protocol specified but I don't think Arduino Serial does.I may be mistaken, but at least for the first number,\u00a0 it couldn't be due to some other Serial.print etc because it's part of the same loop. However, it could be some bogus content-length. For the second ('0'), there could always be another unspotted Serial.print somewhere.void HTTPSend2TS(String field1, String field2) { // Send 1 or 2 strings to ThingSpeak if (client.connect(TSserver, 80)) { Serial.println('Connected to Thingspeak'); // Construct API request body String body = 'field1='; body += field1; if (field2.length()){ body += '&field2='; body += field2; } client.print('POST /update.json?'); Serial.print('POST /update.json?'); client.print(body); // Here as parameters client.println(' HTTP/1.1'); // End of the URL line in HTTP specs Serial.print(body); // Here as parameters Serial.println(' HTTP/1.1'); // End of the URL line in HTTP specs client.println('Host: api.thingspeak.com'); client.println('User-Agent: ESP8266 (d-duino)/0.666'); client.println('Connection: close'); client.println('X-THINGSPEAKAPIKEY: ' + writeAPIKey); client.println('Content-Type: application/x-www-form-urlencoded');// client.println('Content-Length: ' + body.length()); client.println(''); // Empty line between Headers: and body// client.println(body); // No println?// Serial.print(body); client.print('');unsigned long timeout = millis(); while (client.available() == 0) { if (millis() - timeout > 5000) { Serial.println('>>> Client Connection Timeout...Stopping'); client.stop(); } } Serial.println('Receiving Thingspeak response'); while(client.available()) { body = client.readStringUntil('');// Serial.print('.'); // One dot per line replied. Replaced by a real print for debug. Serial.print(body); }// Serial.print(body); } client.stop(); // Whether connection was successful or not}", "num_user_post": " 9", "author": "tochinet"}, {"date": "March 19, 2018 - 8:09 am", "content": "Error in the post above, the <backslash>-r and <backslash>-n were not automatically escaped. Trying to repeat hereI'm also wondering if the ''\u00a0vs '' vs println could have an impact.", "num_user_post": " 9", "author": "tochinet"}, {"date": "March 19, 2018 - 8:14 am", "content": "Can't apparently edit the postings, I obviously meant I'm wondering if the '<backslach>-r <backslash>-n' vs '<backslash>-n' vs 'println' (instead of print) would have an impact.", "num_user_post": " 9", "author": "tochinet"}, {"date": "March 19, 2018 - 4:35 pm", "content": "The code below works to post values.\u00a0 I think the difference is that you need to convert the output of body.length() to a string.\u00a0 You can also include the API key in the body, and that saves one extra header and some lines of code.String postData='api_key=XXXXXXXXXXXXXXXX&field1=2'; //I build this programatically, see the example code in the soil moisture example.client.println( 'POST /update.json HTTP/1.1' ); client.println( 'Host: api.thingspeak.com' ); client.println( 'Connection: close' ); client.println( 'Content-Type: application/x-www-form-urlencoded' ); client.println( 'Content-Length: ' + String( postData.length() ) ); client.println(); client.println( postData );I have also observed the extra characters before and after the output for a device (esp8266), we are looking into that, and the ability to edit posts here.", "num_user_post": " 401", "author": "cstapels"}, {"date": "March 19, 2018 - 5:20 pm", "content": "The numbers before and after the response are the size of the remaining chunks in hex.\u00a0 The response includes the header:Transfer-Encoding: chunked (wiki link)In your case, there were 258 bytes in the response, or 102 in hex.\u00a0 After the data, there were 0 bytes remaining.\u00a0 This may be a device or library dependent issue, POSTMAN does not generally show the bytes in the response.\u00a0 I did see it on an ESP8266 with <ESP8266WiFi.h> library.You should consider using the ThingSpeak Communication Library.\u00a0 It is compatible with ESP32, and takes care of a lot of these details for you.\u00a0 There are several examples in the Arduino section of the documentation examples that show how to use the library, including the Sonar Example.\u00a0 The process for ESP32 will be very similar to Arduino.\u00a0 If you aren't already programming with Arduino, the ESP32 network strength example in the documentation demonstrates how to set it up.\u00a0 \u00a0There are also Arduino examples that come with the ThingSpeak library.", "num_user_post": " 401", "author": "cstapels"}, {"date": "March 21, 2018 - 4:27 am", "content": "Thanks for the content length tip, I'll try tonight.I looked at the library, but in general (Arduino, I have less experience with ESP) I'm reluctant to use libraries, because each one brings extra and often hidden dependencies. My worst experience was with 'SWRTC' from Leornardo Miliani, that was really nice, ... until there were issues in the use of timer 2, then differences between 3.0 and 3.1, then lower level of support, ... and after 2 years of use I had to drop it and re-engineer whay I needed myself. Of course I learned a lot in the process though.The thingspeak library looks nice, but I didn't complete my analysis. It's\u00a0 obviously pretty complex because of the support of several CPUs. One concern is whether it could interact with my other uses of the WiFi client (currently fetching a Weather Underground prediction, but I plan to add other functions). In addition, the closest example to what I want to do (Writing multiple voltages) is not compatible with ESP, and also looks bloated with compiler directives.This seriously reduces first sight attractivity.", "num_user_post": " 9", "author": "tochinet"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/multiple-string-in-same-field/", "posts": [{"date": "March 6, 2018 - 1:12 am", "content": "Hello,I am able to upload two string in two different field.String str='GET https://api.thingspeak.com/update?api_key=xxxxxxxxxxxxxx&field1=0' + String(temp)+'&field2=' +String(temp2);\u00a0How to upload two string in a single field, can anyone help?", "num_user_post": " 3", "author": "Mohd Shanawaz"}, {"date": "March 6, 2018 - 2:40 pm", "content": "I would not recommend putting two strings in the same field.\u00a0 In the end, I suspect it will make things more difficult.\u00a0 \u00a0 If you need more than 8 fields, consider using a second channel.If you need to combine the two, I would consider using the strcat() function.\u00a0 This assumes you are posting from a c based device, or posting from a MATLAB analysis.\u00a0 You may have to adjust the syntax below depending on the language you are using.variable1, variable2, bufferdelimiter=',';buffer=strcat(variable1,delimeter);buffer=strcat(buffer,variable2);GET\u00a0https://api.thingspeak.com/update?api_key=xxxxxxxxxxxxxx&field1=' + String(buffer);", "num_user_post": " 401", "author": "cstapels"}, {"date": "March 8, 2018 - 6:09 am", "content": "Thank you cstapels for your valuable reply.I am working on arduino, can you tell me how to write this function for it.", "num_user_post": " 3", "author": "Mohd Shanawaz"}, {"date": "March 8, 2018 - 10:02 am", "content": "I don't recommend putting both values in the same field.\u00a0 You can easily find examples for strcat and Arduino elsewhere, so that you can make sure I have the syntax correct.\u00a0Here is a c reference for strcat.\u00a0\u00a0The first argument is the destination.\u00a0delimiter=',';strcat(variable1,delimeter);buffer=strcat(variable1,variable2);GET\u00a0https://api.thingspeak.com/update?api_key=xxxxxxxxxxxxxx&field1=' + String(buffer);", "num_user_post": " 401", "author": "cstapels"}, {"date": "March 20, 2018 - 8:04 am", "content": "Hello cstapels;I am able to upload two values in same field but it is visible only in csv file and not on the graph. On graph I am able to see only the first value.Can you help?", "num_user_post": " 3", "author": "Mohd Shanawaz"}, {"date": "March 20, 2018 - 8:39 am", "content": "Thingspeak plots cannot interpret two values in the same field.\u00a0 This is another good reason to avoid putting two values in the same field.\u00a0 If you need to do this, you can write a MATLAB analysis to read the channel and then split the strings.I would consider using thingSpeakRead and strsplit, and then plot or thingSpeakPlot.", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/gsm-gps-thingspeak/", "posts": [{"date": "March 14, 2018 - 12:30 pm", "content": "hi there. i have problem sent data to thingspeak. the data is not update in thingspeak. i not sure either problem because of hardware or coding. someone please help me. my project is sent latitude and longitude to the thingspeak. here my coding.#include<LiquidCrystal.h>LiquidCrystal lcd(7, 6, 5, 4, 3, 2);#include <SoftwareSerial.h>SoftwareSerial espSerial = SoftwareSerial(8,9); // rx,txSoftwareSerial gps(10,11); // RX, TX//String str='';char str[70];String gpsString='';char *test='$GPGGA';String latitude='No Range ';String longitude='No Range ';int temp=0,i;boolean gps_status=0;float latt,longg;String apiKey = '*************'; // replace with your channel's thingspeak WRITE API key\u00a0boolean DEBUG=true;void setup(){ lcd.begin(16,2); Serial.begin(9600); espSerial.begin(9600); gps.begin(9600); lcd.print('Vehicle Tracking'); lcd.setCursor(0,1); lcd.print(' System '); delay(2000); gsm_init(); lcd.clear(); espSerial.listen(); espSerial.println('AT+CNMI=2,2,0,0,0'); lcd.print('GPS Initializing'); lcd.setCursor(0,1); lcd.print(' No GPS Range '); gps.listen(); get_gps(); delay(2000); temp=0;}void loop(){ get_gps(); thingSpeakWrite(latt*100,longg*100); delay(15000);\u00a0}void showResponse(int waitTime){ espSerial.listen(); long t=millis(); char c; while (t+waitTime>millis()){ if (espSerial.available()){ c=espSerial.read(); if (DEBUG) Serial.print(c); } }}boolean thingSpeakWrite(float value1,float value2){ espSerial.listen(); String cmd = 'AT+CIPSTART='TCP',''; // TCP connection cmd += 'api.thingspeak.com'; // api.thingspeak.com cmd += '',80'; espSerial.println(cmd); if (DEBUG) Serial.println(cmd); if(espSerial.find('Error')){ if (DEBUG) Serial.println('AT+CIPSTART error'); return false; } String getStr = 'GET/update?api_key=1YFHFYQF5T1CXHWS&field1=0'; // prepare GET stringgetStr +='&field1='; getStr += String(value1); getStr +='&field2='; getStr += String(value2); // getStr +='&field3='; // getStr += String(value3); // ... getStr += '';// send data length cmd = 'AT+CIPSEND='; cmd += String(getStr.length()); espSerial.println(cmd); if (DEBUG) Serial.println(cmd); delay(100); if(espSerial.find('>')){ espSerial.print(getStr); if (DEBUG) Serial.print(getStr); } else{ espSerial.println('AT+CIPCLOSE'); // alert user if (DEBUG) Serial.println('AT+CIPCLOSE'); return false; } return true;}\u00a0float conv_coords(float in_coords) { //Initialize the location. float f = in_coords; // Get the first two digits by turning f into an integer, then doing an integer divide by 100; // firsttowdigits should be 77 at this point. int firsttwodigits = ((int)f)/100; //This assumes that f < 10000. float nexttwodigits = f - (float)(firsttwodigits*100); float theFinalAnswer = (float)(firsttwodigits + nexttwodigits/60.0); return theFinalAnswer; }void serialEvent(){ espSerial.listen(); while(espSerial.available()) { if(espSerial.find('Track Vehicle')) { temp=1; break; } else temp=0; }}void gpsEvent(){ gps.listen(); gpsString=''; while(1) { while (gps.available()>0) //checking serial data from GPS { char inChar = (char)gps.read(); gpsString+= inChar; //store data from GPS into gpsString i++; if (i < 7) { if(gpsString[i-1] != test[i-1]) //checking for $GPGGA sentence { i=0; gpsString=''; } } if(inChar=='') { if(i>65) { gps_status=1; break; } else { i=0; } } } if(gps_status) break; }}void gsm_init(){ espSerial.listen(); lcd.clear(); lcd.print('Finding Module..'); boolean at_flag=1; while(at_flag) { espSerial.println('AT'); while(espSerial.available()>0) { if(espSerial.find('OK')) at_flag=0; } delay(1000); } lcd.clear(); lcd.print('Module Connected..'); delay(1000); lcd.clear(); lcd.print('Disabling ECHO'); boolean echo_flag=1; while(echo_flag) { espSerial.println('ATE0'); while(espSerial.available()>0) { if(espSerial.find('OK')) echo_flag=0; } delay(1000); } lcd.clear(); lcd.print('Echo OFF'); delay(1000); lcd.clear(); lcd.print('Finding Network..'); boolean net_flag=1; while(net_flag) { espSerial.println('AT+CPIN?'); while(espSerial.available()>0) { if(espSerial.find('+CPIN: READY')) net_flag=0; } delay(1000); } lcd.clear(); lcd.print('Network Found..'); delay(1000); lcd.clear();}void get_gps(){ gps.listen(); gps_status=0; int x=0; while(gps_status==0) { gpsEvent(); int str_lenth=i; latitude=''; longitude=''; int comma=0; while(x<str_lenth) { if(gpsString[x]==',') comma++; if(comma==2) //extract latitude from string latitude+=gpsString[x+1]; else if(comma==4) //extract longitude from string longitude+=gpsString[x+1]; x++; } int l1=latitude.length(); latitude[l1-1]=' '; l1=longitude.length(); longitude[l1-1]=' '; lcd.clear(); float latt1 = latitude.toFloat(); latt = conv_coords(latt1);float longg1 = longitude.toFloat(); longg = conv_coords(longg1); lcd.print('Lat:'); lcd.print(latt); lcd.setCursor(0,1); lcd.print('Long:'); lcd.print(longg); i=0;x=0; str_lenth=0;}}void init_sms(){ espSerial.listen(); espSerial.println('AT+CMGF=1'); delay(400); espSerial.println('AT+CMGS='+**********''); // use your 10 digit cell no. here delay(400); //delay(400);}void send_data(String message){ espSerial.listen(); espSerial.println(message); delay(200);}void send_sms(){ espSerial.listen(); espSerial.write(26);}void lcd_status(){ lcd.clear(); lcd.print('Message Sent'); delay(2000); lcd.clear(); lcd.print('System Ready'); int l1=latitude.length(); latitude[l1-1]=' '; l1=longitude.length(); longitude[l1-1]=' '; lcd.clear(); lcd.print('Lat:'); lcd.print(latt); lcd.setCursor(0,1); lcd.print('Long:'); lcd.print(longg); return;}void tracking(){ espSerial.listen(); init_sms(); send_data('Vehicle Tracking Alert:'); send_data('Your Vehicle Current Location is:'); espSerial.print('Latitude:'); send_data(String(latt)); espSerial.print('Longitude:'); send_data(String(longg)); send_data('Please take some action soon..Thankyou'); send_sms(); delay(2000); lcd_status();}", "num_user_post": " 2", "author": "Asdm"}, {"date": "March 14, 2018 - 2:49 pm", "content": "Sounds like a fun project. Can you tell us what you are tracking?You may need a space between the 'GET' and '/update' in the string you build to send your HTTP command.\u00a0String getStr = 'GET/update?api_key=1YFHFYQF5T1CXHWS&field1=0'; // prepare GET stringCan you describe what you see on the serial monitor?\u00a0\u00a0", "num_user_post": " 401", "author": "cstapels"}, {"date": "March 15, 2018 - 12:02 pm", "content": "cstapels said  Sounds like a fun project. Can you tell us what you are tracking? You may need a space between the 'GET' and '/update' in the string you build to send your HTTP command.\u00a0 String getStr = 'GET/update?api_key=1YFHFYQF5T1CXHWS&field1=0'; // prepare GET string Can you describe what you see on the serial monitor?\u00a0\u00a0\u00a0\u00a0my project is about to track vehicle. when i sent 'track vehicle' to the sim number, gsm didnt sent back feedback message.", "num_user_post": " 2", "author": "Asdm"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/mqtt-fx-to-thingspeak-mqtt-broker/", "posts": [{"date": "March 6, 2018 - 11:02 pm", "content": "Hi:I've tried running your MQTT.FX to ThingSpeak tutorial and I'm not receiving data on my channel.\u00a0 The MQTT.FX log shows I'm successfully Publishing data, however, on the ThingSpeak side my channel shows 0 entries.\u00a0 I could use some help on the ThingSpeak side debugging this.Thanks,Ralph.", "num_user_post": " 2", "author": "rstacey"}, {"date": "March 7, 2018 - 9:10 am", "content": "The log in MQTT.fx only records that a publish message was sent successfully.\u00a0 It won't tell you anything about what happens on service side.\u00a0 For example, if the API key or channel number is wrong, an error won't show up in the MQTT.fx log.Here is a handy list of things to check if MQTT publish isn't working for you:https://www.mathworks.com/help/thingspeak/troubleshoot-MQTT-publish.html\u00a0\u00a0", "num_user_post": " 34", "author": "JasonW"}, {"date": "March 9, 2018 - 6:44 pm", "content": "Found the problem.\u00a0 I was using the MQTT API key in the Publish link in MQTT.FX.\u00a0 I replaced it with the Write API key and all's well.\u00a0 Thanks.", "num_user_post": " 2", "author": "rstacey"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/extend-timescale/", "posts": [{"date": "March 1, 2016 - 5:45 am", "content": "HiWith an update each 15sec, the timescale parameters seems  a bit limited.Would be nice to have it completly dynamic and not limited to some values ( actual is 10, 20, ... 720..).this would allow me to generate graph with different time range always using the same 'resolution' by adjusting dynamically the timescale to export the same volume of data.If it's not possible, could you add 1 mn and 5mn to the timescale ( & even a bit more if you can ).Thanks.", "num_user_post": " 3", "author": "kipk"}, {"date": "March 1, 2016 - 5:52 am", "content": "ho another thing, when exporting using timescale parameter, it starts to jump from first value. The problem with that is you always miss the last fresh value then.Using timescale should timescale from the last values to the first. Missing the first one is mostly less important than the last fresh data.This also solve some charts api display problem like generating highstock with highchart.js. Missing last data can makes important gaps on the chart navigator bar at loading, and cause nav issue.", "num_user_post": " 3", "author": "kipk"}, {"date": "March 7, 2016 - 11:14 am", "content": "I hope some TeamSpeak guy will pass here.I've found a more important issue.I was wondering why I couldn't get like one month of field data using timescale to preserve bandwidth.Whatever the TimeScale parameter I use, it only gives me 34 hours of last data ( one data each 15 )It seems the Timescale filtering is applied after the export limit. I mean, if you have like 2 102 400 entries in your channel corresponding at sensors updating each 15sec for a year, and you want to grab this year of data with a timescale of  1440, this should gives 1460 entries. Far better than grabing the 2102400 just for generating a year graph.But you can't because it will filter the last limited entries (looks to be 8000 )  giving only 5 result ( 8000/1440)There's no sense of having a timescale parameter capable of 1440 if the source data is filtered before to the last 8000 entries.It should work the other way, first it filters data with timescale from your database, then if there's more than the limit, only deliver the last 8000..This looks more a bug than a feature, or have I missed something ? Any input from ThingSpeak devs?Thanks", "num_user_post": " 3", "author": "kipk"}, {"date": "January 18, 2018 - 2:25 am", "content": "I would like to push this issue - as I encountered the same problem.It's a real pain and API bug that should be fixed.A simple setup (i assume 1 month has 30 days in average)- log data for a year in a 15 Min interval.- try to query a range of one year => you will be limited to 8000 points (8000 points / 96 points[per day]/30 days[per month] = 2.7 months, instead of a year)- try the logical consequence: reduce the interval to 60 mins (which should give you: 8000 / 24 / 30 = 11.1 months, almost a year)The real result however is, that you will get the datapoints within a 2.7 months timespan but a lower resolution. So changing the interval parameter does not help you at all to change the length of a plottable timespan.Could you please have a look at this issue as this heavily limits the useability ?", "num_user_post": " 1", "author": "schlaubstar"}, {"date": "January 18, 2018 - 9:31 am", "content": "We'll look into this and get back on this thread.", "num_user_post": " 225", "author": "Vinod"}, {"date": "March 9, 2018 - 8:30 am", "content": "Anything new regarding this weird 8000 points limit behaviour when using timescale/average/median/sum?Uploading data at 15 second interval, for example to have one year's daily averages data, you'd normally need minimal bandwidth and only one api call for 364 values.But to get this the way it is implemented now, you'd have to make 365*24*60*4 / 8000 = 263 api calls, each giving you only 1.4 days worth of data - so 263x more connections and A LOT bigger bandwidth use, which is not really feasible way of getting long term averages.If you upload data only once per minute, you'd still have to make 365*24*60 / 8000 = 66 api calls, each worth 5.5 days of data, only to get one year worth of daily averages. It is practically the same if you want monthly averages that would otherwise only take one api call of 12 data points...This is really annoying and complicates making longer term averages/comparisons inefficient as it takes a lot of unnecessary\u00a0 internet traffic/thingspeak bandwidth load.Is there a plan to change this behaviour in near future? Are there any better/more efficient ways to do it?Thanx and best regards!DejansLOVEnia", "num_user_post": " 2", "author": "Kamac"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/why-not-add-max-and-min-over-hystorical-data-as-average-and-sum/", "posts": [{"date": "February 13, 2018 - 12:39 pm", "content": "Hi all,I'm wondering about the possibility to see implemented in a future api's to retrieve max and min value other than average and sumWhen you plot hystorical data as for example temperature having api for retrieve daily average is great!Anyway will be extremly useful have also api to retrieve min and max.\u00a0This let you create plot showing the daily variation.min avg max is the perfect statistic set to rapresent hystorical data series that has intrinsecally a cycle (like most environmental dfata that has daily/year cycle)Many thanks for take it in consideration!Lorenzo", "num_user_post": " 1", "author": "lorenzo.chiesi"}, {"date": "March 9, 2018 - 4:51 am", "content": "Just my thought - it would be very usefull to get also min and max, actually I was pretty surprised it isn't implemented (yet?).I don't want to put too much load on server/internet connection and also speedup display of daily/weekly/monthly data, so I download in 10/15/60min averages, but this way I miss all the 'peaks' that are somehow interesting in monitoring heat pump operation. Now if i want to know the peaks (which I do), I have to download raw data, which is a lot slower and takes more processing. In case of data stored every 15 seconds it takes 60x bandwidth to calculate min/max for every 15minutes, even 240x for hourly stats :/On the other hand when server is calculating averages/medians over the raw data set, determining min/max values too would be trivial and would take just a little bit of extra processing and practically no additional bandwidth.btw. it would be very nice to also have 5min and (maybe even 1min) timescale/average/median/sum options, because as 10min might be enough for most temperature changes, is can be too 'rough' for power and many other measurements.I really wish and hope than implementing min/max and 5min interval will be reconsidered in near future.Best Regards,DejansLOVEnia", "num_user_post": " 2", "author": "Kamac"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/configure-api-to-thingspeak-with-app-sensor-node/", "posts": [{"date": "March 5, 2018 - 4:56 am", "content": "Hi Folks,I would like to stream sensor data with the app 'sensor node' (Sensor Node)\u00a0via MQTT to Thingspeak. I use sensor node because I need the microphone output.With no programming background, I struggle a little bit to bring together what Thingspeak needs and what I can put in the configuration of the app \ud83d\ude09Thingspeak needs channel ID, API key etc. but the app allows me to fill inURL\u00a0PortuserpasswordThe url and port are clear, but where can I add the channel configuration and API key? Or will the app just not work with Thingspeak?Every help is much appreciated!ThanksMarkus", "num_user_post": " 1", "author": "Master1001"}, {"date": "March 8, 2018 - 10:50 am", "content": "I'm not sure this application will be a good match to ThingSpeak.\u00a0 If you are trying to stream real time data, the update limits may prevent you from capturing all your data.\u00a0 If the app is posting an update or a filtered response to ThingSpeak, that would match better.\u00a0\u00a0Does the Sensor Node application have a built in MQTT interface?\u00a0 If so, you will need to be able to specify the topic. That is where the channel information and API key go.\u00a0 Have a look at the MQTT API\u00a0documentation to get the correct format, especially Publish to a Channel Feed\u00a0or\u00a0Publish to a Channel Field Feed.", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/esp8266-dht-thingspeak-logger-connecting-to-api-thingspeak-com-connection-failed/", "posts": [{"date": "March 3, 2018 - 10:43 am", "content": "Having just moved, I stumbled across a Wemos D1 with a DHT11, and upon which I had flashed\u00a0Daniel Eichhorn's esp8266-dht-thingspeak-logger\u00a0(https://github.com/squix78/esp8266-dht-thingspeak-logger) a year or two ago. I fired it up last night and it logged data until early this morning.Now, for no apparent reason, it has stopped working, even though I can post the same url through a browser. Reflashing didn't seem to help. The serial monitor shows:....WiFi connectedIP address:192.168.0.168connecting to api.thingspeak.comconnection failedconnecting to api.thingspeak.comconnection failedconnecting to api.thingspeak.comconnection failedconnecting to api.thingspeak.comconnection failed[which runs indefinitely]I'll post the code below, but it is pretty much stock. I tried changing my api write key, but it didn't make any difference. Any ideas?/**The MIT License (MIT)Copyright (c) 2015 by Daniel EichhornPermission is hereby granted, free of charge, to any person obtaining a copyof this software and associated documentation files (the 'Software'), to dealin the Software without restriction, including without limitation the rightsto use, copy, modify, merge, publish, distribute, sublicense, and/or sellcopies of the Software, and to permit persons to whom the Software isfurnished to do so, subject to the following conditions:The above copyright notice and this permission notice shall be included in allcopies or substantial portions of the Software.THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS ORIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THEAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHERLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THESOFTWARE.See more at\u00a0http://blog.squix.ch*/#include <ESP8266WiFi.h>#include 'DHT.h'/***************************Begin Settings**************************/const char* ssid = '[SSID]';const char* password = '[password]';const char* host = 'api.thingspeak.com';const char* THINGSPEAK_API_KEY = '[API Write Key]';// DHT Settings#define DHTPIN D4 // what digital pin we're connected to. If you are not using NodeMCU change D6 to real pin// Uncomment whatever type you're using!#define DHTTYPE DHT11 // DHT 11//#define DHTTYPE DHT22 // DHT 22 (AM2302), AM2321//#define DHTTYPE DHT21 // DHT 21 (AM2301)const boolean IS_METRIC = true;// Update every 600 seconds = 10 minutes. Min with Thingspeak is ~20 secondsconst int UPDATE_INTERVAL_SECONDS = 300;/***************************End Settings**************************/// Initialize the temperature/ humidity sensorDHT dht(DHTPIN, DHTTYPE);void setup() {Serial.begin(115200);delay(10);// We start by connecting to a WiFi networkSerial.println();Serial.println();Serial.print('Connecting to ');Serial.println(ssid);WiFi.begin(ssid, password);while (WiFi.status() != WL_CONNECTED) {delay(500);Serial.print('.');}Serial.println('');Serial.println('WiFi connected');Serial.println('IP address: ');Serial.println(WiFi.localIP());}void loop() {Serial.print('connecting to ');Serial.println(host);// Use WiFiClient class to create TCP connectionsWiFiClient client;const int httpPort = 80;if (!client.connect(host, httpPort)) {  Serial.println('connection failed');  return;}// read values from the sensorfloat humidity = dht.readHumidity();float temperature = dht.readTemperature(!IS_METRIC);// We now create a URI for the requestString url = '/update?api_key=';url += THINGSPEAK_API_KEY;url += '&amp;field1=';url += String(temperature);url += '&amp;field2=';url += String(humidity);Serial.print('Requesting URL: ');Serial.println(url);// This will send the request to the serverclient.print(String('GET ') + url + ' HTTP/1.1' +             'Host: ' + host + '' +              'Connection: close');delay(10);while(!client.available()){  delay(100);  Serial.print('.');}// Read all the lines of the reply from server and print them to Serialwhile(client.available()){  String line = client.readStringUntil('');  Serial.print(line);}Serial.println();Serial.println('closing connection');// Go back to sleep. If your sensor is battery powered you might// want to use deep sleep heredelay(1000 * UPDATE_INTERVAL_SECONDS);}", "num_user_post": " 2", "author": "Chip Stewart"}, {"date": "March 6, 2018 - 5:09 pm", "content": "Okay . . . nevermind.\u00a0 Everything seems to be working again.", "num_user_post": " 2", "author": "Chip Stewart"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/unable-to-upload-sensor-data-from-arduino-tio-thingspeak-usiing-esp8266/", "posts": [{"date": "March 5, 2018 - 4:29 am", "content": "\u00a0Hi, I am trying to upload sensor data to thingspeak. I am using MAX31856 temperature sensor. I am receiving correct\u00a0data onserial monitor, but on thingspeak the data shown is 0. Please find the code.#include <ThingSpeak.h>#include <SPI.h>#include <Timer.h>Timer t;#include <Adafruit_MAX31856.h>#include <SoftwareSerial.h>#include <stdlib.h>SoftwareSerial Serial1(2,3);Adafruit_MAX31856 max = Adafruit_MAX31856(10);#define heart 13char *api_key = 'YM9D34LL7CJSZ9N7'; // Enter your Write API key from ThingSpeakstatic char postUrl[150];int temptc;void httpGet(String ip, String path, int port = 80);byte degree[8] = { 0b00011, 0b00011, 0b00000, 0b00000, 0b00000, 0b00000, 0b00000, 0b00000 };void setup() { Serial.begin(115200); Serial.println('MAX31856 thermocouple test');max.begin();max.setThermocoupleType(MAX31856_TCTYPE_K);Serial.print('Thermocouple type: '); switch ( max.getThermocoupleType() ) { case MAX31856_TCTYPE_B: Serial.println('B Type'); break; case MAX31856_TCTYPE_E: Serial.println('E Type'); break; case MAX31856_TCTYPE_J: Serial.println('J Type'); break; case MAX31856_TCTYPE_K: Serial.println('K Type'); break; case MAX31856_TCTYPE_N: Serial.println('N Type'); break; case MAX31856_TCTYPE_R: Serial.println('R Type'); break; case MAX31856_TCTYPE_S: Serial.println('S Type'); break; case MAX31856_TCTYPE_T: Serial.println('T Type'); break; case MAX31856_VMODE_G8: Serial.println('Voltage x8 Gain mode'); break; case MAX31856_VMODE_G32: Serial.println('Voltage x8 Gain mode'); break; default: Serial.println('Unknown'); break; } Serial1.begin(115200); Serial.begin(115200); Serial.println('Connecting Wifi....'); connect_wifi('AT', 1000); connect_wifi('AT+CWMODE=1', 1000); connect_wifi('AT+CWQAP', 1000); connect_wifi('AT+RST', 5000); connect_wifi('AT+CWJAP='Tenda_ABD7A0','sanjay@123'', 10000); Serial.println('Wifi Connected'); pinMode(heart,OUTPUT); delay(15000); t.oscillate(heart,1000,LOW); t.every(15000,send2server);}void loop() { int val = analogRead(10);//converting to degree celsius float temptc = val * 50.0f / 1023.0f; temptc = max.readThermocoupleTemperature(); Serial.println(temptc); delay(15000); t.update();}void send2server(){char temptcStr[8]; dtostrf(temptc, 5, 3, temptcStr); sprintf(postUrl,'update?api_key=YM9D34LL7CJSZ9N7&field1=0', api_key, temptcStr); httpGet('api.thingspeak.com', postUrl, 80);}//GET https://api.thingspeak.com/update?api_key=DXIE1HOCWVUCI8GH&field1=0void httpGet(String ip, String path, int port){ int resp; String atHttpGetCmd = 'GET /' + path + ' HTTP/1.0'; //AT+CIPSTART='TCP','192.168.20.200',80 String atTcpPortConnectCmd = 'AT+CIPSTART='TCP','' + ip + '',' + port + ''; connect_wifi(atTcpPortConnectCmd, 1000); int len = atHttpGetCmd.length(); String atSendCmd = 'AT+CIPSEND='; atSendCmd += len; connect_wifi(atSendCmd, 1000); connect_wifi(atHttpGetCmd, 1000);}void connect_wifi(String cmd, int t){ int temp = 0, i = 0; while (1) { Serial.println(cmd); Serial1.println(cmd); while (Serial1.available()) { if (Serial1.find('OK'))i = 8; } delay(t); if (i > 5) break; i++; } if (i == 8) { Serial.println('OK'); } else { Serial.println('Error'); }}", "num_user_post": " 1", "author": "shiva3212"}, {"date": "March 5, 2018 - 9:02 am", "content": "Have a look at the line where you construct your write string.sprintf(postUrl,'update?api_key=YM9D34LL7CJSZ9N7&field1=0', api_key, temptcStr);I would add a write to the serial monitor of postURL after this line so you can see what you are constructing.As I see it, you are constructing a line that says, 'write zero to my channel', which is what you are seeing.\u00a0See the documentation for write data to get the appropriate format.Also look over the documentation for sprintf, especially where it shows the specifier.", "num_user_post": " 401", "author": "cstapels"}]}]}