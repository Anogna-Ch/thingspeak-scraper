{"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/page-3/", "threads": [{"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/cant-connect-with-thingspeak-esp8266-01/", "posts": [{"date": "November 3, 2017 - 5:46 pm", "content": "Hi Everyone,I been trying to do a project of IOT so I want to send data to my channel in Thingspeak but I don't know how. There's a general code to do it?\u00a0I'm using ESP8266-01 and AT commands.\u00a0Could you help me, please?\u00a0Thanks!!!AiR\u00a0\u00a0Serial.print('Connecting to '); Serial.println(ssid); WiFi.begin(ssid, pass);  while (WiFi.status() != WL_CONNECTED) { delay(1000); Serial.println('.');\u00a0}\u00a0This part doesn't conect my ESP to my WiFi network. Help me please.", "num_user_post": " 1", "author": "AiR"}, {"date": "November 14, 2017 - 1:19 pm", "content": "Hi,please show us the whole code here and tell us something about your infrastructure. Did you include the necessary libraries?Try to understand the function of the libraries you use by trying the examples and then try to modify it to your wishes.\u00a0Michael", "num_user_post": " 5", "author": "beekeeper"}, {"date": "January 1, 2018 - 2:50 pm", "content": "You have not supplied enough information about your networkIf trying from home, do you have One Router or more than one?Are you using DHCP or Static IP addresses?\u00a0\u00a0 (Probably DHCP, but if you know that helps)\u00a0Does your ESP8266 show up in the list of available networks on your cellphone?Can you issue AT commands to the ESP8266 and get response 'OK' ?", "num_user_post": " 15", "author": "Piez"}]}, {"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/http-get-response-2-but-data-are-sent-properly/", "posts": [{"date": "December 27, 2017 - 2:14 pm", "content": "I need to check data are correctly handled. Now I try to get httpcode and always returns -2 but data are sent properly. The code is:if (client.connect('api.thingspeak.com',80)) { writeAPIKey = 'key=XXXXXXXXXXX'; tsfield1Name = '&field1=10'; request_string = thingSpeakAddress; request_string += 'key='; request_string += 'XXXXXXXXXXXX'; request_string += '&'; request_string += 'field5'; request_string += '='; request_string += (tempe); http.begin(request_string); http.GET(); int httpCode = http.GET(); Serial.println(httpCode); String payload = http.getString(); //Get the request response payload Serial.println(payload); http.end();I am sure something is wrong.", "num_user_post": " 3", "author": "alcapar"}, {"date": "December 28, 2017 - 9:27 pm", "content": "Perhaps you want to try modifying one of the many examples listed here:https://www.mathworks.com/help/thingspeak/examples.html", "num_user_post": " 225", "author": "Vinod"}, {"date": "December 31, 2017 - 12:50 pm", "content": "Thank you, I did it and it works.", "num_user_post": " 3", "author": "alcapar"}]}, {"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/esp-8266-wifi-not-collecting-data-from-ts/", "posts": [{"date": "December 29, 2017 - 12:10 am", "content": "My Thing Speak is attached to my ESP 8266 but no data is being recorded. I did a test on it with my public channel and it worked. However it will not update data on my current private channel. Here is the code. Any help will be appreciated!\u00a0\u00a0\u00a0#include <ESP8266WiFi.h>#include 'DHT.h'\u00a0/*************************** * Begin Settings **************************/\u00a0const char* ssid = 'WuTangLAN';const char* password = 'spranktank7664A';const char* host = 'api.thingspeak.com';const char* THINGSPEAK_API_KEY = '9DAGDL2109WC8DIJ';// DHT Settings#define DHTPIN D6 // what digital pin we're connected to. If you are not using NodeMCU change D6 to real pin\u00a0// Uncomment whatever type you're using!//#define DHTTYPE DHT11 // DHT 11#define DHTTYPE DHT22 // DHT 22 (AM2302), AM2321//#define DHTTYPE DHT21 // DHT 21 (AM2301)const boolean IS_METRIC = true;// Update every 420 seconds = 7 minutes. Min with Thingspeak is ~20 secondsconst int UPDATE_INTERVAL_SECONDS = 420;/*************************** * End Settings **************************/// Initialize the temperature/ humidity sensorDHT dht(DHTPIN, DHTTYPE);void setup() { Serial.begin(115200); delay(10);// We start by connecting to a WiFi networkSerial.println(); Serial.println(); Serial.print('Connecting to '); Serial.println(ssid); WiFi.begin(ssid, password); while (WiFi.status() != WL_CONNECTED) { delay(500); Serial.print('.'); }Serial.println(''); Serial.println('WiFi connected'); Serial.println('IP address: '); Serial.println(WiFi.localIP());}void loop() { Serial.print('connecting to '); Serial.println(host); // Use WiFiClient class to create TCP connections WiFiClient client; const int httpPort = 80; if (!client.connect(host, httpPort)) { Serial.println('connection failed'); return; }// read values from the sensor float humidity = dht.readHumidity(); float temperature = dht.readTemperature(!IS_METRIC); // We now create a URI for the request String url = '/update?api_key='; url += THINGSPEAK_API_KEY; url += '&field1='; url += String(temperature); url += '&field2='; url += String(humidity); Serial.print('Requesting URL: '); Serial.println(url); // This will send the request to the server client.print(String('GET ') + url + ' HTTP/1.1' + 'Host: ' + host + '' + 'Connection: close'); delay(10); while(!client.available()){ delay(100); Serial.print('.'); } // Read all the lines of the reply from server and print them to Serial while(client.available()){ String line = client.readStringUntil(''); Serial.print(line); } Serial.println(); Serial.println('closing connection');\u00a0// Go back to sleep. If your sensor is battery powered you might // want to use deep sleep here delay(1000 * UPDATE_INTERVAL_SECONDS);}", "num_user_post": " 8", "author": "ashebray"}, {"date": "December 29, 2017 - 10:56 am", "content": "I think the order of your commands is wrong.\u00a0 You are printing the GET verb after you provide the address.\u00a0 Have a look at the soil moisture example in the doc.\u00a0 It uses POST instead of GET, but the process is similar.\u00a0 Let us know if you get it going.", "num_user_post": " 401", "author": "cstapels"}, {"date": "December 30, 2017 - 9:40 pm", "content": "cstapels said  I think the order of your commands is wrong.\u00a0 You are printing the GET verb after you provide the address.\u00a0 Have a look at the soil moisture example in the doc.\u00a0 It uses POST instead of GET, but the process is similar.\u00a0 Let us know if you get it going.\u00a0\u00a0How do I change the order? Or change from GET to POST? Sorry for the questions, I'm just having a rough time with this!", "num_user_post": " 8", "author": "ashebray"}]}, {"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/support-for-esp32-added-to-thingspeak-library/", "posts": [{"date": "December 13, 2017 - 2:17 pm", "content": "There is a new release of the ThingSpeak Client Libraries for Arduino that adds support for ESP32.The new v1.3.3 release and is accessible from github or through the Arduino IDE library manager.In order to make it work, the Arduino Core for ESP32 will need to be installed.\u00a0 Some installation instruction can be found here.", "num_user_post": " 34", "author": "JasonW"}]}, {"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/esp32-library/", "posts": [{"date": "November 14, 2017 - 1:06 pm", "content": "Hi,is there any ARDUINO-library working fine with the ESP32 Development-board? I would like to change a Arduino MKR1000 (everything works fine) by using a ESP32. Now uploading the sketch aborts with message 'Platform not supported' .Thanks for your replies.Michael", "num_user_post": " 5", "author": "beekeeper"}, {"date": "November 14, 2017 - 1:56 pm", "content": "Check out the instructions on the ThingSpeak examples page for the ESP32 WIFi monitor.\u00a0 I've used those instructions to program my ESP32 dev board with Arduino.", "num_user_post": " 401", "author": "cstapels"}, {"date": "December 13, 2017 - 2:10 pm", "content": "The latest release (1.3.3) of the ThingSpeak Client Libraries adds support for ESP32.\u00a0\u00a0The ESP32 Arduino Core will need to be installed to make it work.\u00a0 Some installation instruction can be found here.", "num_user_post": " 34", "author": "JasonW"}]}, {"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/esp8266-comunicating-to-thingspeak/", "posts": [{"date": "December 10, 2017 - 9:48 am", "content": "I'm trying to via WiFi internet router update a ThingSpeak channel by posting a feed with HTTP POST. I just try ESP8266 to generate numbers a and load them into a graph. I get answer 200 OK, however, nothing appears in the graph. Problem is in strings to send or where else?Answer on Serial monitor:HTTP/1.1 200 OKContent-Type: text/html; charset=utf-8Content-Length: 1Connection: closeStatus: 200 OKX-Frame-Options: ALLOWALLAccess-Control-Allow-Origin: *Access-Control-Allow-Methods: GET, POST, PUT, OPTIONS, DELETE, PATCHAccess-Control-Allow-Headers: origin, content-type, X-Requested-WithAccess-Control-Max-Age: 1800ETag: '5ef059938ba799aaa845e1c2e8a762bd'Cache-Control: max-age=0, private, must-revalidateSet-Cookie: request_method=POST; path=/X-Request-Id: a7d6719b-d8c3-4f5e-9039-b13f44d6050eX-Runtime: 0.190082X-Powered-By: Phusion Passenger 4.0.57Date: Sun, 10 Dec 2017 14:21:03 GMTServer: nginx/1.9.3 + Phusion Passenger 4.0.57\u00a01..disconnected\u00a0code part:\u00a0void loop() {if (client.available()){char c=client.read();Serial.print(c);}if (!client.connected()&&lastConnected){Serial.println('..disconnected');Serial.println();client.stop();}if (!client.connected()&&(millis()-lastConnectionTime>updateThingSpeakInterval)) {String data='field1=';data+=a;if (client.connect(thingSpeakAddress,80)) {client.print('POST /update HTTP/1.1');client.print('Host: api.thingspeak.com');client.print('Connection: close');client.print('X-THINGSPEAKAPIKEY:' +APIKey+ '');client.print('Content-Type: application/x-ww-form-urlencoded');client.print('Content-Lenght:');client.print(data.length());client.print('');client.print(data);Serial.print('data:');Serial.println(data);lastConnectionTime=millis();if (client.connected()) {Serial.println('Connecting to ThingSpeak...');}}a+=1;} lastConnected=client.connected();}\u00a0Any help would be great.\u00a0", "num_user_post": " 4", "author": "Diena"}, {"date": "December 11, 2017 - 8:36 am", "content": "One thing I noticed is that you have a small error in one of your HTTP headers.\u00a0 You have the word Length spelled as\u00a0 'Lenght', I'm not sure if that would cause the problem.Is it possible for you to share you channel ID, or share the channel privately with me (my user name\u00a0 <at> mathworks.com)?\u00a0\u00a0", "num_user_post": " 401", "author": "cstapels"}, {"date": "December 11, 2017 - 12:50 pm", "content": "My channel ID 375555.\u00a0I am correcting the word, but there are still no positive changes. By the way thingspeak account my entries, but nothing in graf.", "num_user_post": " 4", "author": "Diena"}, {"date": "December 11, 2017 - 2:06 pm", "content": "Can you show the serial output for this line?\u00a0\u00a0Serial.print('data:');Perhaps that will show what is happening to the data.\u00a0Your channel is private, so I cannot see the data.\u00a0 You can share it with me privately using the sharing tab if this is possible for you to share your information.\u00a0You could also consider using the ThingSpeak Communication Library for Arduino and ESP8266.\u00a0 If you are interested, have a look at the temperature posting example for ESP8266.You may also have a look at the Soil Monitor example \u00a0This example uses the client directly like you are and does not use the ThingSpeak communication library.", "num_user_post": " 401", "author": "cstapels"}, {"date": "December 11, 2017 - 3:50 pm", "content": "You may also want to look at the chart options.\u00a0 Press the pencil on the upper right of your field 1 chart and make sure that you don't have any averaging or change in time scale settings on.\u00a0 Also make sure there aren't modifications to the axis limits.\u00a0 These settings may make your data not appear on the chart.", "num_user_post": " 401", "author": "cstapels"}, {"date": "December 12, 2017 - 2:18 am", "content": "No problem, I share chanel with you.Serial output, data:&field1=0, next, data:&field1=1 ...I try with '&' and without, no positive change.my feeling that it's really something with a scale or other parameter of interpretation, but I do not really understand exactly what it is.In chart options. Only 4 parameters: Color:#d62020, Bacground:#ffffff, type:line, Dinamic?:true.Any ideas?", "num_user_post": " 4", "author": "Diena"}, {"date": "December 12, 2017 - 8:50 am", "content": "Thank you very much for the cooperation. It was felt that this had almost happened, but some inaccuracies prevented understanding the problem.Cstapels, thanks to your attention, I discovered another inaccuracy and everything is happening.It turns out that the error in the content type queue is more relevant than the content length error.One w came out.Best regards!", "num_user_post": " 4", "author": "Diena"}]}, {"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/bad-request-400/", "posts": [{"date": "December 8, 2017 - 5:37 am", "content": "Hello , i use a WeMos D1 mini with a BME280 on my channel . It has worked with this sketch , but now i get bad request 400 . What went wrong ??\u00a0\u00a0#include <BME280_MOD-1022.h>#include <Wire.h>// Wifi and ThingSpeak settings#include <ESP8266WiFi.h>const char* ssid = 'XXXXXX';const char* password = 'XXXXXXXXX';const char* server = 'api.thingspeak.com';const char* api_key = 'DFFSB76BCWGXXXX';// Measurement interval (seconds)const int interval = 300; //5 mins#define LED D4WiFiClient client;void printFormattedFloat(float x, uint8_t precision) {char buffer[10];dtostrf(x, 7, precision, buffer); Serial.print(buffer);}void printCompensatedMeasurements(void) {float temp, humidity, pressure, pressureMoreAccurate;double tempMostAccurate, humidityMostAccurate, pressureMostAccurate;char buffer[80];temp = BME280.getTemperature(); humidity = BME280.getHumidity(); pressure = BME280.getPressure(); pressureMoreAccurate = BME280.getPressureMoreAccurate(); // t_fine already calculated from getTemperaure() above tempMostAccurate = BME280.getTemperatureMostAccurate(); humidityMostAccurate = BME280.getHumidityMostAccurate(); pressureMostAccurate = BME280.getPressureMostAccurate(); Serial.print('Temperature: '); printFormattedFloat(tempMostAccurate, 2); Serial.println(); Serial.print('Humidity: '); printFormattedFloat(humidityMostAccurate, 2); Serial.println();Serial.print('Pressure: '); printFormattedFloat(pressureMostAccurate, 2); Serial.println();// Post data to ThingSpeak postData(tempMostAccurate, humidityMostAccurate, pressureMostAccurate); Serial.println();}void postData(float temperature, float humidity, float pressure){ // Send data to ThingSpeak if (client.connect(server,80)) { Serial.println('Connect to ThingSpeak - OK');String dataToThingSpeak = ''; dataToThingSpeak+='GET /update?api_key='; dataToThingSpeak+=api_key; dataToThingSpeak+='&field1='; dataToThingSpeak+=String(temperature);dataToThingSpeak+='&field2='; dataToThingSpeak+=String(humidity);dataToThingSpeak+='&field3='; dataToThingSpeak+=String(pressure); dataToThingSpeak+=' HTTP/1.1Host: a.c.dConnection: close'; dataToThingSpeak+=''; client.print(dataToThingSpeak);int timeout = millis() + 5000; while (client.available() == 0) { if (timeout - millis() < 0) { Serial.println('Error: Client Timeout!'); client.stop(); return; } }} while(client.available()){ String line = client.readStringUntil(''); Serial.print(line); }}\u00a0// Setup wire and serialvoid setup(){ Wire.begin(); Serial.begin(115200); pinMode(LED, OUTPUT); delay(10); Serial.println('Connecting to wifi...'); WiFi.begin(ssid, password);while (WiFi.status() != WL_CONNECTED){ // Blink LED when connecting to wifi digitalWrite(LED, LOW); delay(250); digitalWrite(LED, HIGH); delay(250); } Serial.println('WiFi connected');// Prepare LED to turn on when measuring and send data}// main loopvoid loop(){ // need to read the NVM compensation parameters BME280.readCompensationParams();// We'll switch into normal mode for regular automatic samples BME280.writeStandbyTime(tsb_0p5ms); // tsb = 0.5ms BME280.writeFilterCoefficient(fc_16); // IIR Filter coefficient 16 BME280.writeOversamplingPressure(os16x); // pressure x16 BME280.writeOversamplingTemperature(os2x); // temperature x2 BME280.writeOversamplingHumidity(os1x); // humidity x1 BME280.writeMode(smNormal); while (1) { //digitalWrite(LED, LOW); while (BME280.isMeasuring()) { //Serial.println('Measuring...'); //delay(100); } // read out the data - must do this before calling the getxxxxx routines BME280.readMeasurements(); printCompensatedMeasurements(); // digitalWrite(LED, HIGH); delay(interval*1000); Serial.println(); }}", "num_user_post": " 1", "author": "Bulldogbob"}, {"date": "December 11, 2017 - 9:08 am", "content": "Can you look at the output that is generated from 'client.print(dataToThingSpeak);'\u00a0 You could add a Serial.println(dataToThingSpeak); and then copy and paste that line to the address bar in your browser (don't forget to delete the 'GET').\u00a0 This might help show why it is failing. Can you post it here?", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/can-i-use-two-esp8266-on-one-arduino-unoxbee-s2c-to-sending-sensor-data-to-thingspeak/", "posts": [{"date": "December 8, 2017 - 9:51 am", "content": "hi all,I use 4 XBee for temperature monitoring using cluster tree. Two XBee+Arduino as end devices so they send temperature data (I use LM35) to another XBee+Arduino as router, and then the router send the receive data from two end devices to the last XBee+Arduino as coordinator (2 end devices -> 1 router -> 1 coordinator). So, can I use two ESP8266 for sending the temperature data on one coordinator to separate them as Field1 and Field2? Or there is another way to show them to Thingspeak?So far, I can show the data to Thingspeak from 1 end device although the data is not correct but it can connect to Thingspeak (1 end device -> 1 router -> 1 coordinator).I'm new to this and not really good in english so sorry if i made some mistakes. Thankyou so much the Arduino code://for end device 1int temp;int tempPin = 0;void setup(){Serial.begin(115200);}void loop(){temp = analogRead(tempPin);temp = (temp * 0.48820125);Serial.print(temp);delay(3000);}--------------------------------------------------------------------//for routerint incomingByte=0;void setup() { Serial.begin(115200);}void loop() { while(Serial.available()>0){ incomingByte = Serial.read(); Serial.print(incomingByte); }}--------------------------------------------------------------------//for server#include <SoftwareSerial.h>#include <stdlib.h>int incomingByte = 0;String apiKey = 'X4QOYQUT5ZN1OZ58';SoftwareSerial ser(10,11); void setup() { Serial.begin(115200); ser.begin(115200);}void loop() { while (Serial.available() > 0) { incomingByte = Serial.read(); char buf[16]; String strtemp = dtostrf(incomingByte,5,1,buf); Serial.print(strtemp); String cmd = 'AT+CIPSTART='TCP',''; cmd += '184.106.153.149'; // api.thingspeak.com cmd += '',80'; ser.println(cmd);if(ser.find('Error')){ Serial.println('AT+CIPSTART error'); return; }String getStr = 'GET /update?api_key='; getStr += apiKey; getStr += '&field1='; getStr += String(strtemp); getStr += '';cmd = 'AT+CIPSEND='; cmd += String(getStr.length()); ser.println(cmd); if(ser.find('>')){ ser.print(getStr); } else{ ser.println('AT+CIPCLOSE'); Serial.println('AT+CIPCLOSE'); } }}", "num_user_post": " 1", "author": "valenciaa"}]}, {"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/need-some-help-regarding-esp8266-thingspeak/", "posts": [{"date": "December 2, 2017 - 1:18 am", "content": "I'm using ESP8266 as WiFi cloud posting device for my sensor nodes.Taking data from a sensor node via UART (Software UART) -> Get Timestamp from RTC -> Store that data into SD card -> On regular time interval Post collected data to Thingspeak using Bulk Data update API.Issue I'm facing is while ESP8266 posting data to Thingspeak it remains busy to get back the response from thingspeak for successful posting. It takes 6 - 8 seconds normally and sometimes if internet is down it takes 25 - 30 seconds.So during this time, ESP8266 not able to get data from Sensor node via UART.Is there any way to get data via UART during the time of posting also???I'm usingArduino IDENodeMCU as ESP8266 boardThingspeak REST API bulk updateUART communication between sensor node and ESP8266Any other alternative way is also acceptable like instead of using UART, use SPI.", "num_user_post": " 2", "author": "deep_kap"}, {"date": "December 3, 2017 - 8:42 pm", "content": "If you post the code you are now using for the upload you may get more help in improving it.\u00a0 In my experience most of the wifi upload time is spent waiting for the network or the other end so it may well be possible to go on collecting data in the meantime, if you have the right code.", "num_user_post": " 271", "author": "rw950431"}, {"date": "December 7, 2017 - 1:02 am", "content": "rw950431 said If you post the code you are now using for the upload you may get more help in improving it.\u00a0 In my experience most of the wifi upload time is spent waiting for the network or the other end so it may well be possible to go on collecting data in the meantime, if you have the right code.\u00a0\u00a0Here is the part of code that post the data.\u00a0client.stop();String data_length = String(http_data.length() + 1);if (client.connect(server, 80)){String temp_buffer = const_http_header + data_length;client.println(temp_buffer); client.println(); client.println(http_data);}else{Serial.println('Failure: Failed to connect to ThingSpeak');}delay(250);client.parseFloat();String resp = String(client.parseInt());if(resp == '202'){Serial.println('Posted Successfully');}else{Serial.println('Error in posting');Serial.println('Error : ' + resp);}", "num_user_post": " 2", "author": "deep_kap"}, {"date": "December 7, 2017 - 6:24 pm", "content": "There is discussion about problems similar to yours at https://github.com/esp8266/Arduino/issues/1420", "num_user_post": " 271", "author": "rw950431"}]}, {"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/extraer-datos-de-thingspeak-sin-utilizar-libreria/", "posts": [{"date": "November 13, 2017 - 5:54 pm", "content": "Buenas tardes, quisiera saber como hacer para extraer o bajar datos de un canal de thingspeak sin necesidad de utilizar su librer\u00eda. Este es el c\u00f3digo que llevo por ahora. Les agradezco su colaboraci\u00f3n.\u00a0#include <ESP8266WiFi.h>\u00a0String apiKey = 'MMRSR6BEWE7CZ26Z';const char *ssid = '--------';const char *pass = '++++++++';const char* host = 'api.thingspeak.com';void setup(){Serial.begin(9600); Serial.println('Connecting to '); Serial.println(ssid); WiFi.begin(ssid, pass); while (WiFi.status() != WL_CONNECTED) { delay(500); Serial.print('.'); } Serial.println(''); Serial.println('WiFi connected');}void loop(){ WiFiClient client_1; //Inicializamos el cliente (client_1) Serial.printf('[Conectando a %s ... ', host); //Establecemos la conexi\u00f3n con el servidor if (client_1.connect(host, 80)) { Serial.println('conectado]'); Serial.println('[Enviando peticion]'); //Enviamos la petici\u00f3n de datos client_1.print(String('GET /') + ' HTTP/1.1' + 'Host: ' + host + '' + 'Connection: close' + '' ); Serial.println('[Respuesta:]'); //Leemos la respuesta del servidor while (client_1.connected()) { if (client_1.available()) { Serial.println(client_1.read()); Serial.println('-------------------------------------------'); delay(5000); } } client_1.stop(); //Finalizamos la conexi\u00f3n con el servidor Serial.println('[Desconectado]'); } else { Serial.println('conexion con el servidor no lograda!]'); client_1.stop(); } delay(10000);}", "num_user_post": " 1", "author": "Sergio_Tolosa"}, {"date": "November 14, 2017 - 3:24 pm", "content": "El ejemplo del monitor de suelo muestra c\u00f3mo enviar datos sin la biblioteca.Puede ver la sintaxis correcta para que GET recupere datos en Obtener un canal de informaci\u00f3n.Parece que te perdiste el texto de la solicitud en el c\u00f3digo anterior.'\u00a0GET to\u00a0https://api.thingspeak.com/channels/CHANNEL_ID/feeds'Aqu\u00ed hay un fragmento que podr\u00eda ayudar:if (client.connect(thingSpeakAddress, 80)) {\u00a0 \u00a0 client.println('GET /channels/'+tsChannel+tsFolder+tsField+'/last.txt');\u00a0 \u00a0 client.println();} else {\u00a0 failedCounter++;\u00a0 \u00a0 lastConnectionTime = millis(); } delay(500); String response; char charIn; do { charIn = client.read(); // read a char from the buffer response += charIn; // append that char to the string response } while (client.available() > 0);client.stop();\u00a0The soil monitor example shows how to send data without the library.\u00a0You can see the correct syntax for the GET to retrieve data on Get a Channel Feed.\u00a0It looks like you missed the text of the request in the code above.'\u00a0GET to\u00a0https://api.thingspeak.com/channels/CHANNEL_ID/feeds'Here is a snippet that might help:if (client.connect(thingSpeakAddress, 80)) {\u00a0 \u00a0 client.println('GET /channels/'+tsChannel+tsFolder+tsField+'/last.txt');\u00a0 \u00a0 client.println();} else {\u00a0 failedCounter++;\u00a0 \u00a0 lastConnectionTime = millis(); } delay(500); String response; char charIn; do { charIn = client.read(); // read a char from the buffer response += charIn; // append that char to the string response } while (client.available() > 0);client.stop();Hope the Spanish is ok.\u00a0 I used Google translate but checked it with my Spanish immersion student son.\u00a0 I think he is going to charge me for the service.", "num_user_post": " 401", "author": "cstapels"}, {"date": "December 5, 2017 - 9:01 am", "content": "The\u00a0soil monitor example\u00a0shows how to\u00a0send\u00a0data without the library.\u00a0You can see the correct syntax for the GET to\u00a0retrieve\u00a0data on\u00a0Get a Channel Feed.\u00a0It looks like you missed the text of the request in the code above.'\u00a0GET to\u00a0https://api.thingspeak.com/channels/CHANNEL_ID/feeds'\u00a0Here is a snippet that might help:if (client.connect(thingSpeakAddress, 80)){\u00a0 \u00a0 client.println('GET /channels/'+tsChannel+tsFolder+tsField+'/last.txt');\u00a0 \u00a0 client.println();}else{\u00a0 failedCounter++;\u00a0 \u00a0 lastConnectionTime = millis();}delay(500);String response;char charIn;do {charIn = client.read(); // read a char from the bufferresponse += charIn; // append that char to the string response}while (client.available() > 0);client.stop();", "num_user_post": " 401", "author": "cstapels"}]}, {"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/cant-access-192-168-4-1-ip/", "posts": [{"date": "October 30, 2017 - 9:45 am", "content": "Dear all member!I've finished a project Mega2560 & esp8266, esp8266's like picture. I used Sky phone & Asus phone to access in wifi, then accessed in 192.168.4.1 IP by Chrome okey! But when I used Iphone & Samsung phone, I just only accessed in wifi ok, then I couldn't access in 192.168.4.1 IP by Safari of Iphone & Chrome of Samsung. Please help me for accessing in 192.168.4.1 IP ok with all type of smart phone! Thank you.", "num_user_post": " 1", "author": "duydt2"}, {"date": "November 14, 2017 - 1:23 pm", "content": "Are you using the same WIFI-Access, or are you using the mobile-data-function of your smartphone?", "num_user_post": " 5", "author": "beekeeper"}]}, {"url": "https://community.thingspeak.com/forum/esp8266-wi-fi/try-to-read-a-temperature-and-humidity-sensor-si7020-using-i2c-on-the-esp32/", "posts": [{"date": "November 13, 2017 - 3:27 am", "content": "I am trying to read a temperature and humidity sensor (SI7020:http://www.kynix.com/Parts/2489506/SI7020-A10-GM.html) using I2C on the ESP32.I modified their example code to read just from one slave device (0x40) but some commands do not work. I tried resetting the device with 0xFE as well.I can read the device ID (0xFA):*******************TASK[0] MASTER READ SENSOR( SI7020 )*******************data_h: 48data_l: 52sensor val: 15428.333333However if I try and read the temperature (0xE3), I get:data_h: 00data_l: 00If I use 0xE0 I always get:data_h: 39data_l: 9fWhy am I not able to read the temperature from SI7020?The code I'm using:#include <stdio.h>#include 'driver/i2c.h'\u00a0#define DATA_LENGTH 512 /*!<Data buffer length for test buffer*/#define RW_TEST_LENGTH 127 /*!<Data length for r/w test, any value from 0-DATA_LENGTH*/#define DELAY_TIME_BETWEEN_ITEMS_MS 2000 /*!< delay time between different test items */#define I2C_EXAMPLE_MASTER_SCL_IO 19 /*!< gpio number for I2C master clock */#define I2C_EXAMPLE_MASTER_SDA_IO 18 /*!< gpio number for I2C master data */#define I2C_EXAMPLE_MASTER_NUM I2C_NUM_1 /*!< I2C port number for master dev */#define I2C_EXAMPLE_MASTER_TX_BUF_DISABLE 0 /*!< I2C master do not need buffer */#define I2C_EXAMPLE_MASTER_RX_BUF_DISABLE 0 /*!< I2C master do not need buffer */#define I2C_EXAMPLE_MASTER_FREQ_HZ 100000 /*!< I2C master clock frequency */#define SI7020_SENSOR_ADDR 0x40 /*!< slave address for SI7020 sensor */#define SI7020_CMD_READ 0xE0 /*!< Command to set measure mode *///#define ESP_SLAVE_ADDR 0x28 /*!< ESP32 slave address, you can set any 7bit value */#define WRITE_BIT I2C_MASTER_WRITE /*!< I2C master write */#define READ_BIT I2C_MASTER_READ /*!< I2C master read */#define ACK_CHECK_EN 0x1 /*!< I2C master will check ack from slave*/#define ACK_CHECK_DIS 0x0 /*!< I2C master will not check ack from slave */#define ACK_VAL 0x0 /*!< I2C ack value */#define NACK_VAL 0x1 /*!< I2C nack value */xSemaphoreHandle print_mux;/** * @brief test code to write esp-i2c-slave * * 1. set mode * _________________________________________________________________ * | start | slave_addr + wr_bit + ack | write 1 byte + ack | stop | * --------|---------------------------|---------------------|------| * 2. wait more than 24 ms * 3. read data * ______________________________________________________________________________________ * | start | slave_addr + rd_bit + ack | read 1 byte + ack | read 1 byte + nack | stop | * --------|---------------------------|--------------------|--------------------|------| */static esp_err_t i2c_example_master_sensor_test(i2c_port_t i2c_num, uint8_t* data_h, uint8_t* data_l){ i2c_cmd_handle_t cmd = i2c_cmd_link_create(); i2c_master_start(cmd); i2c_master_write_byte(cmd, SI7020_SENSOR_ADDR << 1 | WRITE_BIT, ACK_CHECK_DIS); i2c_master_write_byte(cmd, SI7020_CMD_READ, ACK_CHECK_EN); i2c_master_stop(cmd); int ret = i2c_master_cmd_begin(i2c_num, cmd, 1000 / portTICK_RATE_MS); i2c_cmd_link_delete(cmd); if (ret == ESP_FAIL) { return ret; } vTaskDelay(1000 / portTICK_RATE_MS);cmd = i2c_cmd_link_create(); i2c_master_start(cmd); i2c_master_write_byte(cmd, SI7020_SENSOR_ADDR << 1 | READ_BIT, ACK_CHECK_DIS); i2c_master_read_byte(cmd, data_h, ACK_VAL); i2c_master_read_byte(cmd, data_l, NACK_VAL); i2c_master_stop(cmd); ret = i2c_master_cmd_begin(i2c_num, cmd, 1000 / portTICK_RATE_MS); i2c_cmd_link_delete(cmd); if (ret == ESP_FAIL) { return ESP_FAIL; } return ESP_OK;}/** * @brief i2c master initialization */static void i2c_example_master_init(){ int i2c_master_port = I2C_EXAMPLE_MASTER_NUM; i2c_config_t conf; conf.mode = I2C_MODE_MASTER; conf.sda_io_num = I2C_EXAMPLE_MASTER_SDA_IO; conf.sda_pullup_en = GPIO_PULLUP_ENABLE; conf.scl_io_num = I2C_EXAMPLE_MASTER_SCL_IO; conf.scl_pullup_en = GPIO_PULLUP_ENABLE; conf.master.clk_speed = I2C_EXAMPLE_MASTER_FREQ_HZ; i2c_param_config(i2c_master_port, &conf); i2c_driver_install(i2c_master_port, conf.mode, I2C_EXAMPLE_MASTER_RX_BUF_DISABLE, I2C_EXAMPLE_MASTER_TX_BUF_DISABLE, 0);}static void i2c_test_task(void* arg){ int i = 0; int ret; uint32_t task_idx = (uint32_t) arg; uint8_t* data = (uint8_t*) malloc(DATA_LENGTH); uint8_t sensor_data_h, sensor_data_l;while (1) { ret = i2c_example_master_sensor_test( I2C_EXAMPLE_MASTER_NUM, &sensor_data_h, &sensor_data_l); xSemaphoreTake(print_mux, portMAX_DELAY); printf('*******************'); printf('TASK[%d] MASTER READ SENSOR( SI7020 )', task_idx); printf('*******************'); if (ret == ESP_OK) { printf('data_h: %02x', sensor_data_h); printf('data_l: %02x', sensor_data_l); printf('sensor val: %f', ( sensor_data_h << 8 | sensor_data_l ) / 1.2); } else { printf('No ack, sensor not connected...skip...'); } xSemaphoreGive(print_mux); vTaskDelay(( DELAY_TIME_BETWEEN_ITEMS_MS * ( task_idx + 1 ) ) / portTICK_RATE_MS);//--------------------------------------------------- for (i = 0; i < DATA_LENGTH; i++) { data[i] = i; } }}void app_main(){ print_mux = xSemaphoreCreateMutex(); //i2c_example_slave_init(); i2c_example_master_init();xTaskCreate(i2c_test_task, 'i2c_test_task_0', 1024 * 2, (void* ) 0, 10, NULL); //xTaskCreate(i2c_test_task, 'i2c_test_task_1', 1024 * 2, (void* ) 1, 10, NULL);}\u00a0Can anyone help me out?Thanks!", "num_user_post": " 2", "author": "Linaa"}]}]}