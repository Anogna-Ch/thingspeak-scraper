{"url": "https://community.thingspeak.com/forum/thingspeak-api/page-17/", "threads": [{"url": "https://community.thingspeak.com/forum/thingspeak-api/electric-imp/", "posts": [{"date": "July 29, 2013 - 1:47 pm", "content": "Hi, I'm delighted to find thingSpeak. I'm still digging into what it can do.I checked over the forums for anybody who might have done an ElectricImp.com interface & couldn't see one.Here is what I've found works. Be delighted on better ways of making it work.I'm playing with the EI with a coupleof other people for a Particle Dust monitor. Something using a Shinyei PPD42 and then exploring what sort of data it collects.https://www.thingspeak.com/channels/6855#The EI IMP001 is a low cost  device on an SD card format that has 6 pins one end and WiFi the other end. Its not open source, but is being developed as industrial strength and scale-able. It has programs developed on an EI cloud interface in 'Squirrel'  (like python) to be loaded into the device (IMP001) and agent. The device has the WiFi/internet stack, assumes a WiFi local agent and is setup with a smartphone app. Once the device is active it communicates with the agent in the cloud.  Once connected, the device can be used to manage the hardware interface and the agent is used to interface to the internet - say ThingSpeak.So the agent(internet) side that writes to a ThingSpeak channel is// ThingSpeak account credentialsconst TsApiWriteKey = 'xxxxyyy'const TsChannelId = 'cccc' //Not needed for a write// Class for reading/writing a feed at thingspeak.comclass TsFeed {  static url = 'http://api.thingspeak.com/update'  wrApiKey = null  feedID = null  constructor(wrApiKey, feedID) {    this.wrApiKey = wrApiKey    this.feedID = feedID  }  // Send data to feed, expects a table with channel:value pairs  function push(data, callback) {//TsFeed    local datastreamTs = []     foreach(channel, value in data) {      //server.log('TsPush: '+channel+'='+value)      datastreamTs +=  '&'+channel + '=' + value    }    local postHeaders = {        'Host': 'api.thingspeak.com',        'Connection': 'close',        'X-THINGSPEAKAPIKEY': wrApiKey,        'Content-type': 'application/x-www-form-urlencoded' }    //server.log(format('%s',datastreamTs))    http.post(url , postHeaders, datastreamTs).sendasync(callback)  }}//end TsFeed//Handles the response from the asyn Post to serverfunction onUpdateTs(res) {    if (200 != res.statuscode) server.log('AgtResultTsFail: ' + res.statuscode )}// Handler for updates from devicedevice.on('putPsTs', function(data) {  //server.log('AgtPutTs: ' + http.jsonencode(data))  feedTs.push(data, onUpdateTs)})// Create feed objectfeedTs <- TsFeed(TsApiWriteKey, TsChannelId)//EOF --------------------------------------------------On the  device side the code to create an event 'putPsTs' to push it to the agent  is -   agent.send('putPsTs',{       'field5': concentration      ,'field4': pulselong      ,'field3': pulseshort      ,'field2': particle1min_cnt      ,'field1': ratioMin_per    });---------------------------------------", "num_user_post": " 3", "author": "neilh"}, {"date": "January 12, 2017 - 11:54 am", "content": "It's a little late, but I want to thank you for this post.\u00a0 It really helped me out today.\u00a0Thanks again!G", "num_user_post": " 4", "author": "glynnbebee"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/multiple-temps-in-one-message-help-please/", "posts": [{"date": "January 4, 2017 - 12:45 pm", "content": "Wondering if anyone has a minute and can tell me how to modify this code to send multiple temperatures to Thingspeak?I have working the Electric Imp code to send 1 temperature, but have not been able to modify it to send 6 temperatures.\u00a0 The temperatures are stored in an array.\u00a0 I'm getting datapoint.temp[1] through to Thingspeak, but don't know how I would also send in the same message datapoint.temp[0], datapoint.temp[2], datapoint.temp[3] and datapoint.temp[5].\u00a0The Device Code I have now is:local datapoint = { \u00a0\u00a0\u00a0 'id' : id, \u00a0\u00a0\u00a0 'temp' : [ format('%.2f',myThermistor0.read_f()), \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 format('%.2f',myThermistor1.read_f()), \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 format('%.2f',myThermistor2.read_f()), \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 format('%.2f',myThermistor3.read_f()), \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 format('%.2f',myThermistor4.read_f()), \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 format('%.2f',myThermistor5.read_f()),] }agent.send('thing1', datapoint.temp[1]);\u00a0The Agent Code (online Web-IDE) I have now is:local thingSpeakUrl = 'http://api.thingspeak.com/update'; local headers = { \u00a0 'Content-Type' : 'application/x-www-form-urlencoded', \u00a0 'X-THINGSPEAKAPIKEY' : 'MY KEY IS HERE' }; local field = 'field1'; function httpPostToThingSpeak (data) { \u00a0 local request = http.post(thingSpeakUrl, headers, data); \u00a0 local response = request.sendsync(); \u00a0 return response; } device.on('thing1', function(analog_value) { \u00a0 local response =\u00a0 httpPostToThingSpeak(field+'='+analog_value); \u00a0 server.log('House Temp Samples: ' + response.body); });\u00a0Thanks in advance for pointers on how to proceed.G", "num_user_post": " 4", "author": "glynnbebee"}, {"date": "January 12, 2017 - 10:14 am", "content": "I'm still working on this and all ears.\u00a0 Focusing on just 2 temps in one message for now.\u00a0 What I did get working was this (again, where 'datapoint' is an array of 7 temperatures)Device//Thingspeak temp0 - Field 1agent.send('thingtemp0', datapoint);imp.sleep(20);//Thingspeak temp1 - Field 2agent.send('thingtemp1', datapoint);Agentlocal channel = 'XA6D1INCQFWNDMK5'local thingSpeakUrl = 'http://api.thingspeak.com/update';local headers = {\u00a0 'Content-Type' : 'application/x-www-form-urlencoded',\u00a0 'X-THINGSPEAKAPIKEY' : 'XA6D1INCQFWNDMK5'};local field1 = 'field1';function httpPostToThingSpeak (data) {\u00a0 local request = http.post(thingSpeakUrl, headers, data);\u00a0 local response = request.sendsync();\u00a0 return response;}device.on('thingtemp0', function(datapoint) {local response =\u00a0 httpPostToThingSpeak(field1+'='+datapoint.temp[0]);server.log('Thingspeak Channel '+ channel + ' feed 1 ' + response.body);});// -local field2 = 'field2';function httpPostToThingSpeak (data) {\u00a0 local request = http.post(thingSpeakUrl, headers, data);\u00a0 local response = request.sendsync();\u00a0 return response;}device.on('thingtemp1', function(datapoint) {local response =\u00a0 httpPostToThingSpeak(field2+'='+datapoint.temp[1]);server.log('Thingspeak Channel entries: ' + response.body);});\u00a0What I thought would work is something like below, but the '&' operator isn't working.\u00a0 The code checks out ok in the Electric Imp IDE and uploads to the Imp, but the agent side returns an error:Error: bitwise op between 'string' and 'string'\u00a0Device//Thingspeak code all temps at onceagent.send('thingtemp', datapoint);Agentlocal channel = 'XA6D1INCQFWNDMK5'local thingSpeakUrl = 'http://api.thingspeak.com/update';local headers = {\u00a0 'Content-Type' : 'application/x-www-form-urlencoded',\u00a0 'X-THINGSPEAKAPIKEY' : 'XA6D1INCQFWNDMK5'};local field1 = 'field1';local field2 = 'field2';local field3 = 'field3';local field4 = 'field4';local field5 = 'field5';local field6 = 'field6';local field7 = 'field7';function httpPostToThingSpeak (data) {\u00a0 local request = http.post(thingSpeakUrl, headers, data);\u00a0 local response = request.sendsync();\u00a0 return response;}device.on('thingtemp', function(datapoint) {local response =\u00a0 httpPostToThingSpeak(field1+'='+datapoint.temp[0]&field2+'='+datapoint.temp[1]);});", "num_user_post": " 4", "author": "glynnbebee"}, {"date": "January 12, 2017 - 11:39 am", "content": "Nevermind!\u00a0 I got it.\u00a0 The answer was here all along.http://community.thingspeak.com/forum/thingspeak-api/electric-imp/#p669\u00a0Great Forum.\u00a0 Thanks.", "num_user_post": " 4", "author": "glynnbebee"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/deleting-old-bad-values-from-a-chart/", "posts": [{"date": "February 5, 2015 - 3:46 pm", "content": "Hi everyone!I'm writing with a quick question. As I'm trying to learn more about how ThingsSpeak works by playing with the plotting data on charts (this is my 1st post!), I was wondering about how everyone deals with 'bad' data points. Say, for example, that I have a series of air temperature data points showing 60 (deg. F) , and in the middle these numbers I have a single value that is '-2'. Since the '-2' is obviously a bad data point (due to a problem with my sensor), is there a way to 'remove' it from the chart that is being plot?Thanks in advance,     Luke", "num_user_post": " 4", "author": "capolaris"}, {"date": "February 5, 2015 - 4:56 pm", "content": "Hi Luke,You can apply the 'min' parameter to the feed, and results below that value won't be shown: https://thingspeak.com/docs/charts .  You can also specify this parameter by going to your public or private channel view, clicking on the edit chart icon, and specifying 'Data Min' or 'Data Max'.Here's an example:https://api.thingspeak.com/channels/9/charts/1https://api.thingspeak.com/channels/9/charts/1?min=160lee", "num_user_post": " 457", "author": "lee"}, {"date": "February 5, 2015 - 5:48 pm", "content": "Hi Leegreat... thanks for letting me know about the 'min' function. I was not aware of that. Since some of my bad data values are somewhat random, some of them are close to the temperature that I was recording (e.g.: I get a continuous 65.3 and all of a sudden it goes to 60, and then immediately jumps back to the 65.3 level. But then, during the evening, as it gets colder and the real values get to ~53, if I was to set the 'min' I would be chopping off these good values along with the bad data.Therefore... I was wondering if there might be a better way of going around to do this? Is there a way to delete specific data point(s) (which I know represent bad data?Thanks!", "num_user_post": " 4", "author": "capolaris"}, {"date": "February 6, 2015 - 8:24 am", "content": "Hi Luke,We currently don't have a way to delete the bad data points, but we are internally discussing how to handle this and hope to have a solution in the future, whether that be deleting the data points directly or providing smarter analysis and visualization of existing data (or both).lee", "num_user_post": " 457", "author": "lee"}, {"date": "April 14, 2015 - 3:54 am", "content": "Hi,I would like to see this available too.Thanks,", "num_user_post": " 3", "author": "jass"}, {"date": "July 13, 2015 - 8:44 pm", "content": "Hey Lee,Would it be possible to delete all data in a particular field, instead of all data in a channel? I know you can go into channel settings page and click on the remove radio button under a particular field, but the data doesn't permanently go away when I tried that. Maybe a future improvement.", "num_user_post": " 11", "author": "fishmastaflex"}, {"date": "July 14, 2015 - 8:39 am", "content": "Hi,Deleting all possible data in a single field is not possible right now, but will be taken into account when we start working on a feature to allow selective deletion of data.lee", "num_user_post": " 457", "author": "lee"}, {"date": "November 2, 2016 - 7:28 am", "content": "Hi LeeJust wondering if there is any update to this thread, i.e. ability to delete specified data points from a field. and all data points from a field (without deleting the entire channel)?\u00a0Apologies if I've missed any subsequent postings on this!", "num_user_post": " 13", "author": "rberkelm"}, {"date": "January 12, 2017 - 7:43 am", "content": "HeloI can give you the way to do it...1. Go to data inport/export and export the data to csv file. Use notepad to delete or modify unwanted rows.2. Go to channel setting and 'clear channel' delete all data (only velues)3. inport the modifyed csv file.\u00a0thats the way I deleted unwanted data...", "num_user_post": " 1", "author": "svicar"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/i-do-not-want-return-page-after-apiupdate/", "posts": [{"date": "January 10, 2017 - 7:18 am", "content": "Hi all,I use a page to update my channel:Link (index.html): fermcare.oficinadepao.comAfter pressing the 'Send' button the channel is updated perfectly, but then I get a return page with a number (the index of the updated value (?)).I do not want to receive this page, or if possible I do not want it to interfereIn the flow of my website. What is the solution?Thank you!My page html code:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- <!DOCTYPE html PUBLIC '-//W3C//DTD HTML 4.01//EN' 'http://www.w3.org/TR/html4/strict.dtd'> <html><head> <meta content='text/html; charset=ISO-8859-1' http-equiv='content-type'><title>teste</title></head> <body> <big><big><big><big>Hi, This a test web page<br> <br> <form action='https://api.thingspeak.com/update?' method='post'> <p><label for='set temp'>Desired Temperature: </label> <input id='api_key' name='api_key' value='DV63IPATHUCNX9LZ' type='hidden'><input id='field1' name='field1' type='text'> <br> <input value='send' type='submit'> </p> </form> </big></big></big></big> </body></html>-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------", "num_user_post": " 5", "author": "avoletta"}, {"date": "January 10, 2017 - 7:52 am", "content": "Hi\u00a0avoletta,Have you considered doing an ajax post request instead of direct form submit and then ignoring the response from ThingSpeak? The response indicates successful writing of data to ThingSpeak. Unsure if you really want to ignore the response because if the update fails, the response is 0. More details:\u00a0https://www.mathworks.com/help/thingspeak/update-channel-feed.html.\u00a0\u00a0ThanksAkhila\u00a0", "num_user_post": " 21", "author": "akhila"}, {"date": "January 10, 2017 - 12:18 pm", "content": "tks Akhila,\u00a0I have no idea how to implement ajax or json script .....Coud you give me same examples?", "num_user_post": " 5", "author": "avoletta"}, {"date": "January 10, 2017 - 11:29 pm", "content": "Here's a simple example you can expand on:<html><head><meta content='text/html; charset=ISO-8859-1' http-equiv='content-type'><title>Test Page</title><script src='https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script><script>function postIt(){ var valueToPost = $('#field1').val(); var formData = {api_key:'YOURAPIKEYHERE',field1:valueToPost}; $.ajax({url : 'https://api.thingspeak.com/update', type: 'POST', data : formData, success: function(data, textStatus, jqXHR){ if (data==='0') {alert('Channel not updated');} else {alert('New entry ' + data + ' added to channel');}}, error: function (jqXHR, textStatus, errorThrown) { alert('Error posting data');} });};</script></head><body><h1>Example HTML page<form action='' method='get'><p><label>Desired Temperature: </label><input id ='field1' type='text' value=''><br><br><input value='Update ThingSpeak' type='button' onClick=postIt()></p></form></h1></body></html>You can remove the alert()'s if you don't want the page to display alerts. If this is confusing you may want to take some basic\u00a0javascript classes.", "num_user_post": " 225", "author": "Vinod"}, {"date": "January 11, 2017 - 5:38 am", "content": "Hi\u00a0Vinod,\u00a0I'll try this (and study).\u00a0Thanks a lot!!!", "num_user_post": " 5", "author": "avoletta"}, {"date": "January 11, 2017 - 6:16 am", "content": "Solved!It worked perfectly!\u00a0Tks again!", "num_user_post": " 5", "author": "avoletta"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/please-help-how-to-submit-multile-ds18b20-readings/", "posts": [{"date": "January 4, 2017 - 1:49 pm", "content": "Hi,\u00a0\u00a0I hope someone can help me with some sample code to upload multiple DS18B20 readings to different thingspeak 'fields'. My platform of choice is the Linkit One device, which has an ARM MCU, and I have found that the DallasTemperature.h library doesn't work so well. Most of the readings are '-127.00', instead of the actual temperatures. But, if I read the temperature without that library, i.e doing a 1-wire lookup, it works fine. The problem is, I can't figure out how to read 4 different temperatures, in order to submit to thingspeak.\u00a0\u00a0Here's my code, so far:\u00a0\u00a0#include <OneWire.h>#include <Wire.h>OneWire ds(10); // on pin 10 (a 4.7K resistor is necessary)#include <LTask.h>#include <LWiFi.h>#include <LWiFiServer.h>#include <LWiFiClient.h>#define WIFI_AP 'Ahlers'#define WIFI_PASSWORD '5qg8dzjpes41'#define WIFI_AUTH LWIFI_WPA // choose from LWIFI_OPEN, LWIFI_WPA, or LWIFI_WEP according to your WiFi AP configuration// ThingSpeak Settingschar thingSpeakAddress[] = 'api.thingspeak.com';String writeAPIKey = '69NWEUZ2IGPXRURZ';const int updateThingSpeakInterval = 16 * 1000; // Time interval in milliseconds to update ThingSpeak (number of seconds * 1000 = interval)long lastConnectionTime = 0;boolean lastConnected = false;int failedCounter = 0;LWiFiClient client;void setup(){ LWiFi.begin(); Serial.begin(115200);// keep retrying until connected to AP Serial.println('Connecting to AP'); while (0 == LWiFi.connect(WIFI_AP, LWiFiLoginInfo(WIFI_AUTH, WIFI_PASSWORD))) { delay(1000); }startWifi();}void loop(){ byte i; byte present = 0; byte type_s; byte data[12]; byte addr[8]; float celsius, fahrenheit, celsiuss;if ( !ds.search(addr)) { // Serial.println('No more addresses.');// Serial.println(); ds.reset_search(); delay(250); return; }if (OneWire::crc8(addr, 7) != addr[7]) { Serial.println('CRC is not valid!'); return; } Serial.println();ds.reset(); ds.select(addr); ds.write(0x44); // start conversion, use ds.write(0x44,1) with parasite power on at the enddelay(700); // maybe 750ms is enough, maybe not // we might do a ds.depower() here, but the reset will take care of it.present = ds.reset(); ds.select(addr); ds.write(0xBE); // Read Scratchpad// Serial.print(' Data = '); // Serial.print(present, HEX); // Serial.print(' '); for ( i = 0; i < 9; i++) { // we need 9 bytes data[i] = ds.read(); // Serial.print(data[i], HEX); // Serial.print(' '); } // Serial.print(' CRC='); // Serial.print(OneWire::crc8(data, 8), HEX);// Serial.println();// Convert the data to actual temperature // because the result is a 16 bit signed integer, it should // be stored to an 'int16_t' type, which is always 16 bits // even when compiled on a 32 bit processor. int16_t raw = (data[1] << 8) | data[0]; if (type_s) { raw = raw << 3; // 9 bit resolution default if (data[7] == 0x10) { // 'count remain' gives full 12 bit resolution raw = (raw & 0xFFF0) + 12 - data[6]; } } else { byte cfg = (data[4] & 0x60); // at lower res, the low bits are undefined, so let's zero them if (cfg == 0x00) raw = raw & ~7; // 9 bit resolution, 93.75 ms else if (cfg == 0x20) raw = raw & ~3; // 10 bit res, 187.5 ms else if (cfg == 0x40) raw = raw & ~1; // 11 bit res, 375 ms //// default is 12 bit resolution, 750 ms conversion time } celsius = (float)raw / 16.0; Serial.print(' Temperature = '); Serial.print(celsius); Serial.print(' Celsius, '); celsiuss = round(celsius); String analogValue0 = String(celsiuss, DEC); //Serial.println(celsius); // Print Update Response to Serial Monitor if (client.available()) {// char c = client.read();// Serial.print(c); } // Disconnect from ThingSpeak if (!client.connected() && lastConnected) { Serial.println('...disconnected'); Serial.println(); client.stop(); } // Update ThingSpeak// if(!client.connected() && (millis() - lastConnectionTime > updateThingSpeakInterval)) // { updateThingSpeak('field1='+analogValue0); // } // Check if Arduino Ethernet needs to be restarted if (failedCounter > 3 ) {startWifi();} lastConnected = client.connected();}void updateThingSpeak(String tsData){ if (client.connect(thingSpeakAddress, 80)) { client.print('POST /update HTTP/1.1'); client.print('Host: api.thingspeak.com'); client.print('Connection: close'); client.print('X-THINGSPEAKAPIKEY: '+writeAPIKey+''); client.print('Content-Type: application/x-www-form-urlencoded'); client.print('Content-Length: '); client.print(tsData.length()); client.print('');client.print(tsData); lastConnectionTime = millis(); if (client.connected()) { Serial.println('Connecting to ThingSpeak...'); Serial.println(); failedCounter = 0; } else { failedCounter++; Serial.println('Connection to ThingSpeak failed ('+String(failedCounter, DEC)+')'); Serial.println(); } } else { failedCounter++; Serial.println('Connection to ThingSpeak Failed ('+String(failedCounter, DEC)+')'); Serial.println(); lastConnectionTime = millis(); }}void startWifi(){ client.stop();Serial.println('Connecting Arduino to network...'); Serial.println();delay(1000);}", "num_user_post": " 10", "author": "SilverNodashi"}, {"date": "January 5, 2017 - 12:17 am", "content": "If your code works for one value then the straightforward way is to add a second analog value and update thingspeak like\u00a0updateThingSpeak('field1='+analogValue0+'&field2='+analogValue1);\u00a0However in the long term its better if you can set up a loop that gets an array of analog values and assembles \u00a0them into a string to input into the update function.", "num_user_post": " 271", "author": "rw950431"}, {"date": "January 5, 2017 - 6:37 am", "content": "rw950431 said If your code works for one value then the straightforward way is to add a second analog value and update thingspeak like \u00a0 updateThingSpeak('field1='+analogValue0+'&field2='+analogValue1); \u00a0 However in the long term its better if you can set up a loop that gets an array of analog values and assembles \u00a0them into a string to input into the update function.\u00a0\u00a0I'm not using Analog sensore, but digital sensors which uses the 1-wire bus, and that's where I'm stuck - how to read each sensor's value individually.\u00a0", "num_user_post": " 10", "author": "SilverNodashi"}, {"date": "January 8, 2017 - 2:53 am", "content": "Sorry, misunderstood the issue you were having. \u00a0According to the documentation at https://www.pjrc.com/teensy/td_libs_OneWire.html you loop over all the active devices on the one-wire bus by repeatedly calling ds.search()\u00a0eg something like this. \u00a0(You will need to save each value in an array then assemble all the values into a string afterwards)\u00a0val_count=0while (ds.search(addr)) {\u00a0 if (OneWire::crc8(addr, 7) != addr[7]) {\u00a0 \u00a0Serial.println('CRC is not valid!');\u00a0 \u00a0continue;\u00a0 }\u00a0 Serial.println();\u00a0 ds.reset();\u00a0 ds.select(addr);\u00a0 ds.write(0x44); // start conversion, use ds.write(0x44,1) with parasite power on at the end// etc etcvalues[val_count]=AnalogValue1++val_count}// now assemble all the values into field1=values[1]&field2=values[2] etc and submit to thingspeak.\u00a0", "num_user_post": " 271", "author": "rw950431"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/data-on-fields-not-displayed-1/", "posts": [{"date": "November 15, 2016 - 12:54 pm", "content": "Hi,\u00a0My ESP8266 is sending data to Thingspeak but none of them are being shown on the graph. Please help me!\u00a0My code:#define esp8266 Serial #define SSID '****'\u00a0 #define PASS '****'\u00a0 #define IP 'http://184.106.153.149/' // thingspeak.com IP#define soilMoisturePIN 0 // senzor za vlago v zemlji na Analog Pin 0String GET = 'GET /update?key=[xxxxxxx]&'; //thingspeak key String GET1 = 'field=';String soilMoist = '';String soilMoisture (){float moisture; char moisture_c[6]; //calculates the percentage of soil moisture moisture = analogRead(soilMoisturePIN); moisture = 100*(1-(moisture)/1023);dtostrf(moisture, 0, 1, moisture_c); //converts floats to stringsreturn (String) moisture_c; }\u00a0void upadateValues(String moisture_c){ String cmd = 'AT+CIPSTART='TCP',''; cmd += IP; cmd += '',80'; esp8266.println(cmd); delay(2000); if(esp8266.find('Error')){ Serial.print('Error1'); return; } cmd = GET + GET1; cmd += moisture_c; cmd += ' '; Serial.print(cmd); esp8266.print('AT+CIPSEND='); esp8266.println(cmd.length()); if(esp8266.find('>')){ esp8266.print(cmd); }else{ esp8266.println('AT+CIPCLOSE'); } }boolean connectWiFi(){ esp8266.println('AT+CWMODE=1'); delay(2000); String cmd='AT+CWJAP=''; cmd+=SSID; cmd+='',''; cmd+=PASS; cmd+='''; esp8266.println(cmd); delay(5000); if(esp8266.find('OK')){ Serial.println('OK'); return true; }else{ Serial.println('KO'); return false; } }void setup() { pinMode(soilMoisturePIN, INPUT); Serial.begin(9600); esp8266.begin(115200); // sensors.begin(); esp8266.println('AT'); delay(5000); if(esp8266.find('OK')){ connectWiFi(); } }void loop(){ soilMoist = soilMoisture(); upadateValues(soilMoist); delay(5000); }\u00a0On my terminal i get:AT53.149/',80GET /update?key=[xxxxxx]&field1=3.3AT+CIPSEND=47ATAT+CWMODE=1AT+CWJAP='7908de','260335799'OKAT+CIPSTART='TCP','http://184.106.153.149/',80GET /update?key=[xxxxxx]&field1=7.8AT+CIPSEND=47AT+CIPCLOSE\u00a0...and so on...what's wrong?", "num_user_post": " 1", "author": "uroszila"}, {"date": "December 22, 2016 - 10:15 am", "content": "I think the parameter 'key' should be changed as 'api_key' as in https://www.mathworks.com/help/thingspeak/update-channel-feed.htmlSo that your GET request may look like, \u00a0GET /update?api_key=[xxxxxx]&field1=3.3", "num_user_post": " 12", "author": "jvasudev"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/how-to-deserialise-thingspeak-feeds-xml-data-with-php/", "posts": [{"date": "December 21, 2016 - 1:17 am", "content": "I have data in thing speak that I can get with$url = 'https://api.thingspeak.com/channels/203731/feeds.xml?results=500';$xml = simplexml_load_file($url);$channel_name = (string) $xml->name; print_r($channel_name);This is one of my attempts to\u00a0display the feeds fieldsforeach ($xml->feeds as $feed) { /\u00a0\u00a0\u00a0\u00a0\u00a0 print_r($feed);}The channel name displays when I run this code, but I have tried every combination I can think of to get the feed data, but either get nothing displayed or an error messageWhat code do I use to get the feeds data (field1, Field2 etc)Alternatively, is there documentation specific to the feeds data or other software you can point me to", "num_user_post": " 2", "author": "mchampio"}, {"date": "December 21, 2016 - 8:01 am", "content": "Hi,\u00a0Here is the doc regarding retrieving of channel feeds:\u00a0https://www.mathworks.com/help/thingspeak/get-a-channel-feed.html\u00a0ThanksAkhila\u00a0", "num_user_post": " 21", "author": "akhila"}, {"date": "December 21, 2016 - 1:40 pm", "content": "If you are looking to just fetch the data from the individual fields from the overall feeds data, you can use something like this,<?php$url = 'https://api.thingspeak.com/channels/203731/feeds.xml?results=500';$xml = simplexml_load_file($url);$channel_name = (string) $xml->name;print_r($channel_name);$field1 = $xml->xpath('//feed/field1'); //gets all <field1/> whose parent is <feed/>print_r($field1);$field2 = $xml->xpath('//feed/field2'); //gets all <field2/> whose parent is <feed/>print_r($field2);?>", "num_user_post": " 12", "author": "jvasudev"}, {"date": "December 21, 2016 - 2:47 pm", "content": "Thank you so much jvasudev, that is exactly what I was looking for.I added the loop at the bottom, so noobs like me could see how to use the data in the field<?php$url = 'https://api.thingspeak.com/channels/203731/feeds.xml?results=500';$xml = simplexml_load_file($url);$description = (string) $xml->description;print_r($description);$field1 = $xml->xpath('//feed/field1'); // get all <field1/> whose parent is <feed/>print_r($field1);$field2 = $xml->xpath('//feed/field2'); //gets all <field2/> whose parent is <feed/>print_r($field2);foreach ($field2 as $onefield2) {\u00a0 echo $onefield2;\u00a0 echo '<br/>';}?>", "num_user_post": " 2", "author": "mchampio"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/how-can-i-update-metadata-with-api/", "posts": [{"date": "December 19, 2016 - 10:11 am", "content": "Hi guys I am trying to figure out how to update a channel with HTTP PUT (https://nl.mathworks.com/help/thingspeak/update-a-channel.html) in order to update metadata.So I try to test with unix command curl :curl -X 'PUT' -d 'key_api=MY_WRITE_KEY' -d 'metadata=this is my update' 'http://api.thingspeak.com/channels/98538' -iBut it does not work and terminal return :HTTP/1.1 302 FoundContent-Type: text/html; charset=utf-8Transfer-Encoding: chunkedConnection: closeStatus: 302 FoundX-Frame-Options: ALLOWALLAccess-Control-Allow-Origin: *Access-Control-Allow-Methods: GET, POST, PUT, OPTIONS, DELETE, PATCHAccess-Control-Allow-Headers: origin, content-type, X-Requested-WithAccess-Control-Max-Age: 1800Location: http://api.thingspeak.com/loginCache-Control: no-cacheX-Request-Id: dea3439c-8757-4a3a-b7a1-be6c5841ca66X-Runtime: 0.115051X-Powered-By: Phusion Passenger 4.0.57Date: Mon, 19 Dec 2016 14:43:05 GMTServer: nginx/1.9.3 + Phusion Passenger 4.0.57<html><body>You are being <a href='http://api.thingspeak.com/login'>redirected</a>.</body></html>Later I would like to modify metadata through a Raspberry Pi.\u00a0Any one have an idea of how to update metadata (without login) ?", "num_user_post": " 4", "author": "maxmbeded"}, {"date": "December 19, 2016 - 5:35 pm", "content": "Perhaps key_api should be api_key?", "num_user_post": " 271", "author": "rw950431"}, {"date": "December 20, 2016 - 10:12 am", "content": "Yes, I did a copy error (also need https not http) :curl\u00a0-X\u00a0'PUT'\u00a0-d\u00a0'api_key=MY_WRITE_KEY'\u00a0-d\u00a0'metadata=this is my update'\u00a0'https://api.thingspeak.com/channels/98538'\u00a0-iBut it doesn't change anything.{'status':'401','error':{'error_code':'error_auth_required','message':'Authorization Required','details':'Please provide proper authentication details.'}}Still stuck ", "num_user_post": " 4", "author": "maxmbeded"}, {"date": "December 20, 2016 - 10:15 am", "content": "(Synthax Highlighter failed !)", "num_user_post": " 4", "author": "maxmbeded"}, {"date": "December 20, 2016 - 3:31 pm", "content": "Hi maxmbeded,I think you are using the write API key whereas you should be using the\u00a0User's API key found in the profile page. \u00a0It is mentioned in the documentation clearly here: https://www.mathworks.com/help/thingspeak/update-a-channel.html\u00a0\u00a0So the curl code should look like,curl -X 'PUT' -d 'api_key=USER_API_KEY' -d 'metadata=this is my update' 'http://api.thingspeak.com/channels/CHANNEL_NUM' -i", "num_user_post": " 12", "author": "jvasudev"}, {"date": "December 21, 2016 - 8:31 am", "content": "Yes, that's right I used Write API key instead of User API as suggested. I didn't see it. It work now thanks a lot ! Here is terminal response :HTTP/1.1 200 OKContent-Type: application/json; charset=utf-8Transfer-Encoding: chunkedConnection: closeStatus: 200 OKX-Frame-Options: ALLOWALLAccess-Control-Allow-Origin: *Access-Control-Allow-Methods: GET, POST, PUT, OPTIONS, DELETE, PATCHAccess-Control-Allow-Headers: origin, content-type, X-Requested-WithAccess-Control-Max-Age: 1800ETag: '3a0e1b238fb4f75be637a9d174bfa5f7'Cache-Control: max-age=0, private, must-revalidateX-Request-Id: 862c5b36-5511-42d0-9f2a-27c5a6dfeea6X-Runtime: 0.129845X-Powered-By: Phusion Passenger 4.0.57Date: Wed, 21 Dec 2016 13:04:56 GMTServer: nginx/1.9.3 + Phusion Passenger 4.0.57{'id':98538,'name':'Solarly MVP ','description':'','latitude':'0.0','longitude':'0.0','created_at':'2016-03-14T10:18:50Z','elevation':'','last_entry_id':13,'ranking':30,'metadata':'this is my update','tags':[],'api_keys':[{'api_key':'2290IM0IVAXNHFV7','write_flag':true},{'api_key':'J0PK60JKLWND379L','write_flag':false},{'api_key':'1DFP0T9MCU6558PE','write_flag':false},{'api_key':'KIHTF7HA4SQUD46G','write_flag':false},{'api_key':'C9EQAL67GTH122Q1','write_flag':false},{'api_key':'KA4MTB7E6G40E6EI','write_flag':false}]}", "num_user_post": " 4", "author": "maxmbeded"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/update-channel-with-current-date-time/", "posts": [{"date": "December 5, 2016 - 6:23 am", "content": "I update data with local time (My time zone is +05:30 i.e. India) by using '.......&created_at=2016-12-05T14:30:00' and my local time is the same. And when it updating in Graph it is sowing '05-12-2016 20:00:00 GMT +05:30'. So what\u00a0will be the correct format for update Date and time.", "num_user_post": " 2", "author": "itsme_raju2002"}, {"date": "December 5, 2016 - 6:31 pm", "content": "Perhaps try '&created_at=2016-12-05T14:30:00+05:30'", "num_user_post": " 271", "author": "rw950431"}, {"date": "December 5, 2016 - 11:47 pm", "content": "I have try with '&created_at=2016-12-05T14:30:00+05:30' but result is same.", "num_user_post": " 2", "author": "itsme_raju2002"}, {"date": "December 20, 2016 - 5:16 pm", "content": "Try using the timezone parameter in conjunction with the created_at parameter as,'........&created_at=2016-12-05T14:30:00&timezone=Asia%2FKolkata'", "num_user_post": " 12", "author": "jvasudev"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/thingspeak-doesnt-shows-all-data-in-chart/", "posts": [{"date": "December 5, 2016 - 3:14 pm", "content": "Hello there,since may 2016 I am logging some dato to ThingSpeak with my ESP8266. Since yesterday I logged 66935 times. I could see all these data in a chart in my browser when I also send the feed parameter 'median=1440'. This works very well.The first two weeks I logged some wrong data which I wanted to delete. So I exportet the data, deleted the wrong logs, cleared my channel and uploaded the .csv. But now I couldn\u00b4t see all of the data in the chart. I only could see the last data until a month earlier. When I download again the exported data, then there is nothing missing. Also if I add the 'start' and 'end' feed parameters I could only the one month and not more.What is the problem?Sorry for my english", "num_user_post": " 5", "author": "turti"}, {"date": "December 5, 2016 - 5:29 pm", "content": "I suspect this is a consequence of the length of the file and perhaps multiple simultaneous attempts to upload the data. Could you try this:1) Take your file and break it up into multiple files, each with 10000 points in them. Let's call them file1.csv, file2.csv, file3.csv ... file7.csv.2)\u00a0Make sure that the files have increasing order of data. i.e., file1.csv has the oldest data. file2.csv has the next oldest data, etc.3) Upload one file at a time, starting from file1 and\u00a0going incrementally to file7Now see if the data is showing up correctly.", "num_user_post": " 225", "author": "Vinod"}, {"date": "December 7, 2016 - 12:03 pm", "content": "@Vinod I tryed your solution before with blocks of 8000 points. I also waited until these data has been updated on the main page of that channel (entries). Unfortunately that doesn't worked. Is it possible, that the points are copied in a own table on ThingSpeak when I update a channel?", "num_user_post": " 5", "author": "turti"}, {"date": "December 15, 2016 - 3:58 pm", "content": "The problem here appears to be that\u00a0the data being uploaded seems\u00a0to be getting interrupted by data\u00a0from a device.@Turti - do you have access to MATLAB that you can run some code on? It does require the desktop MATLAB,\u00a0as it involves loading data from a CSV file\u00a0on your local machine.", "num_user_post": " 225", "author": "Vinod"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/event-listener/", "posts": [{"date": "November 11, 2016 - 8:15 am", "content": "Hi,To perform actions on incoming messages on ThingSpeak I need to have a 'listener' in my cloud-app. With other words every message that comes in a ThingSpeak channel I want to have this message available in my cloud-app.What is the best/recommended way of doing this:- developing an cloud-(background)app polling ThingSpeak every n-seconds using the ThingSpeak (https://) APIs?- or is React app -> ThingHTTP app meant for these scenarios: creating a REST API that can be called from ThingSpeak via the ThingHTTP app?Thanks.", "num_user_post": " 3", "author": "gdillen"}, {"date": "December 6, 2016 - 4:19 pm", "content": "No one can comment on this?Thanks.", "num_user_post": " 3", "author": "gdillen"}, {"date": "December 6, 2016 - 4:45 pm", "content": "Both solutions are possible.In my opinion,\u00a0from an architectural and implementation perspective, a React App->ThingHTTP App is more elegant and\u00a0efficient solution.", "num_user_post": " 225", "author": "Vinod"}]}, {"url": "https://community.thingspeak.com/forum/thingspeak-api/reading-complete-channel-feeds-via-software/", "posts": [{"date": "December 5, 2016 - 12:59 pm", "content": "Hi Lee,I want to know, how I can download a complete channel feed via software, I think, with a GET command.Best regardsAndy", "num_user_post": " 4", "author": "weisoft"}, {"date": "December 5, 2016 - 6:36 pm", "content": "You can read channel feed withhttps://api.thingspeak.com/channels/9/feeds.json?results=8000\u00a0Note that if you have more than 8000 points you will need to do multiple requests using the 'start' and 'end' parameters.", "num_user_post": " 271", "author": "rw950431"}]}]}